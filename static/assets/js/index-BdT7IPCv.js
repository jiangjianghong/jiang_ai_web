var Xi=Object.defineProperty;var eo=(n,e,t)=>e in n?Xi(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var de=(n,e,t)=>eo(n,typeof e!="symbol"?e+"":e,t);import{j as l,m as le,u as to,a as so,A as bs,D as no,H as ro}from"./ui-vendor-YLkIbSwW.js";import{R as C,a as ao,r as m,b as io,c as oo,B as lo}from"./router-vendor-BI--Uo24.js";import{a as co,b as uo,g as ho}from"./react-vendor-DyFf35aq.js";import{_ as ws,C as xs,r as Wt,S as fo,a as po,F as Kn,g as Ta,b as Jt,c as Es,d as mo,i as Na,p as go,u as yo,e as vo,E as Ca,o as bo,L as wo,f as xo,h as _o,v as So,j as gr,k as ko,l as jo,m as Eo,n as To,q as No}from"./firebase-vendor-Ds0FbH4y.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();var Rs={},yr;function Co(){if(yr)return Rs;yr=1;var n=co();return Rs.createRoot=n.createRoot,Rs.hydrateRoot=n.hydrateRoot,Rs}var vr=Co();function Io(n){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.appendChild(t),t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n))}const Ro=n=>{switch(n){case"success":return Po;case"info":return Do;case"warning":return $o;case"error":return Lo;default:return null}},Oo=Array(12).fill(0),Ao=({visible:n,className:e})=>C.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":n},C.createElement("div",{className:"sonner-spinner"},Oo.map((t,s)=>C.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${s}`})))),Po=C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},C.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),$o=C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},C.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Do=C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},C.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Lo=C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},C.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Uo=C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},C.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),C.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),Bo=()=>{const[n,e]=C.useState(document.hidden);return C.useEffect(()=>{const t=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",t),()=>window.removeEventListener("visibilitychange",t)},[]),n};let kn=1;class Mo{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;const{message:s,...r}=e,a=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:kn++,i=this.toasts.find(d=>d.id===a),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),i?this.toasts=this.toasts.map(d=>d.id===a?(this.publish({...d,...e,id:a,title:s}),{...d,...e,id:a,dismissible:o,title:s}):d):this.addToast({title:s,...r,dismissible:o,id:a}),a},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(t=>t({id:e,dismiss:!0})))):this.toasts.forEach(t=>{this.subscribers.forEach(s=>s({id:t.id,dismiss:!0}))}),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let s;t.loading!==void 0&&(s=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));const r=Promise.resolve(e instanceof Function?e():e);let a=s!==void 0,i;const o=r.then(async c=>{if(i=["resolve",c],C.isValidElement(c))a=!1,this.create({id:s,type:"default",message:c});else if(zo(c)&&!c.ok){a=!1;const u=typeof t.error=="function"?await t.error(`HTTP error! status: ${c.status}`):t.error,f=typeof t.description=="function"?await t.description(`HTTP error! status: ${c.status}`):t.description,g=typeof u=="object"&&!C.isValidElement(u)?u:{message:u};this.create({id:s,type:"error",description:f,...g})}else if(c instanceof Error){a=!1;const u=typeof t.error=="function"?await t.error(c):t.error,f=typeof t.description=="function"?await t.description(c):t.description,g=typeof u=="object"&&!C.isValidElement(u)?u:{message:u};this.create({id:s,type:"error",description:f,...g})}else if(t.success!==void 0){a=!1;const u=typeof t.success=="function"?await t.success(c):t.success,f=typeof t.description=="function"?await t.description(c):t.description,g=typeof u=="object"&&!C.isValidElement(u)?u:{message:u};this.create({id:s,type:"success",description:f,...g})}}).catch(async c=>{if(i=["reject",c],t.error!==void 0){a=!1;const h=typeof t.error=="function"?await t.error(c):t.error,u=typeof t.description=="function"?await t.description(c):t.description,p=typeof h=="object"&&!C.isValidElement(h)?h:{message:h};this.create({id:s,type:"error",description:u,...p})}}).finally(()=>{a&&(this.dismiss(s),s=void 0),t.finally==null||t.finally.call(t)}),d=()=>new Promise((c,h)=>o.then(()=>i[0]==="reject"?h(i[1]):c(i[1])).catch(h));return typeof s!="string"&&typeof s!="number"?{unwrap:d}:Object.assign(s,{unwrap:d})},this.custom=(e,t)=>{const s=(t==null?void 0:t.id)||kn++;return this.create({jsx:e(s),id:s,...t}),s},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const je=new Mo,Fo=(n,e)=>{const t=(e==null?void 0:e.id)||kn++;return je.addToast({title:n,...e,id:t}),t},zo=n=>n&&typeof n=="object"&&"ok"in n&&typeof n.ok=="boolean"&&"status"in n&&typeof n.status=="number",qo=Fo,Wo=()=>je.toasts,Vo=()=>je.getActiveToasts();Object.assign(qo,{success:je.success,info:je.info,warning:je.warning,error:je.error,custom:je.custom,message:je.message,promise:je.promise,dismiss:je.dismiss,loading:je.loading},{getHistory:Wo,getToasts:Vo});Io("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function Os(n){return n.label!==void 0}const Ho=3,Ko="24px",Zo="16px",br=4e3,Go=356,Jo=14,Qo=45,Yo=200;function qe(...n){return n.filter(Boolean).join(" ")}function Xo(n){const[e,t]=n.split("-"),s=[];return e&&s.push(e),t&&s.push(t),s}const el=n=>{var e,t,s,r,a,i,o,d,c;const{invert:h,toast:u,unstyled:f,interacting:p,setHeights:g,visibleToasts:j,heights:y,index:x,toasts:$,expanded:_,removeToast:w,defaultRichColors:b,closeButton:v,style:S,cancelButtonStyle:I,actionButtonStyle:U,className:ne="",descriptionClassName:z="",duration:V,position:re,gap:ce,expandByDefault:ae,classNames:O,icons:K,closeButtonAriaLabel:Q="Close toast"}=n,[Y,L]=C.useState(null),[A,B]=C.useState(null),[H,k]=C.useState(!1),[T,N]=C.useState(!1),[te,J]=C.useState(!1),[oe,X]=C.useState(!1),[ye,Fe]=C.useState(!1),[es,Ct]=C.useState(0),[ts,It]=C.useState(0),Qe=C.useRef(u.duration||V||br),ss=C.useRef(null),Re=C.useRef(null),ns=x===0,nn=x+1<=j,be=u.type,He=u.dismissible!==!1,rs=u.className||"",rn=u.descriptionClassName||"",ht=C.useMemo(()=>y.findIndex(W=>W.toastId===u.id)||0,[y,u.id]),an=C.useMemo(()=>{var W;return(W=u.closeButton)!=null?W:v},[u.closeButton,v]),as=C.useMemo(()=>u.duration||V||br,[u.duration,V]),Ye=C.useRef(0),Oe=C.useRef(0),$e=C.useRef(0),ze=C.useRef(null),[is,Gi]=re.split("-"),ur=C.useMemo(()=>y.reduce((W,pe,we)=>we>=ht?W:W+pe.height,0),[y,ht]),hr=Bo(),Ji=u.invert||h,on=be==="loading";Oe.current=C.useMemo(()=>ht*ce+ur,[ht,ur]),C.useEffect(()=>{Qe.current=as},[as]),C.useEffect(()=>{k(!0)},[]),C.useEffect(()=>{const W=Re.current;if(W){const pe=W.getBoundingClientRect().height;return It(pe),g(we=>[{toastId:u.id,height:pe,position:u.position},...we]),()=>g(we=>we.filter(Te=>Te.toastId!==u.id))}},[g,u.id]),C.useLayoutEffect(()=>{if(!H)return;const W=Re.current,pe=W.style.height;W.style.height="auto";const we=W.getBoundingClientRect().height;W.style.height=pe,It(we),g(Te=>Te.find(ve=>ve.toastId===u.id)?Te.map(ve=>ve.toastId===u.id?{...ve,height:we}:ve):[{toastId:u.id,height:we,position:u.position},...Te])},[H,u.title,u.description,g,u.id,u.jsx,u.action,u.cancel]);const Xe=C.useCallback(()=>{N(!0),Ct(Oe.current),g(W=>W.filter(pe=>pe.toastId!==u.id)),setTimeout(()=>{w(u)},Yo)},[u,w,g,Oe]);C.useEffect(()=>{if(u.promise&&be==="loading"||u.duration===1/0||u.type==="loading")return;let W;return _||p||hr?(()=>{if($e.current<Ye.current){const Te=new Date().getTime()-Ye.current;Qe.current=Qe.current-Te}$e.current=new Date().getTime()})():(()=>{Qe.current!==1/0&&(Ye.current=new Date().getTime(),W=setTimeout(()=>{u.onAutoClose==null||u.onAutoClose.call(u,u),Xe()},Qe.current))})(),()=>clearTimeout(W)},[_,p,u,be,hr,Xe]),C.useEffect(()=>{u.delete&&(Xe(),u.onDismiss==null||u.onDismiss.call(u,u))},[Xe,u.delete]);function Qi(){var W;if(K!=null&&K.loading){var pe;return C.createElement("div",{className:qe(O==null?void 0:O.loader,u==null||(pe=u.classNames)==null?void 0:pe.loader,"sonner-loader"),"data-visible":be==="loading"},K.loading)}return C.createElement(Ao,{className:qe(O==null?void 0:O.loader,u==null||(W=u.classNames)==null?void 0:W.loader),visible:be==="loading"})}const Yi=u.icon||(K==null?void 0:K[be])||Ro(be);var fr,pr;return C.createElement("li",{tabIndex:0,ref:Re,className:qe(ne,rs,O==null?void 0:O.toast,u==null||(e=u.classNames)==null?void 0:e.toast,O==null?void 0:O.default,O==null?void 0:O[be],u==null||(t=u.classNames)==null?void 0:t[be]),"data-sonner-toast":"","data-rich-colors":(fr=u.richColors)!=null?fr:b,"data-styled":!(u.jsx||u.unstyled||f),"data-mounted":H,"data-promise":!!u.promise,"data-swiped":ye,"data-removed":T,"data-visible":nn,"data-y-position":is,"data-x-position":Gi,"data-index":x,"data-front":ns,"data-swiping":te,"data-dismissible":He,"data-type":be,"data-invert":Ji,"data-swipe-out":oe,"data-swipe-direction":A,"data-expanded":!!(_||ae&&H),style:{"--index":x,"--toasts-before":x,"--z-index":$.length-x,"--offset":`${T?es:Oe.current}px`,"--initial-height":ae?"auto":`${ts}px`,...S,...u.style},onDragEnd:()=>{J(!1),L(null),ze.current=null},onPointerDown:W=>{W.button!==2&&(on||!He||(ss.current=new Date,Ct(Oe.current),W.target.setPointerCapture(W.pointerId),W.target.tagName!=="BUTTON"&&(J(!0),ze.current={x:W.clientX,y:W.clientY})))},onPointerUp:()=>{var W,pe,we;if(oe||!He)return;ze.current=null;const Te=Number(((W=Re.current)==null?void 0:W.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Cs=Number(((pe=Re.current)==null?void 0:pe.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ve=new Date().getTime()-((we=ss.current)==null?void 0:we.getTime()),Ae=Y==="x"?Te:Cs,Is=Math.abs(Ae)/ve;if(Math.abs(Ae)>=Qo||Is>.11){Ct(Oe.current),u.onDismiss==null||u.onDismiss.call(u,u),B(Y==="x"?Te>0?"right":"left":Cs>0?"down":"up"),Xe(),X(!0);return}else{var De,Le;(De=Re.current)==null||De.style.setProperty("--swipe-amount-x","0px"),(Le=Re.current)==null||Le.style.setProperty("--swipe-amount-y","0px")}Fe(!1),J(!1),L(null)},onPointerMove:W=>{var pe,we,Te;if(!ze.current||!He||((pe=window.getSelection())==null?void 0:pe.toString().length)>0)return;const ve=W.clientY-ze.current.y,Ae=W.clientX-ze.current.x;var Is;const De=(Is=n.swipeDirections)!=null?Is:Xo(re);!Y&&(Math.abs(Ae)>1||Math.abs(ve)>1)&&L(Math.abs(Ae)>Math.abs(ve)?"x":"y");let Le={x:0,y:0};const mr=ft=>1/(1.5+Math.abs(ft)/20);if(Y==="y"){if(De.includes("top")||De.includes("bottom"))if(De.includes("top")&&ve<0||De.includes("bottom")&&ve>0)Le.y=ve;else{const ft=ve*mr(ve);Le.y=Math.abs(ft)<Math.abs(ve)?ft:ve}}else if(Y==="x"&&(De.includes("left")||De.includes("right")))if(De.includes("left")&&Ae<0||De.includes("right")&&Ae>0)Le.x=Ae;else{const ft=Ae*mr(Ae);Le.x=Math.abs(ft)<Math.abs(Ae)?ft:Ae}(Math.abs(Le.x)>0||Math.abs(Le.y)>0)&&Fe(!0),(we=Re.current)==null||we.style.setProperty("--swipe-amount-x",`${Le.x}px`),(Te=Re.current)==null||Te.style.setProperty("--swipe-amount-y",`${Le.y}px`)}},an&&!u.jsx&&be!=="loading"?C.createElement("button",{"aria-label":Q,"data-disabled":on,"data-close-button":!0,onClick:on||!He?()=>{}:()=>{Xe(),u.onDismiss==null||u.onDismiss.call(u,u)},className:qe(O==null?void 0:O.closeButton,u==null||(s=u.classNames)==null?void 0:s.closeButton)},(pr=K==null?void 0:K.close)!=null?pr:Uo):null,(be||u.icon||u.promise)&&u.icon!==null&&((K==null?void 0:K[be])!==null||u.icon)?C.createElement("div",{"data-icon":"",className:qe(O==null?void 0:O.icon,u==null||(r=u.classNames)==null?void 0:r.icon)},u.promise||u.type==="loading"&&!u.icon?u.icon||Qi():null,u.type!=="loading"?Yi:null):null,C.createElement("div",{"data-content":"",className:qe(O==null?void 0:O.content,u==null||(a=u.classNames)==null?void 0:a.content)},C.createElement("div",{"data-title":"",className:qe(O==null?void 0:O.title,u==null||(i=u.classNames)==null?void 0:i.title)},u.jsx?u.jsx:typeof u.title=="function"?u.title():u.title),u.description?C.createElement("div",{"data-description":"",className:qe(z,rn,O==null?void 0:O.description,u==null||(o=u.classNames)==null?void 0:o.description)},typeof u.description=="function"?u.description():u.description):null),C.isValidElement(u.cancel)?u.cancel:u.cancel&&Os(u.cancel)?C.createElement("button",{"data-button":!0,"data-cancel":!0,style:u.cancelButtonStyle||I,onClick:W=>{Os(u.cancel)&&He&&(u.cancel.onClick==null||u.cancel.onClick.call(u.cancel,W),Xe())},className:qe(O==null?void 0:O.cancelButton,u==null||(d=u.classNames)==null?void 0:d.cancelButton)},u.cancel.label):null,C.isValidElement(u.action)?u.action:u.action&&Os(u.action)?C.createElement("button",{"data-button":!0,"data-action":!0,style:u.actionButtonStyle||U,onClick:W=>{Os(u.action)&&(u.action.onClick==null||u.action.onClick.call(u.action,W),!W.defaultPrevented&&Xe())},className:qe(O==null?void 0:O.actionButton,u==null||(c=u.classNames)==null?void 0:c.actionButton)},u.action.label):null)};function wr(){if(typeof window>"u"||typeof document>"u")return"ltr";const n=document.documentElement.getAttribute("dir");return n==="auto"||!n?window.getComputedStyle(document.documentElement).direction:n}function tl(n,e){const t={};return[n,e].forEach((s,r)=>{const a=r===1,i=a?"--mobile-offset":"--offset",o=a?Zo:Ko;function d(c){["top","right","bottom","left"].forEach(h=>{t[`${i}-${h}`]=typeof c=="number"?`${c}px`:c})}typeof s=="number"||typeof s=="string"?d(s):typeof s=="object"?["top","right","bottom","left"].forEach(c=>{s[c]===void 0?t[`${i}-${c}`]=o:t[`${i}-${c}`]=typeof s[c]=="number"?`${s[c]}px`:s[c]}):d(o)}),t}const sl=C.forwardRef(function(e,t){const{invert:s,position:r="bottom-right",hotkey:a=["altKey","KeyT"],expand:i,closeButton:o,className:d,offset:c,mobileOffset:h,theme:u="light",richColors:f,duration:p,style:g,visibleToasts:j=Ho,toastOptions:y,dir:x=wr(),gap:$=Jo,icons:_,containerAriaLabel:w="Notifications"}=e,[b,v]=C.useState([]),S=C.useMemo(()=>Array.from(new Set([r].concat(b.filter(A=>A.position).map(A=>A.position)))),[b,r]),[I,U]=C.useState([]),[ne,z]=C.useState(!1),[V,re]=C.useState(!1),[ce,ae]=C.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),O=C.useRef(null),K=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),Q=C.useRef(null),Y=C.useRef(!1),L=C.useCallback(A=>{v(B=>{var H;return(H=B.find(k=>k.id===A.id))!=null&&H.delete||je.dismiss(A.id),B.filter(({id:k})=>k!==A.id)})},[]);return C.useEffect(()=>je.subscribe(A=>{if(A.dismiss){requestAnimationFrame(()=>{v(B=>B.map(H=>H.id===A.id?{...H,delete:!0}:H))});return}setTimeout(()=>{ao.flushSync(()=>{v(B=>{const H=B.findIndex(k=>k.id===A.id);return H!==-1?[...B.slice(0,H),{...B[H],...A},...B.slice(H+1)]:[A,...B]})})})}),[b]),C.useEffect(()=>{if(u!=="system"){ae(u);return}if(u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ae("dark"):ae("light")),typeof window>"u")return;const A=window.matchMedia("(prefers-color-scheme: dark)");try{A.addEventListener("change",({matches:B})=>{ae(B?"dark":"light")})}catch{A.addListener(({matches:H})=>{try{ae(H?"dark":"light")}catch(k){console.error(k)}})}},[u]),C.useEffect(()=>{b.length<=1&&z(!1)},[b]),C.useEffect(()=>{const A=B=>{var H;if(a.every(N=>B[N]||B.code===N)){var T;z(!0),(T=O.current)==null||T.focus()}B.code==="Escape"&&(document.activeElement===O.current||(H=O.current)!=null&&H.contains(document.activeElement))&&z(!1)};return document.addEventListener("keydown",A),()=>document.removeEventListener("keydown",A)},[a]),C.useEffect(()=>{if(O.current)return()=>{Q.current&&(Q.current.focus({preventScroll:!0}),Q.current=null,Y.current=!1)}},[O.current]),C.createElement("section",{ref:t,"aria-label":`${w} ${K}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},S.map((A,B)=>{var H;const[k,T]=A.split("-");return b.length?C.createElement("ol",{key:A,dir:x==="auto"?wr():x,tabIndex:-1,ref:O,className:d,"data-sonner-toaster":!0,"data-sonner-theme":ce,"data-y-position":k,"data-x-position":T,style:{"--front-toast-height":`${((H=I[0])==null?void 0:H.height)||0}px`,"--width":`${Go}px`,"--gap":`${$}px`,...g,...tl(c,h)},onBlur:N=>{Y.current&&!N.currentTarget.contains(N.relatedTarget)&&(Y.current=!1,Q.current&&(Q.current.focus({preventScroll:!0}),Q.current=null))},onFocus:N=>{N.target instanceof HTMLElement&&N.target.dataset.dismissible==="false"||Y.current||(Y.current=!0,Q.current=N.relatedTarget)},onMouseEnter:()=>z(!0),onMouseMove:()=>z(!0),onMouseLeave:()=>{V||z(!1)},onDragEnd:()=>z(!1),onPointerDown:N=>{N.target instanceof HTMLElement&&N.target.dataset.dismissible==="false"||re(!0)},onPointerUp:()=>re(!1)},b.filter(N=>!N.position&&B===0||N.position===A).map((N,te)=>{var J,oe;return C.createElement(el,{key:N.id,icons:_,index:te,toast:N,defaultRichColors:f,duration:(J=y==null?void 0:y.duration)!=null?J:p,className:y==null?void 0:y.className,descriptionClassName:y==null?void 0:y.descriptionClassName,invert:s,visibleToasts:j,closeButton:(oe=y==null?void 0:y.closeButton)!=null?oe:o,interacting:V,position:A,style:y==null?void 0:y.style,unstyled:y==null?void 0:y.unstyled,classNames:y==null?void 0:y.classNames,cancelButtonStyle:y==null?void 0:y.cancelButtonStyle,actionButtonStyle:y==null?void 0:y.actionButtonStyle,closeButtonAriaLabel:y==null?void 0:y.closeButtonAriaLabel,removeToast:L,toasts:b.filter(X=>X.position==N.position),heights:I.filter(X=>X.position==N.position),setHeights:U,expandByDefault:i,gap:$,expanded:ne,swipeDirections:e.swipeDirections})})):null}))});var se;(function(n){n.assertEqual=r=>{};function e(r){}n.assertIs=e;function t(r){throw new Error}n.assertNever=t,n.arrayToEnum=r=>{const a={};for(const i of r)a[i]=i;return a},n.getValidEnumValues=r=>{const a=n.objectKeys(r).filter(o=>typeof r[r[o]]!="number"),i={};for(const o of a)i[o]=r[o];return n.objectValues(i)},n.objectValues=r=>n.objectKeys(r).map(function(a){return r[a]}),n.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{const a=[];for(const i in r)Object.prototype.hasOwnProperty.call(r,i)&&a.push(i);return a},n.find=(r,a)=>{for(const i of r)if(a(i))return i},n.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&Number.isFinite(r)&&Math.floor(r)===r;function s(r,a=" | "){return r.map(i=>typeof i=="string"?`'${i}'`:i).join(a)}n.joinValues=s,n.jsonStringifyReplacer=(r,a)=>typeof a=="bigint"?a.toString():a})(se||(se={}));var xr;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(xr||(xr={}));const P=se.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),st=n=>{switch(typeof n){case"undefined":return P.undefined;case"string":return P.string;case"number":return Number.isNaN(n)?P.nan:P.number;case"boolean":return P.boolean;case"function":return P.function;case"bigint":return P.bigint;case"symbol":return P.symbol;case"object":return Array.isArray(n)?P.array:n===null?P.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?P.promise:typeof Map<"u"&&n instanceof Map?P.map:typeof Set<"u"&&n instanceof Set?P.set:typeof Date<"u"&&n instanceof Date?P.date:P.object;default:return P.unknown}},E=se.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Je extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(a){return a.message},s={_errors:[]},r=a=>{for(const i of a.issues)if(i.code==="invalid_union")i.unionErrors.map(r);else if(i.code==="invalid_return_type")r(i.returnTypeError);else if(i.code==="invalid_arguments")r(i.argumentsError);else if(i.path.length===0)s._errors.push(t(i));else{let o=s,d=0;for(;d<i.path.length;){const c=i.path[d];d===i.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(t(i))):o[c]=o[c]||{_errors:[]},o=o[c],d++}}};return r(this),s}static assert(e){if(!(e instanceof Je))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,se.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},s=[];for(const r of this.issues)if(r.path.length>0){const a=r.path[0];t[a]=t[a]||[],t[a].push(e(r))}else s.push(e(r));return{formErrors:s,fieldErrors:t}}get formErrors(){return this.flatten()}}Je.create=n=>new Je(n);const jn=(n,e)=>{let t;switch(n.code){case E.invalid_type:n.received===P.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case E.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,se.jsonStringifyReplacer)}`;break;case E.unrecognized_keys:t=`Unrecognized key(s) in object: ${se.joinValues(n.keys,", ")}`;break;case E.invalid_union:t="Invalid input";break;case E.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${se.joinValues(n.options)}`;break;case E.invalid_enum_value:t=`Invalid enum value. Expected ${se.joinValues(n.options)}, received '${n.received}'`;break;case E.invalid_arguments:t="Invalid function arguments";break;case E.invalid_return_type:t="Invalid function return type";break;case E.invalid_date:t="Invalid date";break;case E.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:se.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case E.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="bigint"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case E.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case E.custom:t="Invalid input";break;case E.invalid_intersection_types:t="Intersection results could not be merged";break;case E.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case E.not_finite:t="Number must be finite";break;default:t=e.defaultError,se.assertNever(n)}return{message:t}};let nl=jn;function rl(){return nl}const al=n=>{const{data:e,path:t,errorMaps:s,issueData:r}=n,a=[...t,...r.path||[]],i={...r,path:a};if(r.message!==void 0)return{...r,path:a,message:r.message};let o="";const d=s.filter(c=>!!c).slice().reverse();for(const c of d)o=c(i,{data:e,defaultError:o}).message;return{...r,path:a,message:o}};function R(n,e){const t=rl(),s=al({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===jn?void 0:jn].filter(r=>!!r)});n.common.issues.push(s)}class Ie{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const s=[];for(const r of t){if(r.status==="aborted")return M;r.status==="dirty"&&e.dirty(),s.push(r.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,t){const s=[];for(const r of t){const a=await r.key,i=await r.value;s.push({key:a,value:i})}return Ie.mergeObjectSync(e,s)}static mergeObjectSync(e,t){const s={};for(const r of t){const{key:a,value:i}=r;if(a.status==="aborted"||i.status==="aborted")return M;a.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof i.value<"u"||r.alwaysSet)&&(s[a.value]=i.value)}return{status:e.value,value:s}}}const M=Object.freeze({status:"aborted"}),fs=n=>({status:"dirty",value:n}),Pe=n=>({status:"valid",value:n}),_r=n=>n.status==="aborted",Sr=n=>n.status==="dirty",Vt=n=>n.status==="valid",zs=n=>typeof Promise<"u"&&n instanceof Promise;var D;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(D||(D={}));class lt{constructor(e,t,s,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=s,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const kr=(n,e)=>{if(Vt(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Je(n.common.issues);return this._error=t,this._error}}};function Z(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:s,description:r}=n;if(e&&(t||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(i,o)=>{const{message:d}=n;return i.code==="invalid_enum_value"?{message:d??o.defaultError}:typeof o.data>"u"?{message:d??s??o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:d??t??o.defaultError}},description:r}}class ee{get description(){return this._def.description}_getType(e){return st(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ie,ctx:{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(zs(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const s=this.safeParse(e,t);if(s.success)return s.data;throw s.error}safeParse(e,t){const s={common:{issues:[],async:(t==null?void 0:t.async)??!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},r=this._parseSync({data:e,path:s.path,parent:s});return kr(s,r)}"~validate"(e){var s,r;const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:t});return Vt(a)?{value:a.value}:{issues:t.common.issues}}catch(a){(r=(s=a==null?void 0:a.message)==null?void 0:s.toLowerCase())!=null&&r.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(a=>Vt(a)?{value:a.value}:{issues:t.common.issues})}async parseAsync(e,t){const s=await this.safeParseAsync(e,t);if(s.success)return s.data;throw s.error}async safeParseAsync(e,t){const s={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},r=this._parse({data:e,path:s.path,parent:s}),a=await(zs(r)?r:Promise.resolve(r));return kr(s,a)}refine(e,t){const s=r=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(r):t;return this._refinement((r,a)=>{const i=e(r),o=()=>a.addIssue({code:E.custom,...s(r)});return typeof Promise<"u"&&i instanceof Promise?i.then(d=>d?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(e,t){return this._refinement((s,r)=>e(s)?!0:(r.addIssue(typeof t=="function"?t(s,r):t),!1))}_refinement(e){return new Kt({schema:this,typeName:F.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return ot.create(this,this._def)}nullable(){return Zt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ve.create(this)}promise(){return Hs.create(this,this._def)}or(e){return Ws.create([this,e],this._def)}and(e){return Vs.create(this,e,this._def)}transform(e){return new Kt({...Z(this._def),schema:this,typeName:F.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Tn({...Z(this._def),innerType:this,defaultValue:t,typeName:F.ZodDefault})}brand(){return new Nl({typeName:F.ZodBranded,type:this,...Z(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Nn({...Z(this._def),innerType:this,catchValue:t,typeName:F.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Zn.create(this,e)}readonly(){return Cn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const il=/^c[^\s-]{8,}$/i,ol=/^[0-9a-z]+$/,ll=/^[0-9A-HJKMNP-TV-Z]{26}$/i,cl=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,dl=/^[a-z0-9_-]{21}$/i,ul=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,hl=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,fl=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,pl="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let ln;const ml=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,gl=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,yl=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,vl=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,bl=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,wl=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Ia="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",xl=new RegExp(`^${Ia}$`);function Ra(n){let e="[0-5]\\d";n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`);const t=n.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function _l(n){return new RegExp(`^${Ra(n)}$`)}function Sl(n){let e=`${Ia}T${Ra(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function kl(n,e){return!!((e==="v4"||!e)&&ml.test(n)||(e==="v6"||!e)&&yl.test(n))}function jl(n,e){if(!ul.test(n))return!1;try{const[t]=n.split(".");if(!t)return!1;const s=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),r=JSON.parse(atob(s));return!(typeof r!="object"||r===null||"typ"in r&&(r==null?void 0:r.typ)!=="JWT"||!r.alg||e&&r.alg!==e)}catch{return!1}}function El(n,e){return!!((e==="v4"||!e)&&gl.test(n)||(e==="v6"||!e)&&vl.test(n))}class it extends ee{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==P.string){const a=this._getOrReturnCtx(e);return R(a,{code:E.invalid_type,expected:P.string,received:a.parsedType}),M}const s=new Ie;let r;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(r=this._getOrReturnCtx(e,r),R(r,{code:E.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),s.dirty());else if(a.kind==="max")e.data.length>a.value&&(r=this._getOrReturnCtx(e,r),R(r,{code:E.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),s.dirty());else if(a.kind==="length"){const i=e.data.length>a.value,o=e.data.length<a.value;(i||o)&&(r=this._getOrReturnCtx(e,r),i?R(r,{code:E.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&R(r,{code:E.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),s.dirty())}else if(a.kind==="email")fl.test(e.data)||(r=this._getOrReturnCtx(e,r),R(r,{validation:"email",code:E.invalid_string,message:a.message}),s.dirty());else if(a.kind==="emoji")ln||(ln=new RegExp(pl,"u")),ln.test(e.data)||(r=this._getOrReturnCtx(e,r),R(r,{validation:"emoji",code:E.invalid_string,message:a.message}),s.dirty());else if(a.kind==="uuid")cl.test(e.data)||(r=this._getOrReturnCtx(e,r),R(r,{validation:"uuid",code:E.invalid_string,message:a.message}),s.dirty());else if(a.kind==="nanoid")dl.test(e.data)||(r=this._getOrReturnCtx(e,r),R(r,{validation:"nanoid",code:E.invalid_string,message:a.message}),s.dirty());else if(a.kind==="cuid")il.test(e.data)||(r=this._getOrReturnCtx(e,r),R(r,{validation:"cuid",code:E.invalid_string,message:a.message}),s.dirty());else if(a.kind==="cuid2")ol.test(e.data)||(r=this._getOrReturnCtx(e,r),R(r,{validation:"cuid2",code:E.invalid_string,message:a.message}),s.dirty());else if(a.kind==="ulid")ll.test(e.data)||(r=this._getOrReturnCtx(e,r),R(r,{validation:"ulid",code:E.invalid_string,message:a.message}),s.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),R(r,{validation:"url",code:E.invalid_string,message:a.message}),s.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),R(r,{validation:"regex",code:E.invalid_string,message:a.message}),s.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(r=this._getOrReturnCtx(e,r),R(r,{code:E.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),s.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(r=this._getOrReturnCtx(e,r),R(r,{code:E.invalid_string,validation:{startsWith:a.value},message:a.message}),s.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(r=this._getOrReturnCtx(e,r),R(r,{code:E.invalid_string,validation:{endsWith:a.value},message:a.message}),s.dirty()):a.kind==="datetime"?Sl(a).test(e.data)||(r=this._getOrReturnCtx(e,r),R(r,{code:E.invalid_string,validation:"datetime",message:a.message}),s.dirty()):a.kind==="date"?xl.test(e.data)||(r=this._getOrReturnCtx(e,r),R(r,{code:E.invalid_string,validation:"date",message:a.message}),s.dirty()):a.kind==="time"?_l(a).test(e.data)||(r=this._getOrReturnCtx(e,r),R(r,{code:E.invalid_string,validation:"time",message:a.message}),s.dirty()):a.kind==="duration"?hl.test(e.data)||(r=this._getOrReturnCtx(e,r),R(r,{validation:"duration",code:E.invalid_string,message:a.message}),s.dirty()):a.kind==="ip"?kl(e.data,a.version)||(r=this._getOrReturnCtx(e,r),R(r,{validation:"ip",code:E.invalid_string,message:a.message}),s.dirty()):a.kind==="jwt"?jl(e.data,a.alg)||(r=this._getOrReturnCtx(e,r),R(r,{validation:"jwt",code:E.invalid_string,message:a.message}),s.dirty()):a.kind==="cidr"?El(e.data,a.version)||(r=this._getOrReturnCtx(e,r),R(r,{validation:"cidr",code:E.invalid_string,message:a.message}),s.dirty()):a.kind==="base64"?bl.test(e.data)||(r=this._getOrReturnCtx(e,r),R(r,{validation:"base64",code:E.invalid_string,message:a.message}),s.dirty()):a.kind==="base64url"?wl.test(e.data)||(r=this._getOrReturnCtx(e,r),R(r,{validation:"base64url",code:E.invalid_string,message:a.message}),s.dirty()):se.assertNever(a);return{status:s.value,value:e.data}}_regex(e,t,s){return this.refinement(r=>e.test(r),{validation:t,code:E.invalid_string,...D.errToObj(s)})}_addCheck(e){return new it({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...D.errToObj(e)})}url(e){return this._addCheck({kind:"url",...D.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...D.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...D.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...D.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...D.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...D.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...D.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...D.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...D.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...D.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...D.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...D.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...D.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...D.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...D.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...D.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...D.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...D.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...D.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...D.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...D.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...D.errToObj(t)})}nonempty(e){return this.min(1,D.errToObj(e))}trim(){return new it({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new it({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new it({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}it.create=n=>new it({checks:[],typeName:F.ZodString,coerce:(n==null?void 0:n.coerce)??!1,...Z(n)});function Tl(n,e){const t=(n.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,r=t>s?t:s,a=Number.parseInt(n.toFixed(r).replace(".","")),i=Number.parseInt(e.toFixed(r).replace(".",""));return a%i/10**r}class _s extends ee{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==P.number){const a=this._getOrReturnCtx(e);return R(a,{code:E.invalid_type,expected:P.number,received:a.parsedType}),M}let s;const r=new Ie;for(const a of this._def.checks)a.kind==="int"?se.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),R(s,{code:E.invalid_type,expected:"integer",received:"float",message:a.message}),r.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(s=this._getOrReturnCtx(e,s),R(s,{code:E.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(s=this._getOrReturnCtx(e,s),R(s,{code:E.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):a.kind==="multipleOf"?Tl(e.data,a.value)!==0&&(s=this._getOrReturnCtx(e,s),R(s,{code:E.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),R(s,{code:E.not_finite,message:a.message}),r.dirty()):se.assertNever(a);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,D.toString(t))}gt(e,t){return this.setLimit("min",e,!1,D.toString(t))}lte(e,t){return this.setLimit("max",e,!0,D.toString(t))}lt(e,t){return this.setLimit("max",e,!1,D.toString(t))}setLimit(e,t,s,r){return new _s({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:D.toString(r)}]})}_addCheck(e){return new _s({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:D.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:D.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:D.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:D.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:D.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:D.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:D.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:D.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:D.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&se.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(t===null||s.value>t)&&(t=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(t)&&Number.isFinite(e)}}_s.create=n=>new _s({checks:[],typeName:F.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...Z(n)});class Ss extends ee{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==P.bigint)return this._getInvalidInput(e);let s;const r=new Ie;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(s=this._getOrReturnCtx(e,s),R(s,{code:E.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(s=this._getOrReturnCtx(e,s),R(s,{code:E.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),R(s,{code:E.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):se.assertNever(a);return{status:r.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return R(t,{code:E.invalid_type,expected:P.bigint,received:t.parsedType}),M}gte(e,t){return this.setLimit("min",e,!0,D.toString(t))}gt(e,t){return this.setLimit("min",e,!1,D.toString(t))}lte(e,t){return this.setLimit("max",e,!0,D.toString(t))}lt(e,t){return this.setLimit("max",e,!1,D.toString(t))}setLimit(e,t,s,r){return new Ss({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:D.toString(r)}]})}_addCheck(e){return new Ss({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:D.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:D.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:D.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:D.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:D.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Ss.create=n=>new Ss({checks:[],typeName:F.ZodBigInt,coerce:(n==null?void 0:n.coerce)??!1,...Z(n)});class jr extends ee{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==P.boolean){const s=this._getOrReturnCtx(e);return R(s,{code:E.invalid_type,expected:P.boolean,received:s.parsedType}),M}return Pe(e.data)}}jr.create=n=>new jr({typeName:F.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...Z(n)});class qs extends ee{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==P.date){const a=this._getOrReturnCtx(e);return R(a,{code:E.invalid_type,expected:P.date,received:a.parsedType}),M}if(Number.isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return R(a,{code:E.invalid_date}),M}const s=new Ie;let r;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(r=this._getOrReturnCtx(e,r),R(r,{code:E.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),s.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(r=this._getOrReturnCtx(e,r),R(r,{code:E.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),s.dirty()):se.assertNever(a);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new qs({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:D.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:D.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}qs.create=n=>new qs({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:F.ZodDate,...Z(n)});class Er extends ee{_parse(e){if(this._getType(e)!==P.symbol){const s=this._getOrReturnCtx(e);return R(s,{code:E.invalid_type,expected:P.symbol,received:s.parsedType}),M}return Pe(e.data)}}Er.create=n=>new Er({typeName:F.ZodSymbol,...Z(n)});class Tr extends ee{_parse(e){if(this._getType(e)!==P.undefined){const s=this._getOrReturnCtx(e);return R(s,{code:E.invalid_type,expected:P.undefined,received:s.parsedType}),M}return Pe(e.data)}}Tr.create=n=>new Tr({typeName:F.ZodUndefined,...Z(n)});class Nr extends ee{_parse(e){if(this._getType(e)!==P.null){const s=this._getOrReturnCtx(e);return R(s,{code:E.invalid_type,expected:P.null,received:s.parsedType}),M}return Pe(e.data)}}Nr.create=n=>new Nr({typeName:F.ZodNull,...Z(n)});class Cr extends ee{constructor(){super(...arguments),this._any=!0}_parse(e){return Pe(e.data)}}Cr.create=n=>new Cr({typeName:F.ZodAny,...Z(n)});class Ir extends ee{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Pe(e.data)}}Ir.create=n=>new Ir({typeName:F.ZodUnknown,...Z(n)});class ct extends ee{_parse(e){const t=this._getOrReturnCtx(e);return R(t,{code:E.invalid_type,expected:P.never,received:t.parsedType}),M}}ct.create=n=>new ct({typeName:F.ZodNever,...Z(n)});class Rr extends ee{_parse(e){if(this._getType(e)!==P.undefined){const s=this._getOrReturnCtx(e);return R(s,{code:E.invalid_type,expected:P.void,received:s.parsedType}),M}return Pe(e.data)}}Rr.create=n=>new Rr({typeName:F.ZodVoid,...Z(n)});class Ve extends ee{_parse(e){const{ctx:t,status:s}=this._processInputParams(e),r=this._def;if(t.parsedType!==P.array)return R(t,{code:E.invalid_type,expected:P.array,received:t.parsedType}),M;if(r.exactLength!==null){const i=t.data.length>r.exactLength.value,o=t.data.length<r.exactLength.value;(i||o)&&(R(t,{code:i?E.too_big:E.too_small,minimum:o?r.exactLength.value:void 0,maximum:i?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),s.dirty())}if(r.minLength!==null&&t.data.length<r.minLength.value&&(R(t,{code:E.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),s.dirty()),r.maxLength!==null&&t.data.length>r.maxLength.value&&(R(t,{code:E.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),s.dirty()),t.common.async)return Promise.all([...t.data].map((i,o)=>r.type._parseAsync(new lt(t,i,t.path,o)))).then(i=>Ie.mergeArray(s,i));const a=[...t.data].map((i,o)=>r.type._parseSync(new lt(t,i,t.path,o)));return Ie.mergeArray(s,a)}get element(){return this._def.type}min(e,t){return new Ve({...this._def,minLength:{value:e,message:D.toString(t)}})}max(e,t){return new Ve({...this._def,maxLength:{value:e,message:D.toString(t)}})}length(e,t){return new Ve({...this._def,exactLength:{value:e,message:D.toString(t)}})}nonempty(e){return this.min(1,e)}}Ve.create=(n,e)=>new Ve({type:n,minLength:null,maxLength:null,exactLength:null,typeName:F.ZodArray,...Z(e)});function Ft(n){if(n instanceof he){const e={};for(const t in n.shape){const s=n.shape[t];e[t]=ot.create(Ft(s))}return new he({...n._def,shape:()=>e})}else return n instanceof Ve?new Ve({...n._def,type:Ft(n.element)}):n instanceof ot?ot.create(Ft(n.unwrap())):n instanceof Zt?Zt.create(Ft(n.unwrap())):n instanceof kt?kt.create(n.items.map(e=>Ft(e))):n}class he extends ee{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=se.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==P.object){const c=this._getOrReturnCtx(e);return R(c,{code:E.invalid_type,expected:P.object,received:c.parsedType}),M}const{status:s,ctx:r}=this._processInputParams(e),{shape:a,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof ct&&this._def.unknownKeys==="strip"))for(const c in r.data)i.includes(c)||o.push(c);const d=[];for(const c of i){const h=a[c],u=r.data[c];d.push({key:{status:"valid",value:c},value:h._parse(new lt(r,u,r.path,c)),alwaysSet:c in r.data})}if(this._def.catchall instanceof ct){const c=this._def.unknownKeys;if(c==="passthrough")for(const h of o)d.push({key:{status:"valid",value:h},value:{status:"valid",value:r.data[h]}});else if(c==="strict")o.length>0&&(R(r,{code:E.unrecognized_keys,keys:o}),s.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const h of o){const u=r.data[h];d.push({key:{status:"valid",value:h},value:c._parse(new lt(r,u,r.path,h)),alwaysSet:h in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const c=[];for(const h of d){const u=await h.key,f=await h.value;c.push({key:u,value:f,alwaysSet:h.alwaysSet})}return c}).then(c=>Ie.mergeObjectSync(s,c)):Ie.mergeObjectSync(s,d)}get shape(){return this._def.shape()}strict(e){return D.errToObj,new he({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,s)=>{var a,i;const r=((i=(a=this._def).errorMap)==null?void 0:i.call(a,t,s).message)??s.defaultError;return t.code==="unrecognized_keys"?{message:D.errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new he({...this._def,unknownKeys:"strip"})}passthrough(){return new he({...this._def,unknownKeys:"passthrough"})}extend(e){return new he({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new he({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:F.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new he({...this._def,catchall:e})}pick(e){const t={};for(const s of se.objectKeys(e))e[s]&&this.shape[s]&&(t[s]=this.shape[s]);return new he({...this._def,shape:()=>t})}omit(e){const t={};for(const s of se.objectKeys(this.shape))e[s]||(t[s]=this.shape[s]);return new he({...this._def,shape:()=>t})}deepPartial(){return Ft(this)}partial(e){const t={};for(const s of se.objectKeys(this.shape)){const r=this.shape[s];e&&!e[s]?t[s]=r:t[s]=r.optional()}return new he({...this._def,shape:()=>t})}required(e){const t={};for(const s of se.objectKeys(this.shape))if(e&&!e[s])t[s]=this.shape[s];else{let a=this.shape[s];for(;a instanceof ot;)a=a._def.innerType;t[s]=a}return new he({...this._def,shape:()=>t})}keyof(){return Oa(se.objectKeys(this.shape))}}he.create=(n,e)=>new he({shape:()=>n,unknownKeys:"strip",catchall:ct.create(),typeName:F.ZodObject,...Z(e)});he.strictCreate=(n,e)=>new he({shape:()=>n,unknownKeys:"strict",catchall:ct.create(),typeName:F.ZodObject,...Z(e)});he.lazycreate=(n,e)=>new he({shape:n,unknownKeys:"strip",catchall:ct.create(),typeName:F.ZodObject,...Z(e)});class Ws extends ee{_parse(e){const{ctx:t}=this._processInputParams(e),s=this._def.options;function r(a){for(const o of a)if(o.result.status==="valid")return o.result;for(const o of a)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const i=a.map(o=>new Je(o.ctx.common.issues));return R(t,{code:E.invalid_union,unionErrors:i}),M}if(t.common.async)return Promise.all(s.map(async a=>{const i={...t,common:{...t.common,issues:[]},parent:null};return{result:await a._parseAsync({data:t.data,path:t.path,parent:i}),ctx:i}})).then(r);{let a;const i=[];for(const d of s){const c={...t,common:{...t.common,issues:[]},parent:null},h=d._parseSync({data:t.data,path:t.path,parent:c});if(h.status==="valid")return h;h.status==="dirty"&&!a&&(a={result:h,ctx:c}),c.common.issues.length&&i.push(c.common.issues)}if(a)return t.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(d=>new Je(d));return R(t,{code:E.invalid_union,unionErrors:o}),M}}get options(){return this._def.options}}Ws.create=(n,e)=>new Ws({options:n,typeName:F.ZodUnion,...Z(e)});function En(n,e){const t=st(n),s=st(e);if(n===e)return{valid:!0,data:n};if(t===P.object&&s===P.object){const r=se.objectKeys(e),a=se.objectKeys(n).filter(o=>r.indexOf(o)!==-1),i={...n,...e};for(const o of a){const d=En(n[o],e[o]);if(!d.valid)return{valid:!1};i[o]=d.data}return{valid:!0,data:i}}else if(t===P.array&&s===P.array){if(n.length!==e.length)return{valid:!1};const r=[];for(let a=0;a<n.length;a++){const i=n[a],o=e[a],d=En(i,o);if(!d.valid)return{valid:!1};r.push(d.data)}return{valid:!0,data:r}}else return t===P.date&&s===P.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class Vs extends ee{_parse(e){const{status:t,ctx:s}=this._processInputParams(e),r=(a,i)=>{if(_r(a)||_r(i))return M;const o=En(a.value,i.value);return o.valid?((Sr(a)||Sr(i))&&t.dirty(),{status:t.value,value:o.data}):(R(s,{code:E.invalid_intersection_types}),M)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([a,i])=>r(a,i)):r(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}Vs.create=(n,e,t)=>new Vs({left:n,right:e,typeName:F.ZodIntersection,...Z(t)});class kt extends ee{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==P.array)return R(s,{code:E.invalid_type,expected:P.array,received:s.parsedType}),M;if(s.data.length<this._def.items.length)return R(s,{code:E.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),M;!this._def.rest&&s.data.length>this._def.items.length&&(R(s,{code:E.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...s.data].map((i,o)=>{const d=this._def.items[o]||this._def.rest;return d?d._parse(new lt(s,i,s.path,o)):null}).filter(i=>!!i);return s.common.async?Promise.all(a).then(i=>Ie.mergeArray(t,i)):Ie.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new kt({...this._def,rest:e})}}kt.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new kt({items:n,typeName:F.ZodTuple,rest:null,...Z(e)})};class Or extends ee{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==P.map)return R(s,{code:E.invalid_type,expected:P.map,received:s.parsedType}),M;const r=this._def.keyType,a=this._def.valueType,i=[...s.data.entries()].map(([o,d],c)=>({key:r._parse(new lt(s,o,s.path,[c,"key"])),value:a._parse(new lt(s,d,s.path,[c,"value"]))}));if(s.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const d of i){const c=await d.key,h=await d.value;if(c.status==="aborted"||h.status==="aborted")return M;(c.status==="dirty"||h.status==="dirty")&&t.dirty(),o.set(c.value,h.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const d of i){const c=d.key,h=d.value;if(c.status==="aborted"||h.status==="aborted")return M;(c.status==="dirty"||h.status==="dirty")&&t.dirty(),o.set(c.value,h.value)}return{status:t.value,value:o}}}}Or.create=(n,e,t)=>new Or({valueType:e,keyType:n,typeName:F.ZodMap,...Z(t)});class ks extends ee{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==P.set)return R(s,{code:E.invalid_type,expected:P.set,received:s.parsedType}),M;const r=this._def;r.minSize!==null&&s.data.size<r.minSize.value&&(R(s,{code:E.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),r.maxSize!==null&&s.data.size>r.maxSize.value&&(R(s,{code:E.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());const a=this._def.valueType;function i(d){const c=new Set;for(const h of d){if(h.status==="aborted")return M;h.status==="dirty"&&t.dirty(),c.add(h.value)}return{status:t.value,value:c}}const o=[...s.data.values()].map((d,c)=>a._parse(new lt(s,d,s.path,c)));return s.common.async?Promise.all(o).then(d=>i(d)):i(o)}min(e,t){return new ks({...this._def,minSize:{value:e,message:D.toString(t)}})}max(e,t){return new ks({...this._def,maxSize:{value:e,message:D.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ks.create=(n,e)=>new ks({valueType:n,minSize:null,maxSize:null,typeName:F.ZodSet,...Z(e)});class Ar extends ee{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Ar.create=(n,e)=>new Ar({getter:n,typeName:F.ZodLazy,...Z(e)});class Pr extends ee{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return R(t,{received:t.data,code:E.invalid_literal,expected:this._def.value}),M}return{status:"valid",value:e.data}}get value(){return this._def.value}}Pr.create=(n,e)=>new Pr({value:n,typeName:F.ZodLiteral,...Z(e)});function Oa(n,e){return new Ht({values:n,typeName:F.ZodEnum,...Z(e)})}class Ht extends ee{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),s=this._def.values;return R(t,{expected:se.joinValues(s),received:t.parsedType,code:E.invalid_type}),M}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),s=this._def.values;return R(t,{received:t.data,code:E.invalid_enum_value,options:s}),M}return Pe(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Ht.create(e,{...this._def,...t})}exclude(e,t=this._def){return Ht.create(this.options.filter(s=>!e.includes(s)),{...this._def,...t})}}Ht.create=Oa;class $r extends ee{_parse(e){const t=se.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==P.string&&s.parsedType!==P.number){const r=se.objectValues(t);return R(s,{expected:se.joinValues(r),received:s.parsedType,code:E.invalid_type}),M}if(this._cache||(this._cache=new Set(se.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const r=se.objectValues(t);return R(s,{received:s.data,code:E.invalid_enum_value,options:r}),M}return Pe(e.data)}get enum(){return this._def.values}}$r.create=(n,e)=>new $r({values:n,typeName:F.ZodNativeEnum,...Z(e)});class Hs extends ee{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==P.promise&&t.common.async===!1)return R(t,{code:E.invalid_type,expected:P.promise,received:t.parsedType}),M;const s=t.parsedType===P.promise?t.data:Promise.resolve(t.data);return Pe(s.then(r=>this._def.type.parseAsync(r,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Hs.create=(n,e)=>new Hs({type:n,typeName:F.ZodPromise,...Z(e)});class Kt extends ee{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===F.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:s}=this._processInputParams(e),r=this._def.effect||null,a={addIssue:i=>{R(s,i),i.fatal?t.abort():t.dirty()},get path(){return s.path}};if(a.addIssue=a.addIssue.bind(a),r.type==="preprocess"){const i=r.transform(s.data,a);if(s.common.async)return Promise.resolve(i).then(async o=>{if(t.value==="aborted")return M;const d=await this._def.schema._parseAsync({data:o,path:s.path,parent:s});return d.status==="aborted"?M:d.status==="dirty"||t.value==="dirty"?fs(d.value):d});{if(t.value==="aborted")return M;const o=this._def.schema._parseSync({data:i,path:s.path,parent:s});return o.status==="aborted"?M:o.status==="dirty"||t.value==="dirty"?fs(o.value):o}}if(r.type==="refinement"){const i=o=>{const d=r.refinement(o,a);if(s.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return o.status==="aborted"?M:(o.status==="dirty"&&t.dirty(),i(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>o.status==="aborted"?M:(o.status==="dirty"&&t.dirty(),i(o.value).then(()=>({status:t.value,value:o.value}))))}if(r.type==="transform")if(s.common.async===!1){const i=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!Vt(i))return M;const o=r.transform(i.value,a);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(i=>Vt(i)?Promise.resolve(r.transform(i.value,a)).then(o=>({status:t.value,value:o})):M);se.assertNever(r)}}Kt.create=(n,e,t)=>new Kt({schema:n,typeName:F.ZodEffects,effect:e,...Z(t)});Kt.createWithPreprocess=(n,e,t)=>new Kt({schema:e,effect:{type:"preprocess",transform:n},typeName:F.ZodEffects,...Z(t)});class ot extends ee{_parse(e){return this._getType(e)===P.undefined?Pe(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ot.create=(n,e)=>new ot({innerType:n,typeName:F.ZodOptional,...Z(e)});class Zt extends ee{_parse(e){return this._getType(e)===P.null?Pe(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Zt.create=(n,e)=>new Zt({innerType:n,typeName:F.ZodNullable,...Z(e)});class Tn extends ee{_parse(e){const{ctx:t}=this._processInputParams(e);let s=t.data;return t.parsedType===P.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Tn.create=(n,e)=>new Tn({innerType:n,typeName:F.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Z(e)});class Nn extends ee{_parse(e){const{ctx:t}=this._processInputParams(e),s={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return zs(r)?r.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Je(s.common.issues)},input:s.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new Je(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}Nn.create=(n,e)=>new Nn({innerType:n,typeName:F.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Z(e)});class Dr extends ee{_parse(e){if(this._getType(e)!==P.nan){const s=this._getOrReturnCtx(e);return R(s,{code:E.invalid_type,expected:P.nan,received:s.parsedType}),M}return{status:"valid",value:e.data}}}Dr.create=n=>new Dr({typeName:F.ZodNaN,...Z(n)});class Nl extends ee{_parse(e){const{ctx:t}=this._processInputParams(e),s=t.data;return this._def.type._parse({data:s,path:t.path,parent:t})}unwrap(){return this._def.type}}class Zn extends ee{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return a.status==="aborted"?M:a.status==="dirty"?(t.dirty(),fs(a.value)):this._def.out._parseAsync({data:a.value,path:s.path,parent:s})})();{const r=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return r.status==="aborted"?M:r.status==="dirty"?(t.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:s.path,parent:s})}}static create(e,t){return new Zn({in:e,out:t,typeName:F.ZodPipeline})}}class Cn extends ee{_parse(e){const t=this._def.innerType._parse(e),s=r=>(Vt(r)&&(r.value=Object.freeze(r.value)),r);return zs(t)?t.then(r=>s(r)):s(t)}unwrap(){return this._def.innerType}}Cn.create=(n,e)=>new Cn({innerType:n,typeName:F.ZodReadonly,...Z(e)});var F;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(F||(F={}));const As=it.create;ct.create;Ve.create;const Cl=he.create;Ws.create;Vs.create;kt.create;Ht.create;Hs.create;ot.create;Zt.create;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aa="firebasestorage.googleapis.com",Pa="storageBucket",Il=2*60*1e3,Rl=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fe=class $a extends Kn{constructor(e,t,s=0){super(cn(e),`Firebase Storage: ${t} (${cn(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,$a.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return cn(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}};var ue;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ue||(ue={}));function cn(n){return"storage/"+n}function Gn(){const n="An unknown error occurred, please check the error payload for server response.";return new fe(ue.UNKNOWN,n)}function Ol(n){return new fe(ue.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function Al(n){return new fe(ue.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Pl(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new fe(ue.UNAUTHENTICATED,n)}function $l(){return new fe(ue.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Dl(n){return new fe(ue.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function Ll(){return new fe(ue.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Ul(){return new fe(ue.CANCELED,"User canceled the upload/download.")}function Bl(n){return new fe(ue.INVALID_URL,"Invalid URL '"+n+"'.")}function Ml(n){return new fe(ue.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Fl(){return new fe(ue.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Pa+"' property when initializing the app?")}function zl(){return new fe(ue.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function ql(){return new fe(ue.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Wl(n){return new fe(ue.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function In(n){return new fe(ue.INVALID_ARGUMENT,n)}function Da(){return new fe(ue.APP_DELETED,"The Firebase app was deleted.")}function Vl(n){return new fe(ue.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ms(n,e){return new fe(ue.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function os(n){throw new fe(ue.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=Ne.makeFromUrl(e,t)}catch{return new Ne(e,"")}if(s.path==="")return s;throw Ml(e)}static makeFromUrl(e,t){let s=null;const r="([A-Za-z0-9.\\-_]+)";function a(w){w.path.charAt(w.path.length-1)==="/"&&(w.path_=w.path_.slice(0,-1))}const i="(/(.*))?$",o=new RegExp("^gs://"+r+i,"i"),d={bucket:1,path:3};function c(w){w.path_=decodeURIComponent(w.path)}const h="v[A-Za-z0-9_]+",u=t.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",p=new RegExp(`^https?://${u}/${h}/b/${r}/o${f}`,"i"),g={bucket:1,path:3},j=t===Aa?"(?:storage.googleapis.com|storage.cloud.google.com)":t,y="([^?#]*)",x=new RegExp(`^https?://${j}/${r}/${y}`,"i"),_=[{regex:o,indices:d,postModify:a},{regex:p,indices:g,postModify:c},{regex:x,indices:{bucket:1,path:2},postModify:c}];for(let w=0;w<_.length;w++){const b=_[w],v=b.regex.exec(e);if(v){const S=v[b.indices.bucket];let I=v[b.indices.path];I||(I=""),s=new Ne(S,I),b.postModify(s);break}}if(s==null)throw Bl(e);return s}}class Hl{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kl(n,e,t){let s=1,r=null,a=null,i=!1,o=0;function d(){return o===2}let c=!1;function h(...y){c||(c=!0,e.apply(null,y))}function u(y){r=setTimeout(()=>{r=null,n(p,d())},y)}function f(){a&&clearTimeout(a)}function p(y,...x){if(c){f();return}if(y){f(),h.call(null,y,...x);return}if(d()||i){f(),h.call(null,y,...x);return}s<64&&(s*=2);let _;o===1?(o=2,_=0):_=(s+Math.random())*1e3,u(_)}let g=!1;function j(y){g||(g=!0,f(),!c&&(r!==null?(y||(o=2),clearTimeout(r),u(0)):y||(o=1)))}return u(0),a=setTimeout(()=>{i=!0,j(!0)},t),j}function Zl(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gl(n){return n!==void 0}function Jl(n){return typeof n=="object"&&!Array.isArray(n)}function Jn(n){return typeof n=="string"||n instanceof String}function Lr(n){return Qn()&&n instanceof Blob}function Qn(){return typeof Blob<"u"}function Ur(n,e,t,s){if(s<e)throw In(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw In(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yn(n,e,t){let s=e;return t==null&&(s=`https://${e}`),`${t}://${s}/v0${n}`}function La(n){const e=encodeURIComponent;let t="?";for(const s in n)if(n.hasOwnProperty(s)){const r=e(s)+"="+e(n[s]);t=t+r+"&"}return t=t.slice(0,-1),t}var St;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(St||(St={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ql(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,a=e.indexOf(n)!==-1;return t||r||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e,t,s,r,a,i,o,d,c,h,u,f=!0,p=!1){this.url_=e,this.method_=t,this.headers_=s,this.body_=r,this.successCodes_=a,this.additionalRetryCodes_=i,this.callback_=o,this.errorCallback_=d,this.timeout_=c,this.progressCallback_=h,this.connectionFactory_=u,this.retry=f,this.isUsingEmulator=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,j)=>{this.resolve_=g,this.reject_=j,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new Ps(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const i=o=>{const d=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(d,c)};this.progressCallback_!==null&&a.addUploadProgressListener(i),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(i),this.pendingConnection_=null;const o=a.getErrorCode()===St.NO_ERROR,d=a.getStatus();if(!o||Ql(d,this.additionalRetryCodes_)&&this.retry){const h=a.getErrorCode()===St.ABORT;s(!1,new Ps(!1,null,h));return}const c=this.successCodes_.indexOf(d)!==-1;s(!0,new Ps(c,a))})},t=(s,r)=>{const a=this.resolve_,i=this.reject_,o=r.connection;if(r.wasSuccessCode)try{const d=this.callback_(o,o.getResponse());Gl(d)?a(d):a()}catch(d){i(d)}else if(o!==null){const d=Gn();d.serverResponse=o.getErrorText(),this.errorCallback_?i(this.errorCallback_(o,d)):i(d)}else if(r.canceled){const d=this.appDelete_?Da():Ul();i(d)}else{const d=Ll();i(d)}};this.canceled_?t(!1,new Ps(!1,null,!0)):this.backoffId_=Kl(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Zl(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Ps{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function Xl(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function ec(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function tc(n,e){e&&(n["X-Firebase-GMPID"]=e)}function sc(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function nc(n,e,t,s,r,a,i=!0,o=!1){const d=La(n.urlParams),c=n.url+d,h=Object.assign({},n.headers);return tc(h,e),Xl(h,t),ec(h,a),sc(h,s),new Yl(c,n.method,h,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,i,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rc(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function ac(...n){const e=rc();if(e!==void 0){const t=new e;for(let s=0;s<n.length;s++)t.append(n[s]);return t.getBlob()}else{if(Qn())return new Blob(n);throw new fe(ue.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function ic(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oc(n){if(typeof atob>"u")throw Wl("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const We={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class dn{constructor(e,t){this.data=e,this.contentType=t||null}}function lc(n,e){switch(n){case We.RAW:return new dn(Ua(e));case We.BASE64:case We.BASE64URL:return new dn(Ba(n,e));case We.DATA_URL:return new dn(dc(e),uc(e))}throw Gn()}function Ua(n){const e=[];for(let t=0;t<n.length;t++){let s=n.charCodeAt(t);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const a=s,i=n.charCodeAt(++t);s=65536|(a&1023)<<10|i&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function cc(n){let e;try{e=decodeURIComponent(n)}catch{throw ms(We.DATA_URL,"Malformed data URL.")}return Ua(e)}function Ba(n,e){switch(n){case We.BASE64:{const r=e.indexOf("-")!==-1,a=e.indexOf("_")!==-1;if(r||a)throw ms(n,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case We.BASE64URL:{const r=e.indexOf("+")!==-1,a=e.indexOf("/")!==-1;if(r||a)throw ms(n,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=oc(e)}catch(r){throw r.message.includes("polyfill")?r:ms(n,"Invalid character found")}const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}class Ma{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw ms(We.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=t[1]||null;s!=null&&(this.base64=hc(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function dc(n){const e=new Ma(n);return e.base64?Ba(We.BASE64,e.rest):cc(e.rest)}function uc(n){return new Ma(n).contentType}function hc(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e,t){let s=0,r="";Lr(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(Lr(this.data_)){const s=this.data_,r=ic(s,e,t);return r===null?null:new rt(r)}else{const s=new Uint8Array(this.data_.buffer,e,t-e);return new rt(s,!0)}}static getBlob(...e){if(Qn()){const t=e.map(s=>s instanceof rt?s.data_:s);return new rt(ac.apply(null,t))}else{const t=e.map(i=>Jn(i)?lc(We.RAW,i).data:i.data_);let s=0;t.forEach(i=>{s+=i.byteLength});const r=new Uint8Array(s);let a=0;return t.forEach(i=>{for(let o=0;o<i.length;o++)r[a++]=i[o]}),new rt(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fa(n){let e;try{e=JSON.parse(n)}catch{return null}return Jl(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fc(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function pc(n,e){const t=e.split("/").filter(s=>s.length>0).join("/");return n.length===0?t:n+"/"+t}function za(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mc(n,e){return e}class _e{constructor(e,t,s,r){this.server=e,this.local=t||e,this.writable=!!s,this.xform=r||mc}}let $s=null;function gc(n){return!Jn(n)||n.length<2?n:za(n)}function qa(){if($s)return $s;const n=[];n.push(new _e("bucket")),n.push(new _e("generation")),n.push(new _e("metageneration")),n.push(new _e("name","fullPath",!0));function e(a,i){return gc(i)}const t=new _e("name");t.xform=e,n.push(t);function s(a,i){return i!==void 0?Number(i):i}const r=new _e("size");return r.xform=s,n.push(r),n.push(new _e("timeCreated")),n.push(new _e("updated")),n.push(new _e("md5Hash",null,!0)),n.push(new _e("cacheControl",null,!0)),n.push(new _e("contentDisposition",null,!0)),n.push(new _e("contentEncoding",null,!0)),n.push(new _e("contentLanguage",null,!0)),n.push(new _e("contentType",null,!0)),n.push(new _e("metadata","customMetadata",!0)),$s=n,$s}function yc(n,e){function t(){const s=n.bucket,r=n.fullPath,a=new Ne(s,r);return e._makeStorageReference(a)}Object.defineProperty(n,"ref",{get:t})}function vc(n,e,t){const s={};s.type="file";const r=t.length;for(let a=0;a<r;a++){const i=t[a];s[i.local]=i.xform(s,e[i.server])}return yc(s,n),s}function Wa(n,e,t){const s=Fa(e);return s===null?null:vc(n,s,t)}function bc(n,e,t,s){const r=Fa(e);if(r===null||!Jn(r.downloadTokens))return null;const a=r.downloadTokens;if(a.length===0)return null;const i=encodeURIComponent;return a.split(",").map(c=>{const h=n.bucket,u=n.fullPath,f="/b/"+i(h)+"/o/"+i(u),p=Yn(f,t,s),g=La({alt:"media",token:c});return p+g})[0]}function wc(n,e){const t={},s=e.length;for(let r=0;r<s;r++){const a=e[r];a.writable&&(t[a.server]=n[a.local])}return JSON.stringify(t)}class Va{constructor(e,t,s,r){this.url=e,this.method=t,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ha(n){if(!n)throw Gn()}function xc(n,e){function t(s,r){const a=Wa(n,r,e);return Ha(a!==null),a}return t}function _c(n,e){function t(s,r){const a=Wa(n,r,e);return Ha(a!==null),bc(a,r,n.host,n._protocol)}return t}function Ka(n){function e(t,s){let r;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?r=$l():r=Pl():t.getStatus()===402?r=Al(n.bucket):t.getStatus()===403?r=Dl(n.path):r=s,r.status=t.getStatus(),r.serverResponse=s.serverResponse,r}return e}function Sc(n){const e=Ka(n);function t(s,r){let a=e(s,r);return s.getStatus()===404&&(a=Ol(n.path)),a.serverResponse=r.serverResponse,a}return t}function kc(n,e,t){const s=e.fullServerUrl(),r=Yn(s,n.host,n._protocol),a="GET",i=n.maxOperationRetryTime,o=new Va(r,a,_c(n,t),i);return o.errorHandler=Sc(e),o}function jc(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function Ec(n,e,t){const s=Object.assign({},t);return s.fullPath=n.path,s.size=e.size(),s.contentType||(s.contentType=jc(null,e)),s}function Tc(n,e,t,s,r){const a=e.bucketOnlyServerUrl(),i={"X-Goog-Upload-Protocol":"multipart"};function o(){let _="";for(let w=0;w<2;w++)_=_+Math.random().toString().slice(2);return _}const d=o();i["Content-Type"]="multipart/related; boundary="+d;const c=Ec(e,s,r),h=wc(c,t),u="--"+d+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+d+`\r
Content-Type: `+c.contentType+`\r
\r
`,f=`\r
--`+d+"--",p=rt.getBlob(u,s,f);if(p===null)throw zl();const g={name:c.fullPath},j=Yn(a,n.host,n._protocol),y="POST",x=n.maxUploadRetryTime,$=new Va(j,y,xc(n,t),x);return $.urlParams=g,$.headers=i,$.body=p.uploadData(),$.errorHandler=Ka(e),$}class Nc{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=St.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=St.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=St.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,s,r,a){if(this.sent_)throw os("cannot .send() more than once");if(Na(e)&&s&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),a!==void 0)for(const i in a)a.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,a[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw os("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw os("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw os("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw os("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Cc extends Nc{initXhr(){this.xhr_.responseType="text"}}function Za(){return new Cc}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e,t){this._service=e,t instanceof Ne?this._location=t:this._location=Ne.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new jt(e,t)}get root(){const e=new Ne(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return za(this._location.path)}get storage(){return this._service}get parent(){const e=fc(this._location.path);if(e===null)return null;const t=new Ne(this._location.bucket,e);return new jt(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Vl(e)}}function Ic(n,e,t){n._throwIfRoot("uploadBytes");const s=Tc(n.storage,n._location,qa(),new rt(e,!0),t);return n.storage.makeRequestWithTokens(s,Za).then(r=>({metadata:r,ref:n}))}function Rc(n){n._throwIfRoot("getDownloadURL");const e=kc(n.storage,n._location,qa());return n.storage.makeRequestWithTokens(e,Za).then(t=>{if(t===null)throw ql();return t})}function Oc(n,e){const t=pc(n._location.path,e),s=new Ne(n._location.bucket,t);return new jt(n.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ac(n){return/^[A-Za-z]+:\/\//.test(n)}function Pc(n,e){return new jt(n,e)}function Ga(n,e){if(n instanceof Xn){const t=n;if(t._bucket==null)throw Fl();const s=new jt(t,t._bucket);return e!=null?Ga(s,e):s}else return e!==void 0?Oc(n,e):n}function $c(n,e){if(e&&Ac(e)){if(n instanceof Xn)return Pc(n,e);throw In("To use ref(service, url), the first argument must be a Storage instance.")}else return Ga(n,e)}function Br(n,e){const t=e==null?void 0:e[Pa];return t==null?null:Ne.makeFromBucketSpec(t,n)}function Dc(n,e,t,s={}){n.host=`${e}:${t}`;const r=Na(e);r&&(go(`https://${n.host}/b`),yo("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:a}=s;a&&(n._overrideAuthToken=typeof a=="string"?a:vo(a,n.app.options.projectId))}class Xn{constructor(e,t,s,r,a,i=!1){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=r,this._firebaseVersion=a,this._isUsingEmulator=i,this._bucket=null,this._host=Aa,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Il,this._maxUploadRetryTime=Rl,this._requests=new Set,r!=null?this._bucket=Ne.makeFromBucketSpec(r,this._host):this._bucket=Br(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ne.makeFromBucketSpec(this._url,e):this._bucket=Br(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ur("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ur("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(po(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new jt(this,e)}_makeRequest(e,t,s,r,a=!0){if(this._deleted)return new Hl(Da());{const i=nc(e,this._appId,s,r,t,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(e,t){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,r).getPromise()}}const Mr="@firebase/storage",Fr="0.13.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ja="storage";function Lc(n,e,t){return n=Jt(n),Ic(n,e,t)}function Uc(n){return n=Jt(n),Rc(n)}function Bc(n,e){return n=Jt(n),$c(n,e)}function Mc(n=Ta(),e){n=Jt(n);const s=Es(n,Ja).getImmediate({identifier:e}),r=mo("storage");return r&&Fc(s,...r),s}function Fc(n,e,t,s={}){Dc(n,e,t,s)}function zc(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new Xn(t,s,r,e,fo)}function qc(){ws(new xs(Ja,zc,"PUBLIC").setMultipleInstances(!0)),Wt(Mr,Fr,""),Wt(Mr,Fr,"esm2017")}qc();const Qa="@firebase/installations",er="0.6.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ya=1e4,Xa=`w:${er}`,ei="FIS_v2",Wc="https://firebaseinstallations.googleapis.com/v1",Vc=60*60*1e3,Hc="installations",Kc="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zc={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Et=new Ca(Hc,Kc,Zc);function ti(n){return n instanceof Kn&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function si({projectId:n}){return`${Wc}/projects/${n}/installations`}function ni(n){return{token:n.token,requestStatus:2,expiresIn:Jc(n.expiresIn),creationTime:Date.now()}}async function ri(n,e){const s=(await e.json()).error;return Et.create("request-failed",{requestName:n,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})}function ai({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function Gc(n,{refreshToken:e}){const t=ai(n);return t.append("Authorization",Qc(e)),t}async function ii(n){const e=await n();return e.status>=500&&e.status<600?n():e}function Jc(n){return Number(n.replace("s","000"))}function Qc(n){return`${ei} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yc({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const s=si(n),r=ai(n),a=e.getImmediate({optional:!0});if(a){const c=await a.getHeartbeatsHeader();c&&r.append("x-firebase-client",c)}const i={fid:t,authVersion:ei,appId:n.appId,sdkVersion:Xa},o={method:"POST",headers:r,body:JSON.stringify(i)},d=await ii(()=>fetch(s,o));if(d.ok){const c=await d.json();return{fid:c.fid||t,registrationStatus:2,refreshToken:c.refreshToken,authToken:ni(c.authToken)}}else throw await ri("Create Installation",d)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oi(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xc(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ed=/^[cdef][\w-]{21}$/,Rn="";function td(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=sd(n);return ed.test(t)?t:Rn}catch{return Rn}}function sd(n){return Xc(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ys(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const li=new Map;function ci(n,e){const t=Ys(n);di(t,e),nd(t,e)}function di(n,e){const t=li.get(n);if(t)for(const s of t)s(e)}function nd(n,e){const t=rd();t&&t.postMessage({key:n,fid:e}),ad()}let _t=null;function rd(){return!_t&&"BroadcastChannel"in self&&(_t=new BroadcastChannel("[Firebase] FID Change"),_t.onmessage=n=>{di(n.data.key,n.data.fid)}),_t}function ad(){li.size===0&&_t&&(_t.close(),_t=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const id="firebase-installations-database",od=1,Tt="firebase-installations-store";let un=null;function tr(){return un||(un=bo(id,od,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Tt)}}})),un}async function Ks(n,e){const t=Ys(n),r=(await tr()).transaction(Tt,"readwrite"),a=r.objectStore(Tt),i=await a.get(t);return await a.put(e,t),await r.done,(!i||i.fid!==e.fid)&&ci(n,e.fid),e}async function ui(n){const e=Ys(n),s=(await tr()).transaction(Tt,"readwrite");await s.objectStore(Tt).delete(e),await s.done}async function Xs(n,e){const t=Ys(n),r=(await tr()).transaction(Tt,"readwrite"),a=r.objectStore(Tt),i=await a.get(t),o=e(i);return o===void 0?await a.delete(t):await a.put(o,t),await r.done,o&&(!i||i.fid!==o.fid)&&ci(n,o.fid),o}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sr(n){let e;const t=await Xs(n.appConfig,s=>{const r=ld(s),a=cd(n,r);return e=a.registrationPromise,a.installationEntry});return t.fid===Rn?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function ld(n){const e=n||{fid:td(),registrationStatus:0};return hi(e)}function cd(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(Et.create("app-offline"));return{installationEntry:e,registrationPromise:r}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},s=dd(n,t);return{installationEntry:t,registrationPromise:s}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:ud(n)}:{installationEntry:e}}async function dd(n,e){try{const t=await Yc(n,e);return Ks(n.appConfig,t)}catch(t){throw ti(t)&&t.customData.serverCode===409?await ui(n.appConfig):await Ks(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function ud(n){let e=await zr(n.appConfig);for(;e.registrationStatus===1;)await oi(100),e=await zr(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:s}=await sr(n);return s||t}return e}function zr(n){return Xs(n,e=>{if(!e)throw Et.create("installation-not-found");return hi(e)})}function hi(n){return hd(n)?{fid:n.fid,registrationStatus:0}:n}function hd(n){return n.registrationStatus===1&&n.registrationTime+Ya<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fd({appConfig:n,heartbeatServiceProvider:e},t){const s=pd(n,t),r=Gc(n,t),a=e.getImmediate({optional:!0});if(a){const c=await a.getHeartbeatsHeader();c&&r.append("x-firebase-client",c)}const i={installation:{sdkVersion:Xa,appId:n.appId}},o={method:"POST",headers:r,body:JSON.stringify(i)},d=await ii(()=>fetch(s,o));if(d.ok){const c=await d.json();return ni(c)}else throw await ri("Generate Auth Token",d)}function pd(n,{fid:e}){return`${si(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nr(n,e=!1){let t;const s=await Xs(n.appConfig,a=>{if(!fi(a))throw Et.create("not-registered");const i=a.authToken;if(!e&&yd(i))return a;if(i.requestStatus===1)return t=md(n,e),a;{if(!navigator.onLine)throw Et.create("app-offline");const o=bd(a);return t=gd(n,o),o}});return t?await t:s.authToken}async function md(n,e){let t=await qr(n.appConfig);for(;t.authToken.requestStatus===1;)await oi(100),t=await qr(n.appConfig);const s=t.authToken;return s.requestStatus===0?nr(n,e):s}function qr(n){return Xs(n,e=>{if(!fi(e))throw Et.create("not-registered");const t=e.authToken;return wd(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function gd(n,e){try{const t=await fd(n,e),s=Object.assign(Object.assign({},e),{authToken:t});return await Ks(n.appConfig,s),t}catch(t){if(ti(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await ui(n.appConfig);else{const s=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Ks(n.appConfig,s)}throw t}}function fi(n){return n!==void 0&&n.registrationStatus===2}function yd(n){return n.requestStatus===2&&!vd(n)}function vd(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+Vc}function bd(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function wd(n){return n.requestStatus===1&&n.requestTime+Ya<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xd(n){const e=n,{installationEntry:t,registrationPromise:s}=await sr(e);return s?s.catch(console.error):nr(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _d(n,e=!1){const t=n;return await Sd(t),(await nr(t,e)).token}async function Sd(n){const{registrationPromise:e}=await sr(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kd(n){if(!n||!n.options)throw hn("App Configuration");if(!n.name)throw hn("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw hn(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function hn(n){return Et.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pi="installations",jd="installations-internal",Ed=n=>{const e=n.getProvider("app").getImmediate(),t=kd(e),s=Es(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:s,_delete:()=>Promise.resolve()}},Td=n=>{const e=n.getProvider("app").getImmediate(),t=Es(e,pi).getImmediate();return{getId:()=>xd(t),getToken:r=>_d(t,r)}};function Nd(){ws(new xs(pi,Ed,"PUBLIC")),ws(new xs(jd,Td,"PRIVATE"))}Nd();Wt(Qa,er);Wt(Qa,er,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zs="analytics",Cd="firebase_id",Id="origin",Rd=60*1e3,Od="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",rr="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ee=new wo("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ad={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Ce=new Ca("analytics","Analytics",Ad);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pd(n){if(!n.startsWith(rr)){const e=Ce.create("invalid-gtag-resource",{gtagURL:n});return Ee.warn(e.message),""}return n}function mi(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function $d(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function Dd(n,e){const t=$d("firebase-js-sdk-policy",{createScriptURL:Pd}),s=document.createElement("script"),r=`${rr}?l=${n}&id=${e}`;s.src=t?t==null?void 0:t.createScriptURL(r):r,s.async=!0,document.head.appendChild(s)}function Ld(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function Ud(n,e,t,s,r,a){const i=s[r];try{if(i)await e[i];else{const d=(await mi(t)).find(c=>c.measurementId===r);d&&await e[d.appId]}}catch(o){Ee.error(o)}n("config",r,a)}async function Bd(n,e,t,s,r){try{let a=[];if(r&&r.send_to){let i=r.send_to;Array.isArray(i)||(i=[i]);const o=await mi(t);for(const d of i){const c=o.find(u=>u.measurementId===d),h=c&&e[c.appId];if(h)a.push(h);else{a=[];break}}}a.length===0&&(a=Object.values(e)),await Promise.all(a),n("event",s,r||{})}catch(a){Ee.error(a)}}function Md(n,e,t,s){async function r(a,...i){try{if(a==="event"){const[o,d]=i;await Bd(n,e,t,o,d)}else if(a==="config"){const[o,d]=i;await Ud(n,e,t,s,o,d)}else if(a==="consent"){const[o,d]=i;n("consent",o,d)}else if(a==="get"){const[o,d,c]=i;n("get",o,d,c)}else if(a==="set"){const[o]=i;n("set",o)}else n(a,...i)}catch(o){Ee.error(o)}}return r}function Fd(n,e,t,s,r){let a=function(...i){window[s].push(arguments)};return window[r]&&typeof window[r]=="function"&&(a=window[r]),window[r]=Md(a,n,e,t),{gtagCore:a,wrappedGtag:window[r]}}function zd(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(rr)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qd=30,Wd=1e3;class Vd{constructor(e={},t=Wd){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const gi=new Vd;function Hd(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function Kd(n){var e;const{appId:t,apiKey:s}=n,r={method:"GET",headers:Hd(s)},a=Od.replace("{app-id}",t),i=await fetch(a,r);if(i.status!==200&&i.status!==304){let o="";try{const d=await i.json();!((e=d.error)===null||e===void 0)&&e.message&&(o=d.error.message)}catch{}throw Ce.create("config-fetch-failed",{httpStatus:i.status,responseMessage:o})}return i.json()}async function Zd(n,e=gi,t){const{appId:s,apiKey:r,measurementId:a}=n.options;if(!s)throw Ce.create("no-app-id");if(!r){if(a)return{measurementId:a,appId:s};throw Ce.create("no-api-key")}const i=e.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new Qd;return setTimeout(async()=>{o.abort()},Rd),yi({appId:s,apiKey:r,measurementId:a},i,o,e)}async function yi(n,{throttleEndTimeMillis:e,backoffCount:t},s,r=gi){var a;const{appId:i,measurementId:o}=n;try{await Gd(s,e)}catch(d){if(o)return Ee.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:i,measurementId:o};throw d}try{const d=await Kd(n);return r.deleteThrottleMetadata(i),d}catch(d){const c=d;if(!Jd(c)){if(r.deleteThrottleMetadata(i),o)return Ee.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:i,measurementId:o};throw d}const h=Number((a=c==null?void 0:c.customData)===null||a===void 0?void 0:a.httpStatus)===503?gr(t,r.intervalMillis,qd):gr(t,r.intervalMillis),u={throttleEndTimeMillis:Date.now()+h,backoffCount:t+1};return r.setThrottleMetadata(i,u),Ee.debug(`Calling attemptFetch again in ${h} millis`),yi(n,u,s,r)}}function Gd(n,e){return new Promise((t,s)=>{const r=Math.max(e-Date.now(),0),a=setTimeout(t,r);n.addEventListener(()=>{clearTimeout(a),s(Ce.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Jd(n){if(!(n instanceof Kn)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class Qd{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Yd(n,e,t,s,r){if(r&&r.global){n("event",t,s);return}else{const a=await e,i=Object.assign(Object.assign({},s),{send_to:a});n("event",t,i)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xd(){if(_o())try{await So()}catch(n){return Ee.warn(Ce.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return Ee.warn(Ce.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function eu(n,e,t,s,r,a,i){var o;const d=Zd(n);d.then(p=>{t[p.measurementId]=p.appId,n.options.measurementId&&p.measurementId!==n.options.measurementId&&Ee.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${p.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(p=>Ee.error(p)),e.push(d);const c=Xd().then(p=>{if(p)return s.getId()}),[h,u]=await Promise.all([d,c]);zd(a)||Dd(a,h.measurementId),r("js",new Date);const f=(o=i==null?void 0:i.config)!==null&&o!==void 0?o:{};return f[Id]="firebase",f.update=!0,u!=null&&(f[Cd]=u),r("config",h.measurementId,f),h.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(e){this.app=e}_delete(){return delete gs[this.app.options.appId],Promise.resolve()}}let gs={},Wr=[];const Vr={};let fn="dataLayer",su="gtag",Hr,vi,Kr=!1;function nu(){const n=[];if(xo()&&n.push("This is a browser extension environment."),jo()||n.push("Cookies are not available."),n.length>0){const e=n.map((s,r)=>`(${r+1}) ${s}`).join(" "),t=Ce.create("invalid-analytics-context",{errorInfo:e});Ee.warn(t.message)}}function ru(n,e,t){nu();const s=n.options.appId;if(!s)throw Ce.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Ee.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Ce.create("no-api-key");if(gs[s]!=null)throw Ce.create("already-exists",{id:s});if(!Kr){Ld(fn);const{wrappedGtag:a,gtagCore:i}=Fd(gs,Wr,Vr,fn,su);vi=a,Hr=i,Kr=!0}return gs[s]=eu(n,Wr,Vr,e,Hr,fn,t),new tu(n)}function au(n=Ta()){n=Jt(n);const e=Es(n,Zs);return e.isInitialized()?e.getImmediate():iu(n)}function iu(n,e={}){const t=Es(n,Zs);if(t.isInitialized()){const r=t.getImmediate();if(ko(e,t.getOptions()))return r;throw Ce.create("already-initialized")}return t.initialize({options:e})}function ou(n,e,t,s){n=Jt(n),Yd(vi,gs[n.app.options.appId],e,t,s).catch(r=>Ee.error(r))}const Zr="@firebase/analytics",Gr="0.10.17";function lu(){ws(new xs(Zs,(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();return ru(s,r,t)},"PUBLIC")),ws(new xs("analytics-internal",n,"PRIVATE")),Wt(Zr,Gr),Wt(Zr,Gr,"esm2017");function n(e){try{const t=e.getProvider(Zs).getImmediate();return{logEvent:(s,r,a)=>ou(t,s,r,a)}}catch(t){throw Ce.create("interop-component-reg-failed",{reason:t})}}}lu();const cu={apiKey:void 0,authDomain:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0,measurementId:void 0},en=Eo(cu);To(en);No(en);const du=Mc(en);typeof window<"u"&&au(en);async function uu(n,e){try{if(n.includes("firebase")&&n.includes("storage")||n==="/icon/icon.jpg"||n.includes("/icon/icon.jpg"))return n;if(n.startsWith("data:"))return console.log("  data URL"),n;console.log("  Storage:",n);let t;try{t=await fetch(n)}catch(c){console.warn(" CORS:",c);const h=`https://cors-anywhere.herokuapp.com/${n}`;t=await fetch(h)}if(!t.ok)throw new Error(`Failed to fetch icon: ${t.status}`);const s=await t.blob(),r=Date.now();let a="png";if(s.type){const c=s.type.toLowerCase();c.includes("svg")?a="svg":c.includes("png")?a="png":c.includes("jpeg")||c.includes("jpg")?a="jpg":c.includes("ico")?a="ico":c.includes("gif")?a="gif":c.includes("webp")&&(a="webp")}const i=`favicons/${e}-${r}.${a}`,o=Bc(du,i);await Lc(o,s);const d=await Uc(o);return console.log(" :",d),d}catch(t){return console.error(" :",t),n}}const hu=Cl({name:As().min(1,""),url:As().url(""),favicon:As().url("URL"),note:As().optional()});function bi({id:n,name:e,url:t,favicon:s,tags:r,note:a,onClose:i,onSave:o,onDelete:d}){const[c,h]=m.useState({name:e,url:t,favicon:s,note:a||""}),[u,f]=m.useState({}),[p,g]=m.useState(!1),[j,y]=m.useState(!1),x=v=>{const S=/\{([^}]+)\}/g;return(v.match(S)||[]).map(U=>U.replace(/\{|\}/g,"").trim())},$=v=>v.replace(/\{[^}]+\}/g,"").trim(),_=async()=>{if(!c.url||!c.url.startsWith("http")){f({url:"(http://https://)"});return}try{g(!0);const v=new URL(c.url).hostname,I=(z=>{try{return new URL(z).hostname.replace(/^www\./,"")}catch{return z.replace(/^(https?:\/\/)?(www\.)?/,"").split("/")[0]}})(c.url);console.log(" :",I);try{const z="favicon-cache-simple",V=localStorage.getItem(z);if(V){const re=JSON.parse(V);delete re[I],localStorage.setItem(z,JSON.stringify(re))}}catch(z){console.warn(":",z)}const U=Date.now(),ne=`https://www.google.com/s2/favicons?domain=${c.url}&sz=64&t=${U}`;h(z=>({...z,favicon:ne})),h(z=>({...z,name:v.replace("www.","").split(".")[0]})),f(z=>{const V={...z};return delete V.url,V}),console.log(" :",ne)}catch(v){console.error(":",v),f({url:""})}finally{g(!1)}},w=async v=>{v.preventDefault();try{y(!0);const S=hu.safeParse(c);if(!S.success){const z={};S.error.errors.forEach(V=>{z[V.path[0]]=V.message}),f(z);return}const I=x(c.note||""),U=$(c.note||"");let ne=c.favicon;if(c.favicon!==s){console.log(" ...");try{ne=await uu(c.favicon,n),console.log(" :",ne)}catch(z){console.warn(" URL:",z)}}else console.log(" ");if(c.favicon!==s){console.log(" Favicon ");const V=(re=>{try{return new URL(re).hostname.replace(/^www\./,"")}catch{return re.replace(/^(https?:\/\/)?(www\.)?/,"").split("/")[0]}})(c.url);try{const re="favicon-cache-simple",ce=localStorage.getItem(re);if(ce){const ae=JSON.parse(ce);delete ae[V],localStorage.setItem(re,JSON.stringify(ae)),console.log(" :",V)}}catch(re){console.warn(":",re)}}o({id:n,name:c.name,url:c.url,favicon:ne,tags:I,note:U}),i()}catch(S){console.error(":",S),f({submit:""})}finally{y(!1)}},b=v=>{const{name:S,value:I}=v.target;h(U=>({...U,[S]:I})),u[S]&&f(U=>{const ne={...U};return delete ne[S],ne})};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 select-none",children:l.jsxs(le.div,{className:"w-full max-w-md bg-white rounded-xl shadow-xl p-6 select-none",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{type:"spring",damping:25},children:[l.jsxs("div",{className:"flex justify-between items-center mb-4 select-none",children:[l.jsx("h2",{className:"text-xl font-semibold select-none",children:""}),l.jsx("button",{onClick:i,className:"text-gray-500 hover:text-gray-700 select-none",children:l.jsx("i",{className:"fa-solid fa-xmark select-none"})})]}),l.jsxs("form",{onSubmit:w,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1 select-none",children:""}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"url",name:"url",value:c.url,onChange:b,className:"flex-1 px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com"}),l.jsx("button",{type:"button",onClick:_,disabled:p||!c.url,className:"px-3 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:bg-blue-300 select-none",children:p?"...":""})]}),u.url&&l.jsx("p",{className:"mt-1 text-sm text-red-500 select-none",children:u.url})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1 select-none",children:""}),l.jsx("input",{type:"text",name:"name",value:c.name,onChange:b,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:""}),u.name&&l.jsx("p",{className:"mt-1 text-sm text-red-500 select-none",children:u.name})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1 select-none",children:""}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"flex-1",children:l.jsx("input",{type:"url",name:"favicon",value:c.favicon,onChange:b,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com/favicon.ico"})}),l.jsx("span",{className:"text-gray-400 select-none",children:""}),l.jsxs("label",{className:"cursor-pointer select-none",children:[l.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:v=>{var I;const S=(I=v.target.files)==null?void 0:I[0];if(S){const U=new FileReader;U.onload=ne=>{var z;(z=ne.target)!=null&&z.result&&h(V=>{var re;return{...V,favicon:(re=ne.target)==null?void 0:re.result}})},U.readAsDataURL(S)}}}),l.jsxs("div",{className:"px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-md text-sm text-gray-700 transition-colors select-none",children:[l.jsx("i",{className:"fa-solid fa-upload mr-1 select-none"}),""]})]})]}),c.favicon&&l.jsxs("div",{className:"mt-2 flex items-center select-none",children:[l.jsx("img",{src:c.favicon,alt:"",className:"w-8 h-8 rounded mr-2 select-none"}),l.jsx("span",{className:"text-xs text-gray-500 truncate max-w-xs select-none",children:c.favicon.startsWith("data:image")?"":c.favicon})]}),u.favicon&&l.jsx("p",{className:"mt-1 text-sm text-red-500 select-none",children:u.favicon})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 select-none",children:[" (",":  ",""," ","",")"]}),l.jsxs("div",{className:"text-xs text-gray-500 mb-1 select-none",children:["",""]}),l.jsx("textarea",{name:"note",value:c.note,onChange:b,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"..."})]}),l.jsxs("div",{className:"flex flex-col gap-4 pt-4 select-none",children:[l.jsxs("div",{className:"flex gap-2 select-none",children:[l.jsx("button",{type:"button",onClick:i,className:"flex-1 px-4 py-2 text-gray-700 border rounded-md hover:bg-gray-50 select-none",children:""}),l.jsx("button",{type:"submit",disabled:j,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed select-none",children:j?l.jsxs(l.Fragment,{children:[l.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-2"}),"..."]}):""})]}),u.submit&&l.jsx("p",{className:"text-red-500 text-sm text-center select-none",children:u.submit}),d&&l.jsxs("button",{type:"button",onClick:()=>{confirm("")&&(d(n),i())},className:"w-full px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 shadow-md select-none",children:[l.jsx("i",{className:"fa-solid fa-trash mr-2 select-none"}),""]})]})]})]})})}const fu=[{name:"",rgb:"0, 0, 0",preview:"#000000"},{name:"",rgb:"255, 255, 255",preview:"#ffffff"},{name:"",rgb:"239, 68, 68",preview:"#ef4444"},{name:"",rgb:"245, 158, 11",preview:"#f59e0b"},{name:"",rgb:"59, 130, 246",preview:"#3b82f6"},{name:"",rgb:"34, 197, 94",preview:"#22c55e"},{name:"",rgb:"147, 51, 234",preview:"#9333ea"}],wi=m.createContext(void 0);function pu({children:n}){const[e,t]=m.useState(()=>{const y=localStorage.getItem("cardOpacity");let x=y?parseFloat(y):.1;return x>1&&(x=x/100),Math.max(.05,Math.min(1,x))}),[s,r]=m.useState(()=>{const y=localStorage.getItem("searchBarOpacity");let x=y?parseFloat(y):.1;return x>1&&(x=x/100),Math.max(.05,Math.min(1,x))}),[a,i]=m.useState(()=>{const y=localStorage.getItem("parallaxEnabled");return y?JSON.parse(y):!0}),[o,d]=m.useState(()=>localStorage.getItem("cardColor")||"255, 255, 255"),[c,h]=m.useState(()=>localStorage.getItem("searchBarColor")||"255, 255, 255"),u=()=>window.innerHeight>window.innerWidth?"mobile":"1080p",[f,p]=m.useState(()=>localStorage.getItem("wallpaperResolution")||u()),[g,j]=m.useState(!1);return m.useEffect(()=>{localStorage.setItem("cardOpacity",e.toString())},[e]),m.useEffect(()=>{localStorage.setItem("searchBarOpacity",s.toString())},[s]),m.useEffect(()=>{localStorage.setItem("parallaxEnabled",JSON.stringify(a))},[a]),m.useEffect(()=>{localStorage.setItem("wallpaperResolution",f)},[f]),m.useEffect(()=>{localStorage.setItem("cardColor",o)},[o]),m.useEffect(()=>{localStorage.setItem("searchBarColor",c)},[c]),l.jsx(wi.Provider,{value:{cardOpacity:e,searchBarOpacity:s,parallaxEnabled:a,wallpaperResolution:f,isSettingsOpen:g,cardColor:o,searchBarColor:c,setCardOpacity:t,setSearchBarOpacity:r,setParallaxEnabled:i,setWallpaperResolution:p,setIsSettingsOpen:j,setCardColor:d,setSearchBarColor:h},children:n})}function Qt(){const n=m.useContext(wi);if(n===void 0)throw new Error("useTransparency must be used within a TransparencyProvider");return n}class mu{constructor(){de(this,"cacheKey","favicon-cache-simple");de(this,"defaultExpiry",7*24*60*60*1e3);de(this,"cache",{});de(this,"loadingPromises",new Map);this.loadCache()}loadCache(){try{const e=localStorage.getItem(this.cacheKey);e&&(this.cache=JSON.parse(e),this.cleanExpiredCache())}catch(e){console.warn(" favicon :",e),this.cache={}}}saveCache(){try{localStorage.setItem(this.cacheKey,JSON.stringify(this.cache))}catch(e){console.warn(" favicon :",e)}}cleanExpiredCache(){const e=Date.now(),t=[];for(const[s,r]of Object.entries(this.cache))e>r.expiry&&t.push(s);t.forEach(s=>{delete this.cache[s]}),t.length>0&&this.saveCache()}extractDomain(e){try{return new URL(e).hostname.replace(/^www\./,"")}catch{return e.replace(/^(https?:\/\/)?(www\.)?/,"").split("/")[0]}}getFaviconUrls(e,t){return[e,`https://www.google.com/s2/favicons?domain=${t}&sz=64`,`https://www.google.com/s2/favicons?domain=${t}&sz=32`,`https://icons.duckduckgo.com/ip3/${t}.ico`,`https://${t}/favicon.ico`,"/icon/icon.jpg"]}async tryLoadFavicon(e){for(const t of e)try{return await new Promise((s,r)=>{const a=new Image;a.onload=()=>s(),a.onerror=()=>r(),a.src=t,setTimeout(()=>r(new Error("")),1e3)}),console.log(` Favicon : ${t}`),t}catch(s){console.log(` Favicon : ${t} (${s})`);continue}return console.log("  favicon "),"/icon/icon.jpg"}getCachedFavicon(e){const t=this.extractDomain(e),s=this.cache[t];return s&&Date.now()<s.expiry?s.cachedUrl:null}async getFavicon(e,t){const s=this.extractDomain(e),r=this.getCachedFavicon(e);if(r)return console.log(`  favicon: ${s} -> ${r}`),r;if(!navigator.onLine)return console.log(` : ${s}`),"/icon/icon.jpg";if(this.loadingPromises.has(s))return this.loadingPromises.get(s);const a=this.loadFavicon(e,t,s);this.loadingPromises.set(s,a);try{return await a}finally{this.loadingPromises.delete(s)}}async loadFavicon(e,t,s){const r=this.getFaviconUrls(t,s);try{const a=await this.tryLoadFavicon(r);return this.cache[s]={url:e,cachedUrl:a,timestamp:Date.now(),expiry:Date.now()+this.defaultExpiry},this.saveCache(),a}catch(a){return console.warn(` favicon : ${s}`,a),"/icon/icon.jpg"}}async getFaviconWithIndexedDB(e,t){return this.getFavicon(e,t)}async getFaviconWithHybridCache(e,t){return this.getFavicon(e,t)}async batchCacheFaviconsToIndexedDB(e){console.log(`  ${e.length}  favicon`);let t=0,s=0,r=0;const a=2;for(let i=0;i<e.length;i+=a){const d=e.slice(i,i+a).map(async(c,h)=>{const u=this.extractDomain(c.url);try{if(this.getCachedFavicon(c.url)){s++;return}const p=(h+1)*500;await new Promise(j=>setTimeout(j,p)),console.log(` [${i+h+1}/${e.length}] : ${u}`),await this.getFavicon(c.url,c.favicon)?(t++,console.log(` : ${u}`)):r++}catch(f){r++,console.warn(` : ${u}`,f)}});await Promise.allSettled(d),i+a<e.length&&await new Promise(c=>setTimeout(c,1e3))}console.log("  favicon :"),console.log(`   : ${t}, : ${s}, : ${r}`)}clearCache(){this.cache={},this.loadingPromises.clear();try{localStorage.removeItem(this.cacheKey)}catch(e){console.warn(" favicon :",e)}}getCacheStats(){const e=Date.now(),t=Object.keys(this.cache).length,s=Object.values(this.cache).filter(a=>e>a.expiry).length;let r="0 KB";try{r=`${(new Blob([JSON.stringify(this.cache)]).size/1024).toFixed(1)} KB`}catch{}return{total:t,expired:s,size:r}}}const On=new mu;function gu(n,e){const[t,s]=m.useState(e),[r,a]=m.useState(!1),[i,o]=m.useState(!1);return m.useEffect(()=>{s(e),o(!1),a(!1);const d=e==="/icon/icon.jpg",c=e.includes("google.com/s2/favicons")&&!e.includes("&t=");if(d||c){const h=On.getCachedFavicon(n);if(h&&h!==e&&h!=="/icon/icon.jpg"){console.log(" :",h),s(h);return}d&&(a(!0),On.getFavicon(n,e).then(u=>{u!==e&&u!=="/icon/icon.jpg"&&(console.log(" :",u),s(u)),o(!1)}).catch(u=>{console.warn("Favicon :",u),o(!0)}).finally(()=>{a(!1)}))}},[n,e]),{faviconUrl:t,isLoading:r,error:i}}const Ds={mobile:640,tablet:768,desktop:1024,wide:1440},yu={columns:{mobile:2,tablet:3,tabletLandscape:4,desktop:6,wide:8},gaps:{mobile:"gap-x-2 gap-y-6",tablet:"gap-x-3 gap-y-8",desktop:"gap-x-4 gap-y-10"},cardSizes:{mobile:"w-full max-w-[160px]",tablet:"w-full max-w-[180px]",desktop:"w-full max-w-[200px]"}};function xi(n){const[e,t]=m.useState({width:typeof window<"u"?window.innerWidth:1024,height:typeof window<"u"?window.innerHeight:768}),[s,r]=m.useState("landscape"),[a,i]=m.useState("desktop"),o={...yu,...n};m.useEffect(()=>{const f=()=>{const p=window.innerWidth,g=window.innerHeight;t({width:p,height:g}),r(p>g?"landscape":"portrait"),p<Ds.mobile||p<Ds.tablet?i("mobile"):p<Ds.desktop?i("tablet"):p<Ds.wide?i("desktop"):i("wide")};return f(),window.addEventListener("resize",f),window.addEventListener("orientationchange",f),()=>{window.removeEventListener("resize",f),window.removeEventListener("orientationchange",f)}},[]);const d=()=>{const f=a==="tablet"&&s==="landscape";return{columns:f?o.columns.tabletLandscape:o.columns[a],gap:o.gaps[a==="wide"?"desktop":a],cardSize:o.cardSizes[a==="wide"?"desktop":a],deviceType:a,orientation:s,screenSize:e,isMobile:a==="mobile",isTablet:a==="tablet",isDesktop:a==="desktop"||a==="wide",isTabletLandscape:f}},c=()=>{const f=d(),p="grid";return f.isMobile?`${p} grid-cols-2 ${f.gap} px-2`:f.isTablet?f.isTabletLandscape?`${p} grid-cols-4 ${f.gap} px-4`:`${p} grid-cols-3 ${f.gap} px-4`:`${p} grid-cols-6 lg:grid-cols-8 ${f.gap} px-6`},h=()=>{const f=d(),p="relative group";return f.isMobile?`${p} ${f.cardSize} mx-auto`:f.isTablet?`${p} ${f.cardSize} mx-auto transform transition-transform duration-200 hover:scale-105`:`${p} ${f.cardSize} mx-auto transform transition-all duration-300 hover:scale-110 hover:z-10`},u=()=>{const f=d();return f.isMobile?{containerClass:"px-4 py-4",searchClass:"w-full max-w-lg mx-auto",buttonSize:"text-sm px-3 py-2"}:f.isTablet?{containerClass:"px-6 py-6",searchClass:"w-full max-w-2xl mx-auto",buttonSize:"text-base px-4 py-2"}:{containerClass:"px-8 py-8",searchClass:"w-full max-w-3xl mx-auto",buttonSize:"text-lg px-6 py-3"}};return{...d(),getGridClasses:c,getCardClasses:h,getSearchBarLayout:u}}function vu({id:n,name:e,url:t,favicon:s,tags:r,visitCount:a,note:i,index:o,moveCard:d,onSave:c,onDelete:h}){const[u,f]=m.useState(!1),[p,g]=m.useState(!1),[j,y]=m.useState(!1),x=m.useRef(null),$=m.useRef(null),{cardOpacity:_,cardColor:w}=Qt(),{faviconUrl:b,isLoading:v,error:S}=gu(t,s),{isMobile:I,getCardClasses:U}=xi(),[{isDragging:ne},z]=to({type:"WEBSITE_CARD",item:{id:n,index:o},collect:L=>({isDragging:L.isDragging()}),canDrag:()=>!I}),[,V]=so({accept:"WEBSITE_CARD",hover(L){if(!x.current)return;const A=L.index,B=o;A!==B&&(d(A,B),L.index=B)}});V(x),z(x);const re=()=>{$.current&&(clearTimeout($.current),$.current=null)};m.useEffect(()=>()=>{re()},[]);const ce=()=>{!I&&!ne&&g(!0)},ae=()=>{I||g(!1)},O=()=>{I&&(y(!0),setTimeout(()=>y(!1),200)),window.open(t,"_blank"),c({id:n,name:e,url:t,favicon:s,tags:r,note:i,visitCount:a+1,lastVisit:new Date().toISOString().split("T")[0]})},K=()=>{I&&f(!0)},Q=()=>{I&&($.current=setTimeout(K,500))},Y=()=>{$.current&&(clearTimeout($.current),$.current=null)};return l.jsxs(l.Fragment,{children:[l.jsxs(le.div,{className:`${U()} relative rounded-lg`,style:{opacity:ne?.5:1,backgroundColor:`rgba(${w}, ${_})`,backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.2)",transform:j&&I?"scale(0.95)":"scale(1)",transition:I?"transform 0.15s ease-in-out":"background-color 0.3s ease, border-color 0.3s ease"},onMouseEnter:ce,onMouseLeave:ae,onTouchStart:Q,onTouchEnd:Y,onTouchMove:Y,onTouchCancel:Y,onClick:O,whileTap:I?{scale:.95,transition:{duration:.15,ease:"easeInOut"}}:{},whileHover:I?{}:{scale:1.03,y:-4,transition:{duration:.3,ease:[.4,0,.2,1],type:"spring",stiffness:200,damping:15}},initial:{opacity:0,y:20},whileInView:{opacity:1,y:0,transition:{duration:.6,ease:"easeOut",delay:.1}},viewport:{once:!0},ref:x,children:[l.jsx("div",{className:`absolute ${I?"top-1 right-1":"bottom-0.5 right-0.5"} z-10`,children:l.jsx("button",{onClick:L=>{L.stopPropagation(),f(!0)},className:`p-1 text-white/50 hover:text-white select-none transition-all duration-500 ease-out ${I?"text-xs bg-black/20 rounded-full":""} ${p&&!I?"opacity-100":I?"opacity-70":"opacity-0"}`,children:l.jsx("i",{className:"fa-solid fa-gear text-xs select-none"})})}),l.jsxs("div",{className:`h-full flex flex-col ${I?"pt-2":"pt-3"} select-none`,children:[l.jsxs("div",{className:`flex flex-col items-center ${I?"px-1":"px-2"} select-none`,children:[l.jsxs("div",{className:`${I?"w-8 h-8 mb-1":"w-11 h-11 mb-1"} rounded-md overflow-hidden select-none relative`,children:[l.jsx("img",{src:b,alt:`${e} favicon`,className:"w-full h-full object-contain select-none",loading:"lazy",draggable:"false"}),v&&l.jsx("div",{className:`absolute top-0 right-0 ${I?"w-1.5 h-1.5":"w-2 h-2"} bg-yellow-400 rounded-full animate-pulse`,title:"..."}),!v&&S&&l.jsx("div",{className:`absolute top-0 right-0 ${I?"w-1.5 h-1.5":"w-2 h-2"} bg-red-400 rounded-full`,title:""})]}),l.jsx("h3",{className:`${I?"text-[0.65rem]":"text-xs"} font-medium text-white text-center line-clamp-2 px-2 mt-1 select-none`,children:e})]}),!I&&l.jsx("div",{className:"px-2 mb-1 select-none",children:l.jsx("p",{className:"text-white/60 text-[0.65rem] text-center line-clamp-2 select-none",children:i||new URL(t).hostname})}),l.jsx("div",{className:`mt-0 ${I?"px-1 pb-1":"px-3 pb-2"} select-none`,children:l.jsx("div",{className:"flex flex-wrap gap-1 justify-center select-none",children:r.slice(0,I?2:6).map(L=>l.jsx("span",{className:`px-1.5 py-0.5 bg-white/20 rounded-full ${I?"text-[0.55rem]":"text-[0.65rem]"} text-white ${I?"max-w-[45px]":"max-w-[60px]"} truncate select-none`,children:L},L))})}),a>0&&l.jsx("div",{className:"px-2 pb-2 select-none",children:l.jsx("div",{className:"text-center",children:l.jsxs("span",{className:`px-2 py-1 bg-blue-500/20 text-blue-200 rounded-full ${I?"text-[0.55rem]":"text-[0.65rem]"} border border-blue-300/30`,children:[l.jsx("i",{className:"fa-solid fa-eye mr-1"}),a,""]})})}),l.jsx("div",{className:"flex-1"})]}),!I&&p&&l.jsx(le.div,{className:"absolute inset-0 rounded-lg ring-2 ring-white/30 pointer-events-none",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.4,ease:"easeOut"}}),!I&&p&&l.jsx(le.div,{className:"absolute inset-0 rounded-lg pointer-events-none",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5,ease:"easeOut"},style:{boxShadow:"0 8px 25px rgba(0,0,0,0.2)",zIndex:-1}})]}),u&&l.jsx(bi,{id:n,name:e,url:t,favicon:s,tags:r,note:i,onClose:()=>f(!1),onSave:L=>{c(L),f(!1)},onDelete:h})]})}function bu(n={}){var B,H;const e=m.useRef(null);m.useEffect(()=>{const k=T=>{if(T.code==="Space"||T.key===" "||T.keyCode===32){const N=document.activeElement;!(N&&(N.tagName==="INPUT"||N.tagName==="TEXTAREA"||N.isContentEditable))&&e.current&&(T.preventDefault(),e.current.focus())}};return window.addEventListener("keydown",k,{capture:!0}),()=>window.removeEventListener("keydown",k,{capture:!0})},[]);const[t,s]=m.useState(""),[r,a]=m.useState(!1),[i,o]=m.useState("bing"),[d,c]=m.useState(!1),[h,u]=m.useState([]),[f,p]=m.useState(!1),[g,j]=m.useState(-1),y=m.useRef(null),[x,$]=m.useState(null),[_,w]=m.useState(null),[b,v]=m.useState(!1),S=m.useRef(null),{searchBarOpacity:I,searchBarColor:U}=Qt(),ne=[{key:"bing",label:"Bing",icon:l.jsx("i",{className:"fa-brands fa-microsoft text-blue-400"})},{key:"google",label:"Google",icon:l.jsx("i",{className:"fa-brands fa-google text-blue-500"})}],z=(k,T)=>{const N=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FECA57","#FF9FF3","#54A0FF","#5F27CD","#00D2D3","#FF9F43","#EE5A24","#FD79A8","#0FB9B1","#A55EEA","#26D0CE","#FDCB6E","#6C5CE7","#74B9FF","#E17055","#F39C12","#E74C3C","#3498DB","#9B59B6","#1ABC9C"],te=["M2,5 Q12,2 22,5 Q32,8 42,5 L42,8 Q32,11 22,8 Q12,5 2,8 Z","M20,2 L38,2 L29,12 Z","M20,7 A6,6 0,1,1 20,7.1 Z","M20,2 L30,7 L20,12 L10,7 Z","M20,2 L22,8 L28,8 L23,11 L25,17 L20,14 L15,17 L17,11 L12,8 L18,8 Z","M2,6 Q15,2 28,6 Q41,10 54,6 L54,9 Q41,13 28,9 Q15,5 2,9 Z","M5,5 L10,2 L15,5 L20,2 L25,5 L30,2 L35,5 L35,8 L30,11 L25,8 L20,11 L15,8 L10,11 L5,8 Z","M20,2 Q25,7 20,12 Q15,7 20,2 M20,2 Q25,7 30,2 Q25,7 30,12 Q25,7 20,12","M20,4 C18,2 15,2 15,5 C15,8 20,12 20,12 C20,12 25,8 25,5 C25,2 22,2 20,4 Z","M15,4 Q10,7 15,10 Q20,7 25,10 Q30,7 25,4 Q20,7 15,4","M5,4 Q20,2 35,4 Q40,7 35,10 Q20,8 5,10 Q0,7 5,4","M2,7 Q10,3 18,7 Q26,11 34,7 Q38,5 42,7 L42,10 Q38,8 34,10 Q26,14 18,10 Q10,6 2,10 Z"];for(let oe=0;oe<50;oe++){const X=document.createElementNS("http://www.w3.org/2000/svg","svg"),ye=document.createElementNS("http://www.w3.org/2000/svg","path"),Fe=N[Math.floor(Math.random()*N.length)],es=te[Math.floor(Math.random()*te.length)],Ct=Math.random()*.6+.5,ts=44*Ct,It=16*Ct;if(X.setAttribute("width",ts.toString()),X.setAttribute("height",It.toString()),X.setAttribute("viewBox","0 0 44 16"),X.style.cssText=`
        position: fixed;
        pointer-events: none;
        z-index: 10000;
        left: ${k-ts/2}px;
        top: ${T-It/2}px;
        transform-origin: center;
      `,ye.setAttribute("d",es),ye.setAttribute("fill",Fe),Math.random()>.5&&(ye.setAttribute("stroke",Fe),ye.setAttribute("stroke-width","1"),ye.setAttribute("fill-opacity","0.8")),Math.random()>.7){const Ye=`gradient-${Date.now()}-${oe}`,Oe=document.createElementNS("http://www.w3.org/2000/svg","defs"),$e=document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),ze=document.createElementNS("http://www.w3.org/2000/svg","stop"),is=document.createElementNS("http://www.w3.org/2000/svg","stop");$e.setAttribute("id",Ye),$e.setAttribute("x1","0%"),$e.setAttribute("y1","0%"),$e.setAttribute("x2","100%"),$e.setAttribute("y2","100%"),ze.setAttribute("offset","0%"),ze.setAttribute("stop-color",Fe),is.setAttribute("offset","100%"),is.setAttribute("stop-color",N[Math.floor(Math.random()*N.length)]),$e.appendChild(ze),$e.appendChild(is),Oe.appendChild($e),X.appendChild(Oe),ye.setAttribute("fill",`url(#${Ye})`)}X.appendChild(ye),document.body.appendChild(X);const Qe=Math.random()*360*(Math.PI/180),ss=Math.random()*4+2;let Re=Math.cos(Qe)*ss,ns=Math.sin(Qe)*ss;const nn=(Math.random()-.5)*80;let be=Math.random()*360,He=k-ts/2,rs=T-It/2;const rn=.2,ht=.998,an=Date.now(),as=()=>{const Ye=(Date.now()-an)/1e3;ns+=rn,Re*=ht,ns*=ht,He+=Re,rs+=ns,be+=nn*(1/60),X.style.left=He+"px",X.style.top=rs+"px",X.style.transform=`rotate(${be}deg)`;const Oe=Math.max(0,1-Ye/7);X.style.opacity=Oe.toString(),Oe>0&&rs<window.innerHeight+100?requestAnimationFrame(as):document.body.contains(X)&&document.body.removeChild(X)};setTimeout(()=>{requestAnimationFrame(as)},Math.random()*150)}},V=()=>{const k=ne.findIndex(N=>N.key===i),T=ne[(k+1)%ne.length].key;if(o(T),S.current){const N=S.current.getBoundingClientRect(),te=N.left+60,J=N.top+N.height/2;z(te,J)}},re=["chatGPT","Gemini","Deepseek","Kimi"],ce=["https://chatgpt.com/","https://gemini.google.com/","https://chat.deepseek.com/","https://www.kimi.com/"],ae=[l.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:22,height:22,verticalAlign:"middle",position:"relative",top:"1px",userSelect:"none"},children:l.jsx("img",{src:"/jiang_ai_web/icon/chatgpt.svg",alt:"chatGPT",style:{width:20,height:20,display:"block",userSelect:"none"}})}),l.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:22,height:22,verticalAlign:"middle",position:"relative",top:"1px",userSelect:"none"},children:l.jsx("img",{src:"/jiang_ai_web/icon/gemini.svg",alt:"Gemini",style:{width:20,height:20,display:"block",userSelect:"none"}})}),l.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:22,height:22,verticalAlign:"middle",position:"relative",top:"1px",userSelect:"none"},children:l.jsx("img",{src:"/jiang_ai_web/icon/deepseek.svg",alt:"Deepseek",style:{width:20,height:20,display:"block",userSelect:"none"}})}),l.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:22,height:22,verticalAlign:"middle",position:"relative",top:"1px",userSelect:"none"},children:l.jsx("img",{src:"/jiang_ai_web/icon/kimi.svg",alt:"Kimi",style:{width:20,height:20,display:"block",userSelect:"none"}})})],O=(k,T)=>{switch(k){case"google":return`https://www.google.com/search?q=${encodeURIComponent(T)}`;default:return`https://www.bing.com/search?q=${encodeURIComponent(T)}`}},K=async k=>{if(!k.trim())return[];try{const T=document.createElement("script"),N=`baiduCallback_${Date.now()}`;return new Promise(te=>{window[N]=J=>{if(J&&J.s&&Array.isArray(J.s)){const oe=J.s.slice(0,5).map((X,ye)=>({id:`baidu-${ye}`,text:X,query:X}));te(oe)}else{const oe=Q(k);te(oe.slice(0,5).map((X,ye)=>({id:`local-${ye}`,text:X,query:X})))}document.head.removeChild(T),delete window[N]},setTimeout(()=>{if(window[N]){const J=Q(k);te(J.slice(0,5).map((oe,X)=>({id:`local-${X}`,text:oe,query:oe}))),document.head.contains(T)&&document.head.removeChild(T),delete window[N]}},2e3),T.src=`https://suggestion.baidu.com/su?wd=${encodeURIComponent(k)}&cb=${N}`,T.onerror=()=>{const J=Q(k);te(J.slice(0,5).map((oe,X)=>({id:`local-${X}`,text:oe,query:oe}))),document.head.contains(T)&&document.head.removeChild(T),delete window[N]},document.head.appendChild(T)})}catch(T){return console.warn("Failed to fetch Baidu suggestions:",T),Q(k).slice(0,5).map((te,J)=>({id:`local-${J}`,text:te,query:te}))}},Q=k=>{const T=[],N=k.toLowerCase(),te=[k,`${k} `,`${k} `,`${k} `,` ${k}`,`${k} `,`${k} `,`${k} `];return N.includes("")||N.includes("how")?T.push(`${k}`,`${k} `,`${k} `):N.includes("")||N.includes("")?T.push(`${k}`,`${k} `,`${k} `):T.push(...te),[...new Set(T)]};m.useEffect(()=>{const k=setTimeout(()=>{t.trim()?K(t).then(T=>{u(T),p(T.length>0),j(-1)}):(u([]),p(!1),j(-1))},500);return()=>clearTimeout(k)},[t]);const Y=(k,T)=>{k.preventDefault();const N=T||(g>=0&&h[g]?h[g].query:t);N.trim()&&(window.open(O(i,N),"_blank"),s(""),p(!1))},L=k=>{switch(k.key){case"ArrowDown":if(!f)return;k.preventDefault(),j(T=>T<h.length-1?T+1:T);break;case"ArrowUp":if(!f)return;k.preventDefault(),j(T=>T>-1?T-1:-1);break;case"Escape":p(!1),j(-1);break;case"Tab":k.shiftKey||(k.preventDefault(),V());break}},A=m.useRef(null);return m.useLayoutEffect(()=>{if(d&&y.current){const k=y.current.getBoundingClientRect();$({left:k.left+k.width/2,top:k.top})}else $(null)},[d,i]),l.jsx("div",{className:"relative left-0 right-0 z-50 flex justify-center px-4 select-none",children:l.jsx(le.div,{className:"w-full flex justify-center",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},children:l.jsx("form",{ref:S,onSubmit:Y,className:"relative flex items-center justify-center",onMouseEnter:()=>{A.current&&(clearTimeout(A.current),A.current=null),a(!0)},onMouseLeave:()=>{A.current&&clearTimeout(A.current),A.current=setTimeout(()=>{a(!1),c(!1),setTimeout(()=>{p(!1)},100)},200)},children:l.jsxs(le.div,{animate:{width:r?520:340},initial:{width:340},transition:{type:"tween",duration:.28,ease:"easeInOut"},style:{display:"flex",alignItems:"center",position:"relative"},onAnimationComplete:()=>{r&&c(!0)},children:[l.jsxs("div",{className:"relative flex items-center",children:[l.jsxs("button",{type:"button",className:"flex items-center gap-2 px-1.5 py-1 text-white/80 hover:text-white bg-transparent border-none outline-none text-lg select-none relative z-20",style:{pointerEvents:"auto",height:36,minWidth:36,minHeight:36,justifyContent:"center",alignItems:"center",display:"flex"},tabIndex:-1,onClick:()=>{V()},onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),children:[(B=ne.find(k=>k.key===i))==null?void 0:B.icon,l.jsx("span",{className:"hidden sm:inline text-base font-semibold select-none",children:(H=ne.find(k=>k.key===i))==null?void 0:H.label})]}),b&&l.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800/90 text-white text-sm rounded-lg shadow-lg backdrop-blur-sm border border-white/10 whitespace-nowrap z-30",children:[" ",i==="bing"?"Google":"Bing",l.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-800/90"})]})]}),l.jsx("span",{className:"mx-2 text-white/30 select-none font-normal text-base z-10",children:"|"}),l.jsx("span",{className:"text-white/60 select-none font-normal text-base z-10"}),l.jsx("input",{ref:e,type:"text",value:t,onChange:k=>s(k.target.value),onKeyDown:L,placeholder:"...",className:"backdrop-blur-md border border-white/20 rounded-full pl-4 py-2 text-white placeholder-white/60 outline-none text-base transition-all duration-200 pr-12 w-full ml-3",style:{backgroundColor:`rgba(${U}, ${I})`,minWidth:"4rem",maxWidth:"100%"}}),l.jsx("button",{ref:y,type:"submit",className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 text-white/70 hover:text-white transition-colors bg-transparent border-none outline-none group select-none",style:{pointerEvents:"auto"},children:l.jsx(le.i,{className:"fa-solid fa-magnifying-glass text-sm",whileHover:{scale:1.22,rotate:18,color:"#fff"},whileTap:{scale:.95,rotate:0},animate:{color:r?"#fff":void 0},transition:{type:"spring",stiffness:350,damping:18},style:{display:"inline-block"}})}),f&&h.length>0&&l.jsx(le.div,{className:"absolute top-full left-0 right-0 mt-2 backdrop-blur-md rounded-lg shadow-lg border border-white/20 z-50 overflow-hidden max-h-60 overflow-y-auto",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.2},style:{pointerEvents:"auto",backgroundColor:"rgba(255, 255, 255, 0.9)"},children:h.map((k,T)=>l.jsx("div",{className:`px-4 py-3 cursor-pointer transition-colors border-b border-white/10 last:border-b-0 select-none ${T===g?"bg-blue-500/20 text-gray-800":"hover:bg-white/50 text-gray-700"}`,onClick:N=>{N.stopPropagation(),s(k.text),Y(N,k.query)},onMouseEnter:()=>j(T),onMouseDown:N=>N.preventDefault(),children:l.jsxs("div",{className:"flex items-center gap-3 select-none",children:[l.jsx("i",{className:"fa-solid fa-magnifying-glass text-gray-400 text-sm w-4 select-none"}),l.jsx("div",{className:"flex-1 min-w-0 select-none",children:l.jsx("div",{className:"font-medium text-sm truncate select-none",children:k.text})})]})},k.id))}),r&&d&&x&&l.jsx("div",{className:"fixed z-30",style:{left:x.left,top:x.top,width:0,height:0,pointerEvents:"auto",transform:"translate(-50%, -50%)"},children:l.jsx("div",{style:{position:"absolute",left:0,top:0},children:ae.map((k,T,N)=>{const J=(-60+120/(N.length-1)*T)*(Math.PI/180),oe=44,X=oe*Math.cos(J),ye=oe*Math.sin(J),Fe=19,es=Fe*3.6;return l.jsxs(le.span,{role:"img","aria-label":re[T],initial:{x:0,y:0,scale:.3,opacity:0,filter:"none"},animate:{x:X,y:ye,scale:1.18,opacity:1,filter:"none"},whileHover:{scale:1.38,filter:"drop-shadow(0 0 4px #fff) drop-shadow(0 0 8px #fff)"},transition:{type:"spring",stiffness:400,damping:22,delay:.08*T},style:{position:"absolute",left:0,top:0,fontSize:22,cursor:"pointer",userSelect:"none",zIndex:2,willChange:"filter, transform"},onClick:()=>window.open(ce[T],"_blank"),onMouseEnter:()=>w(T),onMouseLeave:()=>w(null),children:[k,_===T&&l.jsx("div",{style:{position:"absolute",left:28,top:"50%",transform:"translateY(-50%)",height:Fe,width:es,background:"rgba(255,255,255,0.98)",color:"#222",borderRadius:Fe/2,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 12px #0003",fontSize:14,fontWeight:500,pointerEvents:"auto",zIndex:10,padding:"0 10px",whiteSpace:"nowrap"},children:l.jsx("span",{style:{userSelect:"none"},children:re[T]})})]},T)})})})]})})})})}function wu(){const[n,e]=m.useState(!1);m.useEffect(()=>{const s=setTimeout(()=>{e(!0)},1e4);return()=>clearTimeout(s)},[]);const t=()=>{window.open("https://github.com/jiangjianghong","_blank")};return n?l.jsx("div",{className:"cat-container",children:l.jsxs("div",{className:"cat",onClick:t,style:{cursor:"pointer"},children:[l.jsx("div",{className:"paw"}),l.jsx("div",{className:"paw"}),l.jsxs("div",{className:"shake",children:[l.jsx("div",{className:"tail"}),l.jsxs("div",{className:"main",children:[l.jsx("div",{className:"head"}),l.jsx("div",{className:"body",children:l.jsx("div",{className:"leg"})}),l.jsxs("div",{className:"face",children:[l.jsxs("div",{className:"mustache_cont",children:[l.jsx("div",{className:"mustache"}),l.jsx("div",{className:"mustache"})]}),l.jsxs("div",{className:"mustache_cont",children:[l.jsx("div",{className:"mustache"}),l.jsx("div",{className:"mustache"})]}),l.jsx("div",{className:"nose"}),l.jsx("div",{className:"eye"}),l.jsx("div",{className:"eye"}),l.jsxs("div",{className:"brow_cont",children:[l.jsx("div",{className:"brow"}),l.jsx("div",{className:"brow"})]}),l.jsxs("div",{className:"brow_cont",children:[l.jsx("div",{className:"brow"}),l.jsx("div",{className:"brow"})]}),l.jsx("div",{className:"ear_l",children:l.jsx("div",{className:"inner"})}),l.jsxs("div",{className:"ear_r",children:[l.jsx("div",{className:"outer"}),l.jsx("div",{className:"inner"})]})]})]})]})]})}):null}const vt=class vt{constructor(){de(this,"isConnected",!0);de(this,"lastSuccessfulOperation",Date.now());de(this,"consecutiveFailures",0);de(this,"listeners",[])}static getInstance(){return vt.instance||(vt.instance=new vt),vt.instance}recordSuccess(){this.lastSuccessfulOperation=Date.now(),this.consecutiveFailures=0,this.isConnected||(this.isConnected=!0,console.log(" Firebase"),this.notifyListeners(!0))}recordFailure(e){this.consecutiveFailures++,this.consecutiveFailures>=3&&!navigator.onLine&&this.isConnected&&(this.isConnected=!1,console.log(" Firebase"),this.notifyListeners(!1)),console.log(` Firebase (${this.consecutiveFailures}/3):`,(e==null?void 0:e.message)||e)}isFirebaseConnected(){return navigator.onLine?Date.now()-this.lastSuccessfulOperation<5*60*1e3?!0:this.isConnected:!1}addListener(e){return this.listeners.push(e),e(this.isFirebaseConnected()),()=>{const t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}}notifyListeners(e){this.listeners.forEach(t=>{try{t(e)}catch(s){console.warn("Firebase:",s)}})}reset(){this.isConnected=!0,this.consecutiveFailures=0,this.lastSuccessfulOperation=Date.now()}};de(vt,"instance");let An=vt;const xu=An.getInstance(),_u=m.createContext(void 0);function dt(){const n=m.useContext(_u);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n}const Su="modulepreload",ku=function(n){return"/jiang_ai_web/"+n},Jr={},Ts=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){let i=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),d=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=i(t.map(c=>{if(c=ku(c),c in Jr)return;Jr[c]=!0;const h=c.endsWith(".css"),u=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const f=document.createElement("link");if(f.rel=h?"stylesheet":Su,h||(f.as="script"),f.crossOrigin="",f.href=c,d&&f.setAttribute("nonce",d),document.head.appendChild(f),h)return new Promise((p,g)=>{f.addEventListener("load",p),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return r.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return e().catch(a)})},ju=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ts(async()=>{const{default:s}=await Promise.resolve().then(()=>Yt);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class ar extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class Eu extends ar{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Qr extends ar{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Yr extends ar{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Pn;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Pn||(Pn={}));var Tu=function(n,e,t,s){function r(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(h){try{c(s.next(h))}catch(u){i(u)}}function d(h){try{c(s.throw(h))}catch(u){i(u)}}function c(h){h.done?a(h.value):r(h.value).then(o,d)}c((s=s.apply(n,e||[])).next())})};class Nu{constructor(e,{headers:t={},customFetch:s,region:r=Pn.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=ju(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return Tu(this,void 0,void 0,function*(){try{const{headers:r,method:a,body:i}=t;let o={},{region:d}=t;d||(d=this.region);const c=new URL(`${this.url}/${e}`);d&&d!=="any"&&(o["x-region"]=d,c.searchParams.set("forceFunctionRegion",d));let h;i&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",h=i):typeof i=="string"?(o["Content-Type"]="text/plain",h=i):typeof FormData<"u"&&i instanceof FormData?h=i:(o["Content-Type"]="application/json",h=JSON.stringify(i)));const u=yield this.fetch(c.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),r),body:h}).catch(j=>{throw new Eu(j)}),f=u.headers.get("x-relay-error");if(f&&f==="true")throw new Qr(u);if(!u.ok)throw new Yr(u);let p=((s=u.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),g;return p==="application/json"?g=yield u.json():p==="application/octet-stream"?g=yield u.blob():p==="text/event-stream"?g=u:p==="multipart/form-data"?g=yield u.formData():g=yield u.text(),{data:g,error:null,response:u}}catch(r){return{data:null,error:r,response:r instanceof Yr||r instanceof Qr?r.context:void 0}}})}}var me={},Rt={},Ot={},At={},Pt={},$t={},Cu=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Gt=Cu();const Iu=Gt.fetch,_i=Gt.fetch.bind(Gt),Si=Gt.Headers,Ru=Gt.Request,Ou=Gt.Response,Yt=Object.freeze(Object.defineProperty({__proto__:null,Headers:Si,Request:Ru,Response:Ou,default:_i,fetch:Iu},Symbol.toStringTag,{value:"Module"})),Au=uo(Yt);var Ls={},Xr;function ki(){if(Xr)return Ls;Xr=1,Object.defineProperty(Ls,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Ls.default=n,Ls}var ea;function ji(){if(ea)return $t;ea=1;var n=$t&&$t.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty($t,"__esModule",{value:!0});const e=n(Au),t=n(ki());class s{constructor(a){this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=a.headers,this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=a.shouldThrowOnError,this.signal=a.signal,this.isMaybeSingle=a.isMaybeSingle,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,i){return this.headers=Object.assign({},this.headers),this.headers[a]=i,this}then(a,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const o=this.fetch;let d=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var h,u,f;let p=null,g=null,j=null,y=c.status,x=c.statusText;if(c.ok){if(this.method!=="HEAD"){const b=await c.text();b===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?g=b:g=JSON.parse(b))}const _=(h=this.headers.Prefer)===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),w=(u=c.headers.get("content-range"))===null||u===void 0?void 0:u.split("/");_&&w&&w.length>1&&(j=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(p={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,j=null,y=406,x="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const _=await c.text();try{p=JSON.parse(_),Array.isArray(p)&&c.status===404&&(g=[],p=null,y=200,x="OK")}catch{c.status===404&&_===""?(y=204,x="No Content"):p={message:_}}if(p&&this.isMaybeSingle&&(!((f=p==null?void 0:p.details)===null||f===void 0)&&f.includes("0 rows"))&&(p=null,y=200,x="OK"),p&&this.shouldThrowOnError)throw new t.default(p)}return{error:p,data:g,count:j,status:y,statusText:x}});return this.shouldThrowOnError||(d=d.catch(c=>{var h,u,f;return{error:{message:`${(h=c==null?void 0:c.name)!==null&&h!==void 0?h:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(u=c==null?void 0:c.stack)!==null&&u!==void 0?u:""}`,hint:"",code:`${(f=c==null?void 0:c.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),d.then(a,i)}returns(){return this}overrideTypes(){return this}}return $t.default=s,$t}var ta;function Ei(){if(ta)return Pt;ta=1;var n=Pt&&Pt.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Pt,"__esModule",{value:!0});const e=n(ji());class t extends e.default{select(r){let a=!1;const i=(r??"*").split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(r,{ascending:a=!0,nullsFirst:i,foreignTable:o,referencedTable:d=o}={}){const c=d?`${d}.order`:"order",h=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${h?`${h},`:""}${r}.${a?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:a,referencedTable:i=a}={}){const o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(o,`${r}`),this}range(r,a,{foreignTable:i,referencedTable:o=i}={}){const d=typeof o>"u"?"offset":`${o}.offset`,c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(d,`${r}`),this.url.searchParams.set(c,`${a-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:r=!1,verbose:a=!1,settings:i=!1,buffers:o=!1,wal:d=!1,format:c="text"}={}){var h;const u=[r?"analyze":null,a?"verbose":null,i?"settings":null,o?"buffers":null,d?"wal":null].filter(Boolean).join("|"),f=(h=this.headers.Accept)!==null&&h!==void 0?h:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${f}"; options=${u};`,c==="json"?this:this}rollback(){var r;return((r=this.headers.Prefer)!==null&&r!==void 0?r:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Pt.default=t,Pt}var sa;function ir(){if(sa)return At;sa=1;var n=At&&At.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(At,"__esModule",{value:!0});const e=n(Ei());class t extends e.default{eq(r,a){return this.url.searchParams.append(r,`eq.${a}`),this}neq(r,a){return this.url.searchParams.append(r,`neq.${a}`),this}gt(r,a){return this.url.searchParams.append(r,`gt.${a}`),this}gte(r,a){return this.url.searchParams.append(r,`gte.${a}`),this}lt(r,a){return this.url.searchParams.append(r,`lt.${a}`),this}lte(r,a){return this.url.searchParams.append(r,`lte.${a}`),this}like(r,a){return this.url.searchParams.append(r,`like.${a}`),this}likeAllOf(r,a){return this.url.searchParams.append(r,`like(all).{${a.join(",")}}`),this}likeAnyOf(r,a){return this.url.searchParams.append(r,`like(any).{${a.join(",")}}`),this}ilike(r,a){return this.url.searchParams.append(r,`ilike.${a}`),this}ilikeAllOf(r,a){return this.url.searchParams.append(r,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(r,a){return this.url.searchParams.append(r,`ilike(any).{${a.join(",")}}`),this}is(r,a){return this.url.searchParams.append(r,`is.${a}`),this}in(r,a){const i=Array.from(new Set(a)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(r,`in.(${i})`),this}contains(r,a){return typeof a=="string"?this.url.searchParams.append(r,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(r,`cs.{${a.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(a)}`),this}containedBy(r,a){return typeof a=="string"?this.url.searchParams.append(r,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(r,`cd.{${a.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(a)}`),this}rangeGt(r,a){return this.url.searchParams.append(r,`sr.${a}`),this}rangeGte(r,a){return this.url.searchParams.append(r,`nxl.${a}`),this}rangeLt(r,a){return this.url.searchParams.append(r,`sl.${a}`),this}rangeLte(r,a){return this.url.searchParams.append(r,`nxr.${a}`),this}rangeAdjacent(r,a){return this.url.searchParams.append(r,`adj.${a}`),this}overlaps(r,a){return typeof a=="string"?this.url.searchParams.append(r,`ov.${a}`):this.url.searchParams.append(r,`ov.{${a.join(",")}}`),this}textSearch(r,a,{config:i,type:o}={}){let d="";o==="plain"?d="pl":o==="phrase"?d="ph":o==="websearch"&&(d="w");const c=i===void 0?"":`(${i})`;return this.url.searchParams.append(r,`${d}fts${c}.${a}`),this}match(r){return Object.entries(r).forEach(([a,i])=>{this.url.searchParams.append(a,`eq.${i}`)}),this}not(r,a,i){return this.url.searchParams.append(r,`not.${a}.${i}`),this}or(r,{foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.or`:"or";return this.url.searchParams.append(o,`(${r})`),this}filter(r,a,i){return this.url.searchParams.append(r,`${a}.${i}`),this}}return At.default=t,At}var na;function Ti(){if(na)return Ot;na=1;var n=Ot&&Ot.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ot,"__esModule",{value:!0});const e=n(ir());class t{constructor(r,{headers:a={},schema:i,fetch:o}){this.url=r,this.headers=a,this.schema=i,this.fetch=o}select(r,{head:a=!1,count:i}={}){const o=a?"HEAD":"GET";let d=!1;const c=(r??"*").split("").map(h=>/\s/.test(h)&&!d?"":(h==='"'&&(d=!d),h)).join("");return this.url.searchParams.set("select",c),i&&(this.headers.Prefer=`count=${i}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(r,{count:a,defaultToNull:i=!0}={}){const o="POST",d=[];if(this.headers.Prefer&&d.push(this.headers.Prefer),a&&d.push(`count=${a}`),i||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(r)){const c=r.reduce((h,u)=>h.concat(Object.keys(u)),[]);if(c.length>0){const h=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",h.join(","))}}return new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}upsert(r,{onConflict:a,ignoreDuplicates:i=!1,count:o,defaultToNull:d=!0}={}){const c="POST",h=[`resolution=${i?"ignore":"merge"}-duplicates`];if(a!==void 0&&this.url.searchParams.set("on_conflict",a),this.headers.Prefer&&h.push(this.headers.Prefer),o&&h.push(`count=${o}`),d||h.push("missing=default"),this.headers.Prefer=h.join(","),Array.isArray(r)){const u=r.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(u.length>0){const f=[...new Set(u)].map(p=>`"${p}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}update(r,{count:a}={}){const i="PATCH",o=[];return this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}delete({count:r}={}){const a="DELETE",i=[];return r&&i.push(`count=${r}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Ot.default=t,Ot}var ls={},cs={},ra;function Pu(){return ra||(ra=1,Object.defineProperty(cs,"__esModule",{value:!0}),cs.version=void 0,cs.version="0.0.0-automated"),cs}var aa;function $u(){if(aa)return ls;aa=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.DEFAULT_HEADERS=void 0;const n=Pu();return ls.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`},ls}var ia;function Du(){if(ia)return Rt;ia=1;var n=Rt&&Rt.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Rt,"__esModule",{value:!0});const e=n(Ti()),t=n(ir()),s=$u();class r{constructor(i,{headers:o={},schema:d,fetch:c}={}){this.url=i,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),o),this.schemaName=d,this.fetch=c}from(i){const o=new URL(`${this.url}/${i}`);return new e.default(o,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new r(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:d=!1,get:c=!1,count:h}={}){let u;const f=new URL(`${this.url}/rpc/${i}`);let p;d||c?(u=d?"HEAD":"GET",Object.entries(o).filter(([j,y])=>y!==void 0).map(([j,y])=>[j,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([j,y])=>{f.searchParams.append(j,y)})):(u="POST",p=o);const g=Object.assign({},this.headers);return h&&(g.Prefer=`count=${h}`),new t.default({method:u,url:f,headers:g,schema:this.schemaName,body:p,fetch:this.fetch,allowEmpty:!1})}}return Rt.default=r,Rt}var oa;function Lu(){if(oa)return me;oa=1;var n=me&&me.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(me,"__esModule",{value:!0}),me.PostgrestError=me.PostgrestBuilder=me.PostgrestTransformBuilder=me.PostgrestFilterBuilder=me.PostgrestQueryBuilder=me.PostgrestClient=void 0;const e=n(Du());me.PostgrestClient=e.default;const t=n(Ti());me.PostgrestQueryBuilder=t.default;const s=n(ir());me.PostgrestFilterBuilder=s.default;const r=n(Ei());me.PostgrestTransformBuilder=r.default;const a=n(ji());me.PostgrestBuilder=a.default;const i=n(ki());return me.PostgrestError=i.default,me.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:a.default,PostgrestError:i.default},me}var Uu=Lu();const Bu=ho(Uu),{PostgrestClient:Mu,PostgrestQueryBuilder:yp,PostgrestFilterBuilder:vp,PostgrestTransformBuilder:bp,PostgrestBuilder:wp,PostgrestError:xp}=Bu;function Fu(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const zu=Fu(),qu="2.11.15",Wu=`realtime-js/${qu}`,Vu="1.0.0",Ni=1e4,Hu=1e3;var ys;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(ys||(ys={}));var xe;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(xe||(xe={}));var Me;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Me||(Me={}));var $n;(function(n){n.websocket="websocket"})($n||($n={}));var yt;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(yt||(yt={}));class Ku{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const r=t.getUint8(1),a=t.getUint8(2);let i=this.HEADER_LENGTH+2;const o=s.decode(e.slice(i,i+r));i=i+r;const d=s.decode(e.slice(i,i+a));i=i+a;const c=JSON.parse(s.decode(e.slice(i,e.byteLength)));return{ref:null,topic:o,event:d,payload:c}}}class Ci{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ie;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(ie||(ie={}));const la=(n,e,t={})=>{var s;const r=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((a,i)=>(a[i]=Zu(i,n,e,r),a),{})},Zu=(n,e,t,s)=>{const r=e.find(o=>o.name===n),a=r==null?void 0:r.type,i=t[n];return a&&!s.includes(a)?Ii(a,i):Dn(i)},Ii=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Yu(e,t)}switch(n){case ie.bool:return Gu(e);case ie.float4:case ie.float8:case ie.int2:case ie.int4:case ie.int8:case ie.numeric:case ie.oid:return Ju(e);case ie.json:case ie.jsonb:return Qu(e);case ie.timestamp:return Xu(e);case ie.abstime:case ie.date:case ie.daterange:case ie.int4range:case ie.int8range:case ie.money:case ie.reltime:case ie.text:case ie.time:case ie.timestamptz:case ie.timetz:case ie.tsrange:case ie.tstzrange:return Dn(e);default:return Dn(e)}},Dn=n=>n,Gu=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Ju=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Qu=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},Yu=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,s=n[t];if(n[0]==="{"&&s==="}"){let a;const i=n.slice(1,t);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(o=>Ii(e,o))}return n},Xu=n=>typeof n=="string"?n.replace(" ","T"):n,Ri=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class pn{constructor(e,t,s={},r=Ni){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ca;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(ca||(ca={}));class vs{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=vs.syncState(this.state,r,a,i),this.pendingDiffs.forEach(d=>{this.state=vs.syncDiff(this.state,d,a,i)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},r=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=vs.syncDiff(this.state,r,a,i),o())}),this.onJoin((r,a,i)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:a,newPresences:i})}),this.onLeave((r,a,i)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,r){const a=this.cloneDeep(e),i=this.transformState(t),o={},d={};return this.map(a,(c,h)=>{i[c]||(d[c]=h)}),this.map(i,(c,h)=>{const u=a[c];if(u){const f=h.map(y=>y.presence_ref),p=u.map(y=>y.presence_ref),g=h.filter(y=>p.indexOf(y.presence_ref)<0),j=u.filter(y=>f.indexOf(y.presence_ref)<0);g.length>0&&(o[c]=g),j.length>0&&(d[c]=j)}else o[c]=h}),this.syncDiff(a,{joins:o,leaves:d},s,r)}static syncDiff(e,t,s,r){const{joins:a,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(a,(o,d)=>{var c;const h=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(d),h.length>0){const u=e[o].map(p=>p.presence_ref),f=h.filter(p=>u.indexOf(p.presence_ref)<0);e[o].unshift(...f)}s(o,h,d)}),this.map(i,(o,d)=>{let c=e[o];if(!c)return;const h=d.map(u=>u.presence_ref);c=c.filter(u=>h.indexOf(u.presence_ref)<0),e[o]=c,r(o,c,d),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const r=e[s];return"metas"in r?t[s]=r.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[s]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var da;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(da||(da={}));var ua;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(ua||(ua={}));var Ge;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(Ge||(Ge={}));class or{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=xe.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new pn(this,Me.join,this.params,this.timeout),this.rejoinTimer=new Ci(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=xe.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=xe.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=xe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=xe.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Me.reply,{},(r,a)=>{this._trigger(this._replyEventName(a),r)}),this.presence=new vs(this),this.broadcastEndpointURL=Ri(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,r;if(this.socket.isConnected()||this.socket.connect(),this.state==xe.closed){const{config:{broadcast:a,presence:i,private:o}}=this.params;this._onError(h=>e==null?void 0:e(Ge.CHANNEL_ERROR,h)),this._onClose(()=>e==null?void 0:e(Ge.CLOSED));const d={},c={broadcast:a,presence:i,postgres_changes:(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(h=>h.filter))!==null&&r!==void 0?r:[],private:o};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},d)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:h})=>{var u;if(this.socket.setAuth(),h===void 0){e==null||e(Ge.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,p=(u=f==null?void 0:f.length)!==null&&u!==void 0?u:0,g=[];for(let j=0;j<p;j++){const y=f[j],{filter:{event:x,schema:$,table:_,filter:w}}=y,b=h&&h[j];if(b&&b.event===x&&b.schema===$&&b.table===_&&b.filter===w)g.push(Object.assign(Object.assign({},y),{id:b.id}));else{this.unsubscribe(),this.state=xe.errored,e==null||e(Ge.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(Ge.SUBSCRIBED);return}}).receive("error",h=>{this.state=xe.errored,e==null||e(Ge.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Ge.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:i}=e,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((r=c.body)===null||r===void 0?void 0:r.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,o,d;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||d===void 0)&&d.ack)&&a("ok"),c.receive("ok",()=>a("ok")),c.receive("error",()=>a("error")),c.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=xe.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Me.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{s=new pn(this,Me.leave,{},e),s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,s){const r=new AbortController,a=setTimeout(()=>r.abort(),s),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(a),i}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new pn(this,e,t,s);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,a;const i=e.toLocaleLowerCase(),{close:o,error:d,leave:c,join:h}=Me;if(s&&[o,d,c,h].indexOf(i)>=0&&s!==this._joinRef())return;let f=this._onMessage(i,t,s);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(p=>{var g,j,y;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((y=(j=p.filter)===null||j===void 0?void 0:j.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===i}).map(p=>p.callback(f,s)):(a=this.bindings[i])===null||a===void 0||a.filter(p=>{var g,j,y,x,$,_;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const w=p.id,b=(g=p.filter)===null||g===void 0?void 0:g.event;return w&&((j=t.ids)===null||j===void 0?void 0:j.includes(w))&&(b==="*"||(b==null?void 0:b.toLocaleLowerCase())===((y=t.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const w=($=(x=p==null?void 0:p.filter)===null||x===void 0?void 0:x.event)===null||$===void 0?void 0:$.toLocaleLowerCase();return w==="*"||w===((_=t==null?void 0:t.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof f=="object"&&"ids"in f){const g=f.data,{schema:j,table:y,commit_timestamp:x,type:$,errors:_}=g;f=Object.assign(Object.assign({},{schema:j,table:y,commit_timestamp:x,eventType:$,new:{},old:{},errors:_}),this._getPayloadRecords(g))}p.callback(f,s)})}_isClosed(){return this.state===xe.closed}_isJoined(){return this.state===xe.joined}_isJoining(){return this.state===xe.joining}_isLeaving(){return this.state===xe.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),a={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(a):this.bindings[r]=[a],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(r=>{var a;return!(((a=r.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&or.isEqual(r.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Me.close,{},e)}_onError(e){this._on(Me.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=xe.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=la(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=la(e.columns,e.old_record)),t}}const ha=()=>{},eh=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class th{constructor(e,t){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ni,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ha,this.ref=0,this.logger=ha,this.conn=null,this.sendBuffer=[],this.serializer=new Ku,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...o)=>Ts(async()=>{const{default:d}=await Promise.resolve().then(()=>Yt);return{default:d}},void 0).then(({default:d})=>d(...o)):i=fetch,(...o)=>i(...o)},this.endPoint=`${e}/${$n.websocket}`,this.httpEndpoint=Ri(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const r=(s=t==null?void 0:t.params)===null||s===void 0?void 0:s.apikey;if(r&&(this.accessTokenValue=r,this.apiKey=r),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:a=>[1e3,2e3,5e3,1e4][a-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(a,i)=>i(JSON.stringify(a)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ci(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=zu),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Vu}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(s=>s.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case ys.connecting:return yt.Connecting;case ys.open:return yt.Open;case ys.closing:return yt.Closing;default:return yt.Closed}}isConnected(){return this.connectionState()===yt.Open}channel(e,t={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find(a=>a.topic===s);if(r)return r;{const a=new or(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:s,payload:r,ref:a}=e,i=()=>{this.encode(e,o=>{var d;(d=this.conn)===null||d===void 0||d.send(o)})};this.log("push",`${t} ${s} (${a})`,r),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const r={access_token:t,version:Wu};t&&s.updateJoinPayload(r),s.joinedOnce&&s._isJoined()&&s._push(Me.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Hu,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:s,event:r,payload:a,ref:i}=t;s==="phoenix"&&r==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${a.status||""} ${s} ${r} ${i&&"("+i+")"||""}`,a),Array.from(this.channels).filter(o=>o._isMember(s)).forEach(o=>o._trigger(r,a,i)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Me.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${s}${r}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([eh],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}}class lr extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ge(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class sh extends lr{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Ln extends lr{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var nh=function(n,e,t,s){function r(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(h){try{c(s.next(h))}catch(u){i(u)}}function d(h){try{c(s.throw(h))}catch(u){i(u)}}function c(h){h.done?a(h.value):r(h.value).then(o,d)}c((s=s.apply(n,e||[])).next())})};const Oi=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ts(async()=>{const{default:s}=await Promise.resolve().then(()=>Yt);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},rh=()=>nh(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ts(()=>Promise.resolve().then(()=>Yt),void 0)).Response:Response}),Un=n=>{if(Array.isArray(n))return n.map(t=>Un(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,s])=>{const r=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[r]=Un(s)}),e};var Nt=function(n,e,t,s){function r(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(h){try{c(s.next(h))}catch(u){i(u)}}function d(h){try{c(s.throw(h))}catch(u){i(u)}}function c(h){h.done?a(h.value):r(h.value).then(o,d)}c((s=s.apply(n,e||[])).next())})};const mn=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),ah=(n,e,t)=>Nt(void 0,void 0,void 0,function*(){const s=yield rh();n instanceof s&&!(t!=null&&t.noResolveJson)?n.json().then(r=>{e(new sh(mn(r),n.status||500))}).catch(r=>{e(new Ln(mn(r),r))}):e(new Ln(mn(n),n))}),ih=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s&&(r.body=JSON.stringify(s)),Object.assign(Object.assign({},r),t))};function Ns(n,e,t,s,r,a){return Nt(this,void 0,void 0,function*(){return new Promise((i,o)=>{n(t,ih(e,s,r,a)).then(d=>{if(!d.ok)throw d;return s!=null&&s.noResolveJson?d:d.json()}).then(d=>i(d)).catch(d=>ah(d,o,s))})})}function Gs(n,e,t,s){return Nt(this,void 0,void 0,function*(){return Ns(n,"GET",e,t,s)})}function nt(n,e,t,s,r){return Nt(this,void 0,void 0,function*(){return Ns(n,"POST",e,s,r,t)})}function oh(n,e,t,s,r){return Nt(this,void 0,void 0,function*(){return Ns(n,"PUT",e,s,r,t)})}function lh(n,e,t,s){return Nt(this,void 0,void 0,function*(){return Ns(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function Ai(n,e,t,s,r){return Nt(this,void 0,void 0,function*(){return Ns(n,"DELETE",e,s,r,t)})}var ke=function(n,e,t,s){function r(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(h){try{c(s.next(h))}catch(u){i(u)}}function d(h){try{c(s.throw(h))}catch(u){i(u)}}function c(h){h.done?a(h.value):r(h.value).then(o,d)}c((s=s.apply(n,e||[])).next())})};const ch={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},fa={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class dh{constructor(e,t={},s,r){this.url=e,this.headers=t,this.bucketId=s,this.fetch=Oi(r)}uploadOrUpdate(e,t,s,r){return ke(this,void 0,void 0,function*(){try{let a;const i=Object.assign(Object.assign({},fa),r);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const d=i.metadata;typeof Blob<"u"&&s instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),d&&a.append("metadata",this.encodeMetadata(d)),a.append("",s)):typeof FormData<"u"&&s instanceof FormData?(a=s,a.append("cacheControl",i.cacheControl),d&&a.append("metadata",this.encodeMetadata(d))):(a=s,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,d&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),r!=null&&r.headers&&(o=Object.assign(Object.assign({},o),r.headers));const c=this._removeEmptyFolders(t),h=this._getFinalPath(c),u=yield this.fetch(`${this.url}/object/${h}`,Object.assign({method:e,body:a,headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{})),f=yield u.json();return u.ok?{data:{path:c,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(a){if(ge(a))return{data:null,error:a};throw a}})}upload(e,t,s){return ke(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,r){return ke(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),i=this._getFinalPath(a),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let d;const c=Object.assign({upsert:fa.upsert},r),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&s instanceof Blob?(d=new FormData,d.append("cacheControl",c.cacheControl),d.append("",s)):typeof FormData<"u"&&s instanceof FormData?(d=s,d.append("cacheControl",c.cacheControl)):(d=s,h["cache-control"]=`max-age=${c.cacheControl}`,h["content-type"]=c.contentType);const u=yield this.fetch(o.toString(),{method:"PUT",body:d,headers:h}),f=yield u.json();return u.ok?{data:{path:a,fullPath:f.Key},error:null}:{data:null,error:f}}catch(d){if(ge(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(e,t){return ke(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const r=Object.assign({},this.headers);t!=null&&t.upsert&&(r["x-upsert"]="true");const a=yield nt(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:r}),i=new URL(this.url+a.url),o=i.searchParams.get("token");if(!o)throw new lr("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(s){if(ge(s))return{data:null,error:s};throw s}})}update(e,t,s){return ke(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return ke(this,void 0,void 0,function*(){try{return{data:yield nt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}})}copy(e,t,s){return ke(this,void 0,void 0,function*(){try{return{data:{path:(yield nt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,s){return ke(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),a=yield nt(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,s){return ke(this,void 0,void 0,function*(){try{const r=yield nt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:r.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${a}`):null})),error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}})}download(e,t){return ke(this,void 0,void 0,function*(){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=a?`?${a}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield Gs(this.fetch,`${this.url}/${r}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(ge(o))return{data:null,error:o};throw o}})}info(e){return ke(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield Gs(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Un(s),error:null}}catch(s){if(ge(s))return{data:null,error:s};throw s}})}exists(e){return ke(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield lh(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(ge(s)&&s instanceof Ln){const r=s.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),r=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&r.push(a);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});d!==""&&r.push(d);let c=r.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${s}${c}`)}}}remove(e){return ke(this,void 0,void 0,function*(){try{return{data:yield Ai(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(ge(t))return{data:null,error:t};throw t}})}list(e,t,s){return ke(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},ch),t),{prefix:e||""});return{data:yield nt(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const uh="2.7.1",hh={"X-Client-Info":`storage-js/${uh}`};var Dt=function(n,e,t,s){function r(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(h){try{c(s.next(h))}catch(u){i(u)}}function d(h){try{c(s.throw(h))}catch(u){i(u)}}function c(h){h.done?a(h.value):r(h.value).then(o,d)}c((s=s.apply(n,e||[])).next())})};class fh{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},hh),t),this.fetch=Oi(s)}listBuckets(){return Dt(this,void 0,void 0,function*(){try{return{data:yield Gs(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ge(e))return{data:null,error:e};throw e}})}getBucket(e){return Dt(this,void 0,void 0,function*(){try{return{data:yield Gs(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(ge(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Dt(this,void 0,void 0,function*(){try{return{data:yield nt(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(ge(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return Dt(this,void 0,void 0,function*(){try{return{data:yield oh(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(ge(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Dt(this,void 0,void 0,function*(){try{return{data:yield nt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(ge(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Dt(this,void 0,void 0,function*(){try{return{data:yield Ai(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(ge(t))return{data:null,error:t};throw t}})}}class ph extends fh{constructor(e,t={},s){super(e,t,s)}from(e){return new dh(this.url,this.headers,e,this.fetch)}}const mh="2.52.0";let ps="";typeof Deno<"u"?ps="deno":typeof document<"u"?ps="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ps="react-native":ps="node";const gh={"X-Client-Info":`supabase-js-${ps}/${mh}`},yh={headers:gh},vh={schema:"public"},bh={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},wh={};var xh=function(n,e,t,s){function r(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(h){try{c(s.next(h))}catch(u){i(u)}}function d(h){try{c(s.throw(h))}catch(u){i(u)}}function c(h){h.done?a(h.value):r(h.value).then(o,d)}c((s=s.apply(n,e||[])).next())})};const _h=n=>{let e;return n?e=n:typeof fetch>"u"?e=_i:e=fetch,(...t)=>e(...t)},Sh=()=>typeof Headers>"u"?Si:Headers,kh=(n,e,t)=>{const s=_h(t),r=Sh();return(a,i)=>xh(void 0,void 0,void 0,function*(){var o;const d=(o=yield e())!==null&&o!==void 0?o:n;let c=new r(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${d}`),s(a,Object.assign(Object.assign({},i),{headers:c}))})};var jh=function(n,e,t,s){function r(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(h){try{c(s.next(h))}catch(u){i(u)}}function d(h){try{c(s.throw(h))}catch(u){i(u)}}function c(h){h.done?a(h.value):r(h.value).then(o,d)}c((s=s.apply(n,e||[])).next())})};function Eh(n){return n.endsWith("/")?n:n+"/"}function Th(n,e){var t,s;const{db:r,auth:a,realtime:i,global:o}=n,{db:d,auth:c,realtime:h,global:u}=e,f={db:Object.assign(Object.assign({},d),r),auth:Object.assign(Object.assign({},c),a),realtime:Object.assign(Object.assign({},h),i),global:Object.assign(Object.assign(Object.assign({},u),o),{headers:Object.assign(Object.assign({},(t=u==null?void 0:u.headers)!==null&&t!==void 0?t:{}),(s=o==null?void 0:o.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>jh(this,void 0,void 0,function*(){return""})};return n.accessToken?f.accessToken=n.accessToken:delete f.accessToken,f}const Pi="2.71.1",zt=30*1e3,Bn=3,gn=Bn*zt,Nh="http://localhost:9999",Ch="supabase.auth.token",Ih={"X-Client-Info":`gotrue-js/${Pi}`},Mn="X-Supabase-Api-Version",$i={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Rh=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Oh=10*60*1e3;class cr extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function q(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class Ah extends cr{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function Ph(n){return q(n)&&n.name==="AuthApiError"}class Di extends cr{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ut extends cr{constructor(e,t,s,r){super(e,s,r),this.name=t,this.status=s}}class tt extends ut{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function $h(n){return q(n)&&n.name==="AuthSessionMissingError"}class Us extends ut{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Bs extends ut{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ms extends ut{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Dh(n){return q(n)&&n.name==="AuthImplicitGrantRedirectError"}class pa extends ut{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Fn extends ut{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function yn(n){return q(n)&&n.name==="AuthRetryableFetchError"}class ma extends ut{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class zn extends ut{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Js="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ga=` 	
\r=`.split(""),Lh=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<ga.length;e+=1)n[ga[e].charCodeAt(0)]=-2;for(let e=0;e<Js.length;e+=1)n[Js[e].charCodeAt(0)]=e;return n})();function ya(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Js[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Js[s]),e.queuedBits-=6}}function Li(n,e,t){const s=Lh[n];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function va(n){const e=[],t=i=>{e.push(String.fromCodePoint(i))},s={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},a=i=>{Mh(i,s,t)};for(let i=0;i<n.length;i+=1)Li(n.charCodeAt(i),r,a);return e.join("")}function Uh(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function Bh(n,e){for(let t=0;t<n.length;t+=1){let s=n.charCodeAt(t);if(s>55295&&s<=56319){const r=(s-55296)*1024&65535;s=(n.charCodeAt(t+1)-56320&65535|r)+65536,t+=1}Uh(s,e)}}function Mh(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let s=1;s<6;s+=1)if((n>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Fh(n){const e=[],t={queue:0,queuedBits:0},s=r=>{e.push(r)};for(let r=0;r<n.length;r+=1)Li(n.charCodeAt(r),t,s);return new Uint8Array(e)}function zh(n){const e=[];return Bh(n,t=>e.push(t)),new Uint8Array(e)}function qh(n){const e=[],t={queue:0,queuedBits:0},s=r=>{e.push(r)};return n.forEach(r=>ya(r,t,s)),ya(null,t,s),e.join("")}function Wh(n){return Math.round(Date.now()/1e3)+n}function Vh(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const Be=()=>typeof window<"u"&&typeof document<"u",pt={tested:!1,writable:!1},Ui=()=>{if(!Be())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(pt.tested)return pt.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),pt.tested=!0,pt.writable=!0}catch{pt.tested=!0,pt.writable=!1}return pt.writable};function Hh(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((r,a)=>{e[a]=r})}catch{}return t.searchParams.forEach((s,r)=>{e[r]=s}),e}const Bi=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ts(async()=>{const{default:s}=await Promise.resolve().then(()=>Yt);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Kh=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",qt=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},mt=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},et=async(n,e)=>{await n.removeItem(e)};class tn{constructor(){this.promise=new tn.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}tn.promiseConstructor=Promise;function vn(n){const e=n.split(".");if(e.length!==3)throw new zn("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!Rh.test(e[s]))throw new zn("JWT not in base64url format");return{header:JSON.parse(va(e[0])),payload:JSON.parse(va(e[1])),signature:Fh(e[2]),raw:{header:e[0],payload:e[1]}}}async function Zh(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function Gh(n,e){return new Promise((s,r)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await n(a);if(!e(a,null,i)){s(i);return}}catch(i){if(!e(a,i)){r(i);return}}})()})}function Jh(n){return("0"+n.toString(16)).substr(-2)}function Qh(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let r="";for(let a=0;a<56;a++)r+=t.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,Jh).join("")}async function Yh(n){const t=new TextEncoder().encode(n),s=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map(a=>String.fromCharCode(a)).join("")}async function Xh(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await Yh(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Lt(n,e,t=!1){const s=Qh();let r=s;t&&(r+="/PASSWORD_RECOVERY"),await qt(n,`${e}-code-verifier`,r);const a=await Xh(s);return[a,s===a?"plain":"s256"]}const ef=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function tf(n){const e=n.headers.get(Mn);if(!e||!e.match(ef))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function sf(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function nf(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const rf=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ut(n){if(!rf.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function bn(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const s=t.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function ba(n){return JSON.parse(JSON.stringify(n))}var af=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};const gt=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),of=[502,503,504];async function wa(n){var e;if(!Kh(n))throw new Fn(gt(n),0);if(of.includes(n.status))throw new Fn(gt(n),n.status);let t;try{t=await n.json()}catch(a){throw new Di(gt(a),a)}let s;const r=tf(n);if(r&&r.getTime()>=$i["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new ma(gt(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new tt}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new ma(gt(t),n.status,t.weak_password.reasons);throw new Ah(gt(t),n.status||500,s)}const lf=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),t))};async function G(n,e,t,s){var r;const a=Object.assign({},s==null?void 0:s.headers);a[Mn]||(a[Mn]=$i["2024-01-01"].name),s!=null&&s.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const i=(r=s==null?void 0:s.query)!==null&&r!==void 0?r:{};s!=null&&s.redirectTo&&(i.redirect_to=s.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",d=await cf(n,e,t+o,{headers:a,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(d):{data:Object.assign({},d),error:null}}async function cf(n,e,t,s,r,a){const i=lf(e,s,r,a);let o;try{o=await n(t,Object.assign({},i))}catch(d){throw console.error(d),new Fn(gt(d),0)}if(o.ok||await wa(o),s!=null&&s.noResolveJson)return o;try{return await o.json()}catch(d){await wa(d)}}function Ze(n){var e;let t=null;ff(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=Wh(n.expires_in)));const s=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:s},error:null}}function xa(n){const e=Ze(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=n.weak_password),e}function at(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function df(n){return{data:n,error:null}}function uf(n){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:a}=n,i=af(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:a},d=Object.assign({},i);return{data:{properties:o,user:d},error:null}}function hf(n){return n}function ff(n){return n.access_token&&n.refresh_token&&n.expires_in}const wn=["global","local","others"];var pf=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};class mf{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=Bi(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=wn[0]){if(wn.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${wn.join(", ")}`);try{return await G(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(q(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await G(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:at})}catch(s){if(q(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=pf(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=s==null?void 0:s.newEmail,delete r.newEmail),await G(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:uf,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(q(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await G(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:at})}catch(t){if(q(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,r,a,i,o,d;try{const c={nextPage:null,lastPage:0,total:0},h=await G(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(a=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:""},xform:hf});if(h.error)throw h.error;const u=await h.json(),f=(i=h.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(d=(o=h.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&d!==void 0?d:[];return p.length>0&&(p.forEach(g=>{const j=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(g.split(";")[1].split("=")[1]);c[`${y}Page`]=j}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},u),c),error:null}}catch(c){if(q(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Ut(e);try{return await G(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:at})}catch(t){if(q(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Ut(e);try{return await G(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:at})}catch(s){if(q(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){Ut(e);try{return await G(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:at})}catch(s){if(q(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Ut(e.userId);try{const{data:t,error:s}=await G(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:s}}catch(t){if(q(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Ut(e.userId),Ut(e.id);try{return{data:await G(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(q(t))return{data:null,error:t};throw t}}}function _a(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function gf(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Bt={debug:!!(globalThis&&Ui()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Mi extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class yf extends Mi{}async function vf(n,e,t){Bt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Bt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async r=>{if(r){Bt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,r.name);try{return await t()}finally{Bt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,r.name)}}else{if(e===0)throw Bt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new yf(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Bt.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}gf();const bf={url:Nh,storageKey:Ch,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ih,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Sa(n,e,t){return await t()}const Mt={};class js{constructor(e){var t,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=js.nextInstanceID,js.nextInstanceID+=1,this.instanceID>0&&Be()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},bf),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new mf({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Bi(r.fetch),this.lock=r.lock||Sa,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Be()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=vf:this.lock=Sa,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:Ui()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=_a(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=_a(this.memoryStorage)),Be()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=Mt[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Mt[this.storageKey]=Object.assign(Object.assign({},Mt[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Mt[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Mt[this.storageKey]=Object.assign(Object.assign({},Mt[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Pi}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Hh(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),Be()&&this.detectSessionInUrl&&s!=="none"){const{data:r,error:a}=await this._getSessionFromURL(t,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),Dh(a)){const d=(e=a.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:o}=r;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return q(t)?{error:t}:{error:new Di("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,r;try{const a=await G(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:Ze}),{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const d=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:c,session:d},error:null}}catch(a){if(q(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,s,r;try{let a;if("email"in e){const{email:h,password:u,options:f}=e;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await Lt(this.storage,this.storageKey)),a=await G(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:h,password:u,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:g},xform:Ze})}else if("phone"in e){const{phone:h,password:u,options:f}=e;a=await G(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:u,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(r=f==null?void 0:f.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Ze})}else throw new Bs("You must provide either an email or phone number and a password");const{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const d=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:c,session:d},error:null}}catch(a){if(q(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:i,options:o}=e;t=await G(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:xa})}else if("phone"in e){const{phone:a,password:i,options:o}=e;t=await G(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:xa})}else throw new Bs("You must provide either an email or phone number and a password");const{data:s,error:r}=t;return r?{data:{user:null,session:null},error:r}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Us}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(t){if(q(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,r,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,r,a,i,o,d,c,h,u,f,p;let g,j;if("message"in e)g=e.message,j=e.signature;else{const{chain:y,wallet:x,statement:$,options:_}=e;let w;if(Be())if(typeof x=="object")w=x;else{const v=window;if("solana"in v&&typeof v.solana=="object"&&("signIn"in v.solana&&typeof v.solana.signIn=="function"||"signMessage"in v.solana&&typeof v.solana.signMessage=="function"))w=v.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=x}const b=new URL((t=_==null?void 0:_.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in w&&w.signIn){const v=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_==null?void 0:_.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),$?{statement:$}:null));let S;if(Array.isArray(v)&&v[0]&&typeof v[0]=="object")S=v[0];else if(v&&typeof v=="object"&&"signedMessage"in v&&"signature"in v)S=v;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)g=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),j=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${b.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...$?["",$,""]:[""],"Version: 1",`URI: ${b.href}`,`Issued At: ${(r=(s=_==null?void 0:_.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((a=_==null?void 0:_.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((i=_==null?void 0:_.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((o=_==null?void 0:_.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((d=_==null?void 0:_.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((c=_==null?void 0:_.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((u=(h=_==null?void 0:_.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||u===void 0)&&u.length?["Resources",..._.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const v=await w.signMessage(new TextEncoder().encode(g),"utf8");if(!v||!(v instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");j=v}}try{const{data:y,error:x}=await G(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:qh(j)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Ze});if(x)throw x;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new Us}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:x})}catch(y){if(q(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(e){const t=await mt(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(t??"").split("/");try{const{data:a,error:i}=await G(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Ze});if(await et(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Us}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:r??null}),error:i})}catch(a){if(q(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:s,token:r,access_token:a,nonce:i}=e,o=await G(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Ze}),{data:d,error:c}=o;return c?{data:{user:null,session:null},error:c}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new Us}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:c})}catch(t){if(q(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,r,a,i;try{if("email"in e){const{email:o,options:d}=e;let c=null,h=null;this.flowType==="pkce"&&([c,h]=await Lt(this.storage,this.storageKey));const{error:u}=await G(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},create_user:(s=d==null?void 0:d.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:c,code_challenge_method:h},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:u}}if("phone"in e){const{phone:o,options:d}=e,{data:c,error:h}=await G(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},create_user:(a=d==null?void 0:d.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(i=d==null?void 0:d.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:h}}throw new Bs("You must provide either an email or phone number.")}catch(o){if(q(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,s;try{let r,a;"options"in e&&(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:i,error:o}=await G(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:r,xform:Ze});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const d=i.session,c=i.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:c,session:d},error:null}}catch(r){if(q(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,s,r;try{let a=null,i=null;return this.flowType==="pkce"&&([a,i]=await Lt(this.storage,this.storageKey)),await G(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:i}),headers:this.headers,xform:df})}catch(a){if(q(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new tt;const{error:r}=await G(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(q(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:a}=e,{error:i}=await G(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:s,type:r,options:a}=e,{data:i,error:o}=await G(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new Bs("You must provide either an email or phone number and a type")}catch(t){if(q(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await mt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<gn:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const i=await mt(this.userStorage,this.storageKey+"-user");i!=null&&i.user?e.user=i.user:e.user=bn()}if(this.storage.isServer&&e.user){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(d,c,h)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,c,h))})}return{data:{session:e},error:null}}const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await G(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:at}):await this._useSession(async t=>{var s,r,a;const{data:i,error:o}=t;if(o)throw o;return!(!((s=i.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new tt}:await G(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0,xform:at})})}catch(t){if(q(t))return $h(t)&&(await this._removeSession(),await et(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:r,error:a}=s;if(a)throw a;if(!r.session)throw new tt;const i=r.session;let o=null,d=null;this.flowType==="pkce"&&e.email!=null&&([o,d]=await Lt(this.storage,this.storageKey));const{data:c,error:h}=await G(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:d}),jwt:i.access_token,xform:at});if(h)throw h;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(s){if(q(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new tt;const t=Date.now()/1e3;let s=t,r=!0,a=null;const{payload:i}=vn(e.access_token);if(i.exp&&(s=i.exp,r=s<=t),r){const{session:o,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:d}=await this._getUser(e.access_token);if(d)throw d;a={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(q(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:i,error:o}=t;if(o)throw o;e=(s=i.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new tt;const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(q(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Be())throw new Ms("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ms(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new pa("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ms("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new pa("No code detected.");const{data:$,error:_}=await this._exchangeCodeForSession(e.code);if(_)throw _;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:$.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:a,refresh_token:i,expires_in:o,expires_at:d,token_type:c}=e;if(!a||!o||!i||!c)throw new Ms("No session defined in URL");const h=Math.round(Date.now()/1e3),u=parseInt(o);let f=h+u;d&&(f=parseInt(d));const p=f-h;p*1e3<=zt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${u}s`);const g=f-u;h-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,f,h):h-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,f,h);const{data:j,error:y}=await this._getUser(a);if(y)throw y;const x={provider_token:s,provider_refresh_token:r,access_token:a,expires_in:u,expires_at:f,refresh_token:i,token_type:c,user:j.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:e.type},error:null}}catch(s){if(q(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await mt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:r,error:a}=t;if(a)return{error:a};const i=(s=r.session)===null||s===void 0?void 0:s.access_token;if(i){const{error:o}=await this.admin.signOut(i,e);if(o&&!(Ph(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await et(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Vh(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,r;try{const{data:{session:a},error:i}=t;if(i)throw i;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let s=null,r=null;this.flowType==="pkce"&&([s,r]=await Lt(this.storage,this.storageKey,!0));try{return await G(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(q(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(q(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:r}=await this._useSession(async a=>{var i,o,d,c,h;const{data:u,error:f}=a;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await G(this.fetch,"GET",p,{headers:this.headers,jwt:(h=(c=u.session)===null||c===void 0?void 0:c.access_token)!==null&&h!==void 0?h:void 0})});if(r)throw r;return Be()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(q(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,r;const{data:a,error:i}=t;if(i)throw i;return await G(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})})}catch(t){if(q(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await Gh(async r=>(r>0&&await Zh(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await G(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ze})),(r,a)=>{const i=200*Math.pow(2,r);return a&&yn(a)&&Date.now()+i-s<zt})}catch(s){if(this._debug(t,"error",s),q(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),Be()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const r=await mt(this.storage,this.storageKey);if(r&&this.userStorage){let i=await mt(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:r.user},await qt(this.userStorage,this.storageKey+"-user",i)),r.user=(e=i==null?void 0:i.user)!==null&&e!==void 0?e:bn()}else if(r&&!r.user&&!r.user){const i=await mt(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(r.user=i.user,await et(this.storage,this.storageKey+"-user"),await qt(this.storage,this.storageKey,r)):r.user=bn()}if(this._debug(s,"session from storage",r),!this._isValidSession(r)){this._debug(s,"session is not valid"),r!==null&&await this._removeSession();return}const a=((t=r.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<gn;if(this._debug(s,`session has${a?"":" not"} expired with margin of ${gn}s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=await this._callRefreshToken(r.refresh_token);i&&(console.error(i),yn(i)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(r.access_token);!o&&(i!=null&&i.user)?(r.user=i.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(s,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(s,"error",r),console.error(r);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new tt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new tn;const{data:a,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!a.session)throw new tt;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={session:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(r,"error",a),q(a)){const i={session:null,error:a};return yn(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(i),i}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(d){a.push(d)}});if(await Promise.all(i),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),s=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&t.user&&await qt(this.userStorage,this.storageKey+"-user",{user:t.user});const r=Object.assign({},t);delete r.user;const a=ba(r);await qt(this.storage,this.storageKey,a)}else{const r=ba(t);await qt(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await et(this.storage,this.storageKey),await et(this.storage,this.storageKey+"-code-verifier"),await et(this.storage,this.storageKey+"-user"),this.userStorage&&await et(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Be()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),zt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/zt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${zt}ms, refresh threshold is ${Bn} ticks`),r<=Bn&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Mi)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Be()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const r=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,i]=await Lt(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});r.push(o.toString())}if(s!=null&&s.queryParams){const a=new URLSearchParams(s.queryParams);r.push(a.toString())}return s!=null&&s.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:r,error:a}=t;return a?{data:null,error:a}:await G(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(q(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,r;const{data:a,error:i}=t;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:d,error:c}=await G(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((r=d==null?void 0:d.totp)===null||r===void 0)&&r.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(t){if(q(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:a}=t;if(a)return{data:null,error:a};const{data:i,error:o}=await G(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(t){if(q(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:a}=t;return a?{data:null,error:a}:await G(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(q(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],r=s.filter(i=>i.factor_type==="totp"&&i.status==="verified"),a=s.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:s,totp:r,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:r},error:a}=e;if(a)return{data:null,error:a};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=vn(r.access_token);let o=null;i.aal&&(o=i.aal);let d=o;((s=(t=r.user.factors)===null||t===void 0?void 0:t.filter(u=>u.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(d="aal2");const h=i.amr||[];return{data:{currentLevel:o,nextLevel:d,currentAuthenticationMethods:h},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(o=>o.kid===e);if(s)return s;const r=Date.now();if(s=this.jwks.keys.find(o=>o.kid===e),s&&this.jwks_cached_at+Oh>r)return s;const{data:a,error:i}=await G(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=r,s=a.keys.find(o=>o.kid===e),!s)?null:s}async getClaims(e,t={}){try{let s=e;if(!s){const{data:p,error:g}=await this.getSession();if(g||!p.session)return{data:null,error:g};s=p.session.access_token}const{header:r,payload:a,signature:i,raw:{header:o,payload:d}}=vn(s);t!=null&&t.allowExpired||sf(a.exp);const c=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!c){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:a,header:r,signature:i},error:null}}const h=nf(r.alg),u=await crypto.subtle.importKey("jwk",c,h,!0,["verify"]);if(!await crypto.subtle.verify(h,u,i,zh(`${o}.${d}`)))throw new zn("Invalid JWT signature");return{data:{claims:a,header:r,signature:i},error:null}}catch(s){if(q(s))return{data:null,error:s};throw s}}}js.nextInstanceID=0;const wf=js;class xf extends wf{constructor(e){super(e)}}var _f=function(n,e,t,s){function r(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(h){try{c(s.next(h))}catch(u){i(u)}}function d(h){try{c(s.throw(h))}catch(u){i(u)}}function c(h){h.done?a(h.value):r(h.value).then(o,d)}c((s=s.apply(n,e||[])).next())})};class Sf{constructor(e,t,s){var r,a,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=Eh(e),d=new URL(o);this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const c=`sb-${d.hostname.split(".")[0]}-auth-token`,h={db:vh,realtime:wh,auth:Object.assign(Object.assign({},bh),{storageKey:c}),global:yh},u=Th(s??{},h);this.storageKey=(r=u.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(a=u.global.headers)!==null&&a!==void 0?a:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=u.auth)!==null&&i!==void 0?i:{},this.headers,u.global.fetch),this.fetch=kh(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new Mu(new URL("rest/v1",d).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new Nu(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new ph(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return _f(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,storageKey:a,flowType:i,lock:o,debug:d},c,h){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new xf({url:this.authUrl.href,headers:Object.assign(Object.assign({},u),c),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,flowType:i,lock:o,debug:d,fetch:h,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new th(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const kf=(n,e,t)=>new Sf(n,e,t),jf="https://wxheqargopbsrruootyr.supabase.co",Ef="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind4aGVxYXJnb3Bic3JydW9vdHlyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI4MTc5MzMsImV4cCI6MjA2ODM5MzkzM30.KWm3ww5Ang42Bswim-O-CHtd6GwBIWZepUy359Bk7Yw",Se=kf(jf,Ef,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),Xt={USER_PROFILES:"user_profiles",USER_SETTINGS:"user_settings",USER_WEBSITES:"user_websites"},Fi=m.createContext(void 0);function sn(){const n=m.useContext(Fi);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n}const ds=n=>{const e=(n==null?void 0:n.message)||(n==null?void 0:n.toString())||"",t={"Invalid login credentials":"","Email not confirmed":"","User already registered":"","Password should be at least 6 characters":"6","Invalid email":"","Network error":"","Too many requests":"","Email already in use":"","Weak password":"","Invalid password":""};for(const[s,r]of Object.entries(t))if(e.includes(s))return r;return e},Tf=()=>navigator.onLine,Nf=n=>{const e=()=>n(!0),t=()=>n(!1);return window.addEventListener("online",e),window.addEventListener("offline",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}};function Cf({children:n}){const[e,t]=m.useState(null),[s,r]=m.useState(null),[a,i]=m.useState(!0),[o,d]=m.useState(Tf()),[c,h]=m.useState(!0),[u,f]=m.useState(null),p=()=>f(null),g=async(b,v)=>{var S;try{p();const{data:I,error:U}=await Se.auth.signInWithPassword({email:b,password:v});if(U)throw U;console.log(":",(S=I.user)==null?void 0:S.email)}catch(I){const U=ds(I);throw f(U),new Error(U)}},j=async(b,v)=>{var S;try{p();const{data:I,error:U}=await Se.auth.signUp({email:b,password:v,options:{emailRedirectTo:`${window.location.origin}/auth/callback`}});if(U)throw U;console.log(":",(S=I.user)==null?void 0:S.email)}catch(I){const U=ds(I);throw f(U),new Error(U)}},y=async()=>{try{if(p(),e&&!e.email_confirmed_at){const{error:b}=await Se.auth.resend({type:"signup",email:e.email});if(b)throw b;console.log("")}}catch(b){const v=ds(b);throw f(v),new Error(v)}},x=async()=>{try{p();const{data:{user:b},error:v}=await Se.auth.getUser();if(v)throw v;t(b)}catch(b){const v=ds(b);throw f(v),new Error(v)}},$=async()=>{try{p();const{error:b}=await Se.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`}});if(b)throw b}catch(b){const v=ds(b);throw f(v),new Error(v)}},_=async()=>{p();const{error:b}=await Se.auth.signOut();b&&console.error(":",b)};m.useEffect(()=>{Se.auth.getSession().then(({data:{session:v}})=>{r(v),t((v==null?void 0:v.user)??null),i(!1)});const{data:{subscription:b}}=Se.auth.onAuthStateChange(async(v,S)=>{var I;switch(console.log("Auth state changed:",v,(I=S==null?void 0:S.user)==null?void 0:I.email),r(S),t((S==null?void 0:S.user)??null),i(!1),v){case"SIGNED_IN":f(null);break;case"SIGNED_OUT":f(null);break;case"TOKEN_REFRESHED":console.log("Token refreshed");break;case"USER_UPDATED":console.log("User updated");break}});return()=>b.unsubscribe()},[]),m.useEffect(()=>{const b=async()=>{var S,I;try{const{error:U}=await Se.from("user_profiles").select("id").limit(1);h(!U),U&&((S=U.message)!=null&&S.includes(""))?f("Supabase"):(I=U==null?void 0:U.message)!=null&&I.includes("Supabase")&&c&&f(null)}catch{h(!1),f("Supabase")}};b();const v=setInterval(b,3e4);return()=>clearInterval(v)},[c]),m.useEffect(()=>Nf(v=>{d(v),f(v?S=>S!=null&&S.includes("")?null:S:"")}),[]);const w={currentUser:e,session:s,login:g,register:j,loginWithGoogle:$,logout:_,sendVerificationEmail:y,reloadUser:x,loading:a,isNetworkOnline:o,isSupabaseConnected:c,error:u};return l.jsx(Fi.Provider,{value:w,children:n})}const zi=async(n,e=3,t=1e3)=>{let s;for(let r=0;r<=e;r++)try{return await n()}catch(a){if(s=a,r===e)throw s;const i=t*Math.pow(2,r);console.log(` ${i}ms (${r+1}/${e+1})`),await new Promise(o=>setTimeout(o,i))}throw s},If=async(n,e,t)=>{var s,r;try{return(s=t==null?void 0:t.onSyncStart)==null||s.call(t),await zi(async()=>{const{error:a}=await Se.from(Xt.USER_SETTINGS).upsert({id:n.id,card_opacity:e.cardOpacity,search_bar_opacity:e.searchBarOpacity,parallax_enabled:e.parallaxEnabled,wallpaper_resolution:e.wallpaperResolution,theme:e.theme,last_sync:new Date().toISOString()});if(a)throw a}),console.log(""),(r=t==null?void 0:t.onSyncSuccess)==null||r.call(t,""),!0}catch(a){return console.error(":",a),!1}},Rf=async n=>{try{const e=new Promise((a,i)=>setTimeout(()=>i(new Error("")),5e3)),t=Se.from(Xt.USER_SETTINGS).select("*").eq("id",n.id).single(),{data:s,error:r}=await Promise.race([t,e]);if(r&&r.code!=="PGRST116")throw r;return s?(console.log(""),{cardOpacity:s.card_opacity,searchBarOpacity:s.search_bar_opacity,parallaxEnabled:s.parallax_enabled,wallpaperResolution:s.wallpaper_resolution,theme:s.theme,lastSync:s.last_sync}):(console.log(""),null)}catch(e){return console.error(":",e),null}},qn=async(n,e,t)=>{var s,r;try{return(s=t==null?void 0:t.onSyncStart)==null||s.call(t),await zi(async()=>{const{error:a}=await Se.from(Xt.USER_WEBSITES).upsert({id:n.id,websites:e,last_sync:new Date().toISOString()});if(a)throw a}),console.log(""),(r=t==null?void 0:t.onSyncSuccess)==null||r.call(t,""),!0}catch(a){return console.error(":",a),!1}},Of=async n=>{try{const e=new Promise((a,i)=>setTimeout(()=>i(new Error("")),5e3)),t=Se.from(Xt.USER_WEBSITES).select("*").eq("id",n.id).single(),{data:s,error:r}=await Promise.race([t,e]);if(r&&r.code!=="PGRST116")throw r;return s?(console.log(""),s.websites):(console.log(""),null)}catch(e){return console.error(":",e),null}},Af=(n,e)=>{const t={};return n.forEach(s=>{t[s.id]={...s}}),e.forEach(s=>{const r=t[s.id];if(!r)t[s.id]={...s};else{const a=new Date(r.lastVisit||"2000-01-01").getTime(),i=new Date(s.lastVisit||"2000-01-01").getTime();let o;i>a?o={...s}:a>i?o={...r}:o=s.visitCount>r.visitCount?{...s}:{...r},o.visitCount=Math.max(r.visitCount||0,s.visitCount||0),o.lastVisit=a>i?r.lastVisit:s.lastVisit,t[s.id]=o}}),Object.values(t)};let xn=null,Ue=0;const us=3,Wn=(n,e,t,s)=>{xn&&clearTimeout(xn),xn=setTimeout(async()=>{var r,a,i,o;(r=s==null?void 0:s.onSyncStart)==null||r.call(s);try{const c=(await Promise.allSettled([qn(n,e),If(n,t)])).filter(h=>h.status==="rejected");c.length===0?(Ue=0,(a=s==null?void 0:s.onSyncSuccess)==null||a.call(s,"")):Ue<us?(Ue++,console.log(` ${Ue}/${us} ...`),setTimeout(()=>{Wn(n,e,t,s)},1e3*Math.pow(2,Ue-1))):(Ue=0,(i=s==null?void 0:s.onSyncError)==null||i.call(s,`${c.length}  ${us} `))}catch(d){Ue<us?(Ue++,console.log(` ${Ue}/${us} ...`),setTimeout(()=>{Wn(n,e,t,s)},1e3*Math.pow(2,Ue-1))):(Ue=0,(o=s==null?void 0:s.onSyncError)==null||o.call(s,": "+d.message))}},5e3)},ka=async(n,e,t)=>{var s,r;try{(s=t==null?void 0:t.onSyncStart)==null||s.call(t);const{error:a}=await Se.from(Xt.USER_PROFILES).upsert({id:n.id,email:n.email||"",display_name:e});if(a)throw a;return console.log(""),(r=t==null?void 0:t.onSyncSuccess)==null||r.call(t,""),!0}catch(a){return console.error(":",a),!1}},_n=async n=>{try{const{data:e,error:t}=await Se.from(Xt.USER_PROFILES).select("*").eq("id",n.id).single();if(t&&t.code!=="PGRST116")throw t;return e?(console.log(""),{id:e.id,email:e.email,displayName:e.display_name,createdAt:e.created_at,updatedAt:e.updated_at}):(console.log(""),null)}catch(e){return console.error(":",e),null}},qi=m.createContext(void 0);function Wi(){const n=m.useContext(qi);if(n===void 0)throw new Error("useUserProfile must be used within a UserProfileProvider");return n}function Pf({children:n}){const{currentUser:e}=sn(),[t,s]=m.useState(null),[r,a]=m.useState(!1),i=(t==null?void 0:t.displayName)||"",o=async c=>{if(!e||!e.email_confirmed_at)return!1;a(!0);try{return await ka(e,c)?(s(u=>u?{...u,displayName:c,updatedAt:new Date().toISOString()}:null),setTimeout(async()=>{const u=await _n(e);u&&s(u)},1e3),!0):!1}catch(h){return console.error(":",h),!1}finally{a(!1)}};m.useEffect(()=>{(async()=>{var h;if(e&&e.email_confirmed_at){a(!0);try{const u=await _n(e);if(u)s(u);else{const f=((h=e.email)==null?void 0:h.split("@")[0])||"";await ka(e,f);const p=await _n(e);s(p)}}catch(u){console.error(":",u)}finally{a(!1)}}else s(null)})()},[e]);const d={userProfile:t,displayName:i,updateDisplayName:o,loading:r};return l.jsx(qi.Provider,{value:d,children:n})}const ja={isOnline:navigator.onLine,lastSyncTime:null,syncInProgress:!1,syncError:null,pendingChanges:0},Vi=m.createContext(void 0);function dr(){const n=m.useContext(Vi);if(n===void 0)throw new Error("useSyncStatus must be used within a SyncProvider");return n}function $f({children:n}){const[e,t]=m.useState(ja),s=i=>{t(o=>({...o,...i}))},r=()=>{t(ja)};m.useEffect(()=>{const i=()=>{s({isOnline:!0,syncError:null}),console.log(" ")},o=()=>{s({isOnline:!1,syncError:"",syncInProgress:!1}),console.log(" ")};return window.addEventListener("online",i),window.addEventListener("offline",o),s({isOnline:navigator.onLine}),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",o)}},[]);const a={syncStatus:e,updateSyncStatus:s,resetSyncStatus:r};return l.jsx(Vi.Provider,{value:a,children:n})}function Df(n){const{currentUser:e}=sn(),{updateSyncStatus:t}=dr(),{cardOpacity:s,searchBarOpacity:r,parallaxEnabled:a,wallpaperResolution:i}=Qt(),o=m.useRef(""),d=m.useRef(null),c=m.useRef(null),h=m.useRef(0),u=m.useCallback((f=!1)=>{if(!navigator.onLine){t({syncInProgress:!1,syncError:"",pendingChanges:1});return}if(!e||!e.email_confirmed_at){e&&!e.email_confirmed_at&&t({syncInProgress:!1,syncError:"",pendingChanges:1});return}if((document.querySelector('[role="dialog"]')||document.querySelector(".modal")||document.querySelector("[data-modal]"))&&!f){console.log(" "),setTimeout(()=>u(!1),5e3);return}const g={cardOpacity:s,searchBarOpacity:r,parallaxEnabled:a,wallpaperResolution:i,theme:localStorage.getItem("theme")||"light",lastSync:new Date().toISOString()};console.log(f?" ...":" ..."),Wn(e,n,g,{onSyncStart:()=>{t({syncInProgress:!0,syncError:null,pendingChanges:0})},onSyncSuccess:j=>{const y=JSON.stringify({websites:n.map(x=>({id:x.id,name:x.name,url:x.url,visitCount:x.visitCount})),settings:{cardOpacity:s,searchBarOpacity:r,parallaxEnabled:a,wallpaperResolution:i,theme:g.theme}});o.current=y,h.current=0,t({syncInProgress:!1,lastSyncTime:new Date,syncError:null,pendingChanges:0}),console.log(" :",j)},onSyncError:j=>{t({syncInProgress:!1,syncError:j,pendingChanges:1}),console.error(" :",j)}})},[e,n,s,r,a,i,t]);m.useEffect(()=>{if(JSON.stringify({websites:n.map(x=>({id:x.id,name:x.name,url:x.url,visitCount:x.visitCount})),settings:{cardOpacity:s,searchBarOpacity:r,parallaxEnabled:a,wallpaperResolution:i,theme:localStorage.getItem("theme")||"light"}})===o.current)return;const p=Date.now();h.current===0&&(h.current=p),d.current&&clearTimeout(d.current);const g=p-h.current,j=45e3,y=5e3;if(g>=j){console.log(" "),c.current&&(clearTimeout(c.current),c.current=null),u(!0);return}if(d.current=setTimeout(()=>{u(!1)},y),!c.current){const x=j-g;console.log(` ${Math.round(x/1e3)}`),c.current=setTimeout(()=>{console.log(" "),d.current&&(clearTimeout(d.current),d.current=null),u(!0)},x)}return()=>{d.current&&clearTimeout(d.current)}},[e,n,s,r,a,i,u]),m.useEffect(()=>()=>{d.current&&clearTimeout(d.current),c.current&&clearTimeout(c.current)},[])}function Lf(){const{syncStatus:n}=dr(),{currentUser:e}=dt(),[,t]=m.useState(0);if(m.useEffect(()=>{const o=()=>{if(!n.lastSyncTime)return 6e4;const u=Math.floor((new Date().getTime()-n.lastSyncTime.getTime())/1e3);return u<60?1e3:u<3600?6e4:3e5},d=()=>{const h=o();return setTimeout(()=>{t(u=>u+1),d()},h)},c=d();return()=>clearTimeout(c)},[n.lastSyncTime]),!e)return null;const s=o=>{if(!o)return"";const c=Math.floor((new Date().getTime()-o.getTime())/1e3);return c<60?`${c}`:c<3600?`${Math.floor(c/60)}`:c<86400?`${Math.floor(c/3600)}`:`${Math.floor(c/86400)}`},r=()=>n.syncInProgress?l.jsx("i",{className:"fa-solid fa-sync fa-spin text-blue-500"}):n.syncError?l.jsx("i",{className:"fa-solid fa-exclamation-triangle text-red-500"}):n.isOnline?n.pendingChanges>0?l.jsx("i",{className:"fa-solid fa-clock text-orange-500"}):l.jsx("i",{className:"fa-solid fa-check-circle text-green-500"}):l.jsx("i",{className:"fa-solid fa-wifi-slash text-gray-500"}),a=()=>n.syncInProgress?"...":n.syncError?"":n.isOnline?n.pendingChanges>0?`${n.pendingChanges} `:"":"",i=()=>n.syncError?n.syncError:`: ${s(n.lastSyncTime)}`;return l.jsx("div",{className:"space-y-2",children:l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[r(),l.jsx("span",{className:"text-sm font-medium text-gray-700",children:a()})]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${n.isOnline?"bg-green-500":"bg-red-500"}`}),l.jsx("span",{className:"text-xs text-gray-500",children:n.isOnline?"":""})]})]}),l.jsx("p",{className:"text-xs text-gray-500",children:i()}),l.jsx(bs,{children:n.syncError&&l.jsx(le.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"bg-red-50 border border-red-200 rounded p-2",children:l.jsxs("p",{className:"text-xs text-red-600",children:[l.jsx("i",{className:"fa-solid fa-info-circle mr-1"}),n.syncError]})})}),l.jsx(bs,{children:n.syncInProgress&&l.jsx(le.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"w-full bg-gray-200 rounded-full h-1",children:l.jsx(le.div,{className:"bg-blue-500 h-1 rounded-full",initial:{width:"0%"},animate:{width:"100%"},transition:{duration:2,ease:"easeInOut"}})})})]})})}function Uf(){const{syncStatus:n}=dr(),{currentUser:e}=dt();if(!e)return null;const t=()=>n.syncInProgress?"...":n.syncError?"":n.pendingChanges>0?"":"",s=()=>n.syncInProgress?"blue":n.syncError?"red":n.pendingChanges>0?"yellow":"green",r=()=>n.syncInProgress?"...":n.pendingChanges>0?"5":"45",a=s();return l.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[l.jsxs("div",{className:`bg-${a}-50 rounded p-2 text-center`,children:[l.jsx("div",{className:`font-medium text-${a}-700`,children:""}),l.jsx("div",{className:`text-${a}-600`,children:e.emailVerified?t():""})]}),l.jsxs("div",{className:"bg-blue-50 rounded p-2 text-center",children:[l.jsx("div",{className:"font-medium text-blue-700",children:""}),l.jsx("div",{className:"text-blue-600",children:r()})]})]})}function Bf({onSuccess:n}){const[e,t]=m.useState(!0),[s,r]=m.useState(""),[a,i]=m.useState(""),[o,d]=m.useState(""),[c,h]=m.useState(!1),[u,f]=m.useState(""),[p,g]=m.useState(!1),[j,y]=m.useState(""),{login:x,register:$,loginWithGoogle:_,sendVerificationEmail:w,error:b,isNetworkOnline:v,isFirebaseConnected:S}=dt(),I=u||b,U=async V=>{if(V.preventDefault(),!s||!a){f("");return}if(!e&&!o.trim()){f("");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)){f("");return}if(!e){if(o.length<2||o.length>20){f("2-20");return}if(!/^[a-zA-Z0-9\u4e00-\u9fa5_-]+$/.test(o)){f("");return}}h(!0),f("");try{e?(await x(s,a),n()):(await $(s,a),g(!0),y(s),localStorage.setItem("pendingDisplayName",o))}catch(ce){console.error(":",ce)}finally{h(!1)}},ne=async()=>{h(!0),f("");try{await _(),n()}catch(V){console.error("Google:",V)}finally{h(!1)}},z=async()=>{try{await w(),alert("")}catch{alert("")}};return p?l.jsx(le.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("i",{className:"fa-solid fa-envelope-circle-check text-green-600 mt-0.5"}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-green-800",children:""}),l.jsxs("p",{className:"text-sm text-green-700 mt-1",children:[" ",l.jsx("strong",{children:j}),"  "]}),l.jsxs("div",{className:"mt-3 flex space-x-2",children:[l.jsx("button",{onClick:z,className:"text-xs bg-green-100 hover:bg-green-200 text-green-800 px-2 py-1 rounded",children:""}),l.jsx("button",{onClick:()=>{g(!1),t(!0),r(""),i(""),d("")},className:"text-xs bg-blue-100 hover:bg-blue-200 text-blue-800 px-2 py-1 rounded",children:""})]})]})]})}):l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"text-center mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:e?"":""}),l.jsx("p",{className:"text-sm text-gray-600",children:e?"":""})]}),I&&l.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:I}),!v&&l.jsxs("div",{className:"mb-4 p-3 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded flex items-center space-x-2",children:[l.jsx("i",{className:"fa-solid fa-wifi-slash"}),l.jsx("span",{children:""})]}),!S&&v&&l.jsxs("div",{className:"mb-4 p-3 bg-blue-100 border border-blue-400 text-blue-700 rounded flex items-center space-x-2",children:[l.jsx("i",{className:"fa-solid fa-cloud-slash"}),l.jsx("span",{children:"Firebase"})]}),l.jsxs("form",{onSubmit:U,className:"space-y-4",children:[!e&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),l.jsx("input",{type:"text",value:o,onChange:V=>d(V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"2-20",disabled:c,maxLength:20}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:""})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),l.jsx("input",{type:"email",value:s,onChange:V=>r(V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"",disabled:c})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),l.jsx("input",{type:"password",value:a,onChange:V=>i(V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"6",disabled:c,minLength:6})]}),l.jsx("button",{type:"submit",disabled:c||!v||!S,className:"w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white py-2 px-4 rounded-md transition-colors",children:c?"...":e?"":""})]}),l.jsxs("div",{className:"mt-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"absolute inset-0 flex items-center",children:l.jsx("div",{className:"w-full border-t border-gray-300"})}),l.jsx("div",{className:"relative flex justify-center text-sm",children:l.jsx("span",{className:"px-2 bg-white text-gray-500",children:""})})]}),l.jsxs("button",{onClick:ne,disabled:c||!v||!S,className:"mt-4 w-full bg-red-500 hover:bg-red-600 disabled:bg-gray-400 text-white py-2 px-4 rounded-md transition-colors flex items-center justify-center",children:[l.jsx("i",{className:"fab fa-google mr-2"})," Google ",e?"":""]})]}),l.jsx("div",{className:"mt-6 text-center",children:l.jsx("button",{onClick:()=>t(!e),className:"text-blue-500 hover:text-blue-600",disabled:c,children:e?"":""})})]})}function Mf(){const{currentUser:n}=dt(),{displayName:e,updateDisplayName:t,loading:s}=Wi(),[r,a]=m.useState(!1),[i,o]=m.useState(e),[d,c]=m.useState(!1),[h,u]=m.useState("");if(m.useEffect(()=>{o(e)},[e]),!n||!n.emailVerified)return null;const f=async()=>{if(!i.trim()){u("");return}if(i.length<2||i.length>20){u("2-20");return}if(!/^[a-zA-Z0-9\u4e00-\u9fa5_-]+$/.test(i)){u("");return}c(!0),u("");try{await t(i)?(a(!1),alert("")):u("")}catch(g){u(""),console.error(":",g)}finally{c(!1)}},p=()=>{o(e),a(!1),u("")};return l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:""}),!r&&l.jsxs("button",{onClick:()=>a(!0),className:"text-xs text-blue-500 hover:text-blue-600",disabled:s,children:[l.jsx("i",{className:"fa-solid fa-edit mr-1"}),""]})]}),r?l.jsxs("div",{className:"space-y-2",children:[l.jsx("input",{type:"text",value:i,onChange:g=>o(g.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"",maxLength:20,disabled:d}),h&&l.jsx("p",{className:"text-xs text-red-600",children:h}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:f,disabled:d||!i.trim(),className:"text-xs bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white px-2 py-1 rounded",children:d?l.jsxs(l.Fragment,{children:[l.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-1"}),"..."]}):l.jsxs(l.Fragment,{children:[l.jsx("i",{className:"fa-solid fa-check mr-1"}),""]})}),l.jsxs("button",{onClick:p,disabled:d,className:"text-xs bg-gray-500 hover:bg-gray-600 text-white px-2 py-1 rounded",children:[l.jsx("i",{className:"fa-solid fa-times mr-1"}),""]})]}),l.jsx("p",{className:"text-xs text-gray-500",children:"2-20"})]}):l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("i",{className:"fa-solid fa-user text-gray-400"}),l.jsx("span",{className:"text-sm font-medium text-gray-800",children:s?"...":e})]}),l.jsx("div",{className:"border-t border-gray-200 pt-2",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("i",{className:"fa-solid fa-envelope text-gray-400"}),l.jsx("span",{className:"text-xs text-gray-600",children:n.email})]}),l.jsx("i",{className:"fa-solid fa-check-circle text-green-500 text-xs",title:""})]})})]})}const bt=class bt{static getInstance(){return bt.instance||(bt.instance=new bt),bt.instance}hasConsent(){try{return localStorage.getItem("cookie-consent")==="accepted"}catch{return!1}}getConsentStatus(){try{const e=localStorage.getItem("cookie-consent");return e==="accepted"?"accepted":e==="declined"?"declined":"pending"}catch{return"pending"}}setItem(e,t,s=!1){try{return s||this.hasConsent()?(localStorage.setItem(e,t),!0):(console.warn(` : ${e} (Cookie)`),!1)}catch(r){return console.error(":",r),!1}}getItem(e,t=!1){try{return t||this.hasConsent()?localStorage.getItem(e):(console.warn(` : ${e} (Cookie)`),null)}catch(s){return console.error(":",s),null}}removeItem(e,t=!1){try{return t||this.hasConsent()?(localStorage.removeItem(e),!0):(console.warn(` : ${e} (Cookie)`),!1)}catch(s){return console.error(":",s),!1}}getAllKeys(e=!0){try{if(!this.hasConsent()&&!e)return[];const t=[],s=["cookie-consent","cookie-consent-date"];for(let r=0;r<localStorage.length;r++){const a=localStorage.key(r);a&&(e||!s.includes(a))&&t.push(a)}return t}catch{return[]}}clearNonEssentialData(){const e=["cookie-consent","cookie-consent-date"];this.getAllKeys(!0).forEach(s=>{if(!e.includes(s))try{localStorage.removeItem(s)}catch(r){console.error(`: ${s}`,r)}}),console.log(" ")}getStorageStats(){const e=this.getAllKeys(!0),t=["cookie-consent","cookie-consent-date"],s=e.filter(a=>!t.includes(a)).length;let r=0;return e.forEach(a=>{try{const i=localStorage.getItem(a)||"";r+=a.length+i.length}catch{}}),{totalKeys:e.length,essentialKeys:t.filter(a=>e.includes(a)).length,nonEssentialKeys:s,consentRequired:!this.hasConsent()&&s>0,storageUsed:`${Math.round(r/1024*100)/100} KB`}}exportData(){if(!this.hasConsent())return console.warn("  (Cookie)"),null;const e={};return this.getAllKeys(!1).forEach(s=>{try{const r=localStorage.getItem(s);r&&(e[s]=JSON.parse(r))}catch{e[s]=localStorage.getItem(s)}}),{exportTime:new Date().toISOString(),consentStatus:this.getConsentStatus(),data:e}}};de(bt,"instance");let Qs=bt;const Ke=Qs.getInstance();function Hi({isOpen:n,onClose:e}){const[t,s]=m.useState(Ke.getStorageStats()),[r,a]=m.useState(Ke.getConsentStatus());m.useEffect(()=>{n&&(s(Ke.getStorageStats()),a(Ke.getConsentStatus()))},[n]);const i=()=>{const c=r==="accepted"?"declined":"accepted";c==="accepted"?(localStorage.setItem("cookie-consent","accepted"),localStorage.setItem("cookie-consent-date",new Date().toISOString())):(localStorage.setItem("cookie-consent","declined"),localStorage.setItem("cookie-consent-date",new Date().toISOString()),Ke.clearNonEssentialData()),a(c),s(Ke.getStorageStats())},o=()=>{confirm(` 


`)&&(Ke.clearNonEssentialData(),s(Ke.getStorageStats()),alert(" "))},d=()=>{const c=Ke.exportData();if(!c){alert(" Cookie");return}const h=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),u=URL.createObjectURL(h),f=document.createElement("a");f.href=u,f.download=`_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(u),alert(" ")};return n?l.jsx(bs,{children:l.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:[l.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),l.jsxs(le.div,{className:"w-full max-w-2xl bg-white rounded-xl shadow-2xl z-50 max-h-[90vh] flex flex-col mx-4",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",damping:20,stiffness:300},children:[l.jsx("div",{className:"p-6 pb-0",children:l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("i",{className:"fa-solid fa-shield-halved text-blue-600 text-2xl"}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:""})]}),l.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 text-xl",children:l.jsx("i",{className:"fa-solid fa-xmark"})})]})}),l.jsxs("div",{className:"flex-1 px-6 py-4 space-y-6 overflow-y-auto",children:[l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[l.jsx("i",{className:"fa-solid fa-cookie-bite text-amber-500"}),"Cookie"]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("p",{className:"text-sm text-gray-600",children:[":",l.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs font-medium ${r==="accepted"?"bg-green-100 text-green-800":r==="declined"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:r==="accepted"?" ":r==="declined"?" ":" "})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:r==="accepted"?"Cookie":r==="declined"?"Cookie":""})]}),r!=="pending"&&l.jsx("button",{onClick:i,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${r==="accepted"?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:r==="accepted"?"":""})]})]}),l.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[l.jsx("i",{className:"fa-solid fa-chart-pie text-blue-600"}),""]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.totalKeys}),l.jsx("div",{className:"text-xs text-gray-600",children:""})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.essentialKeys}),l.jsx("div",{className:"text-xs text-gray-600",children:""})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t.nonEssentialKeys}),l.jsx("div",{className:"text-xs text-gray-600",children:""})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-orange-600",children:t.storageUsed}),l.jsx("div",{className:"text-xs text-gray-600",children:""})]})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[l.jsx("i",{className:"fa-solid fa-info-circle text-blue-600"}),""]}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[l.jsx("i",{className:"fa-solid fa-shield-check text-green-600 mt-0.5"}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium text-green-800",children:""}),l.jsx("div",{className:"text-green-700",children:"Cookie - "})]})]}),l.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg",children:[l.jsx("i",{className:"fa-solid fa-bookmark text-blue-600 mt-0.5"}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium text-blue-800",children:""}),l.jsx("div",{className:"text-blue-700",children:""})]})]}),l.jsxs("div",{className:"flex items-start gap-3 p-3 bg-purple-50 rounded-lg",children:[l.jsx("i",{className:"fa-solid fa-palette text-purple-600 mt-0.5"}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium text-purple-800",children:""}),l.jsx("div",{className:"text-purple-700",children:""})]})]}),l.jsxs("div",{className:"flex items-start gap-3 p-3 bg-orange-50 rounded-lg",children:[l.jsx("i",{className:"fa-solid fa-chart-line text-orange-600 mt-0.5"}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium text-orange-800",children:""}),l.jsx("div",{className:"text-orange-700",children:""})]})]})]})]}),l.jsxs("div",{className:"border-t pt-4",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[l.jsx("i",{className:"fa-solid fa-wrench text-gray-600"}),""]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("button",{onClick:d,disabled:r!=="accepted",className:"w-full p-3 bg-blue-100 hover:bg-blue-200 disabled:bg-gray-100 disabled:text-gray-400 text-blue-800 rounded-lg transition-colors text-left",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("i",{className:"fa-solid fa-download"}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium",children:""}),l.jsx("div",{className:"text-sm opacity-75",children:"JSON"})]})]})}),l.jsx("button",{onClick:o,className:"w-full p-3 bg-red-100 hover:bg-red-200 text-red-800 rounded-lg transition-colors text-left",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("i",{className:"fa-solid fa-trash"}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium",children:""}),l.jsx("div",{className:"text-sm opacity-75",children:""})]})]})})]}),l.jsxs("div",{className:"mt-6",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[l.jsx("i",{className:"fa-solid fa-book-open text-blue-500"}),""]}),l.jsx("p",{className:"text-sm text-gray-600 mb-3",children:""}),l.jsxs("a",{href:"/tutorial.html",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium shadow transition-colors",children:[l.jsx("i",{className:"fa-solid fa-graduation-cap"}),""]})]})]})]}),l.jsx("div",{className:"p-6 pt-0 border-t",children:l.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500",children:[l.jsxs("span",{children:[": ",new Date().toLocaleDateString("zh-CN")]}),l.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg",children:""})]})})]})]})}):null}function Ff({isOpen:n,onClose:e,onConfirm:t,title:s,message:r,confirmText:a="",cancelText:i="",type:o="warning"}){const c=(()=>{switch(o){case"danger":return{icon:"fa-solid fa-triangle-exclamation text-red-500",confirmButton:"bg-red-500 hover:bg-red-600 text-white",borderColor:"border-red-200"};case"warning":return{icon:"fa-solid fa-exclamation-triangle text-orange-500",confirmButton:"bg-orange-500 hover:bg-orange-600 text-white",borderColor:"border-orange-200"};case"info":return{icon:"fa-solid fa-info-circle text-blue-500",confirmButton:"bg-blue-500 hover:bg-blue-600 text-white",borderColor:"border-blue-200"}}})(),h=()=>{t(),e()};return l.jsx(bs,{children:n&&l.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center",children:[l.jsx(le.div,{className:"absolute inset-0 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),l.jsx(le.div,{className:`relative bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 border-2 ${c.borderColor}`,initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",damping:20,stiffness:300},children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("i",{className:`${c.icon} text-2xl`})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:s}),l.jsx("div",{className:"text-sm text-gray-600 whitespace-pre-line",children:r})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:i}),l.jsx("button",{onClick:h,className:`px-4 py-2 rounded-lg transition-colors ${c.confirmButton}`,children:a})]})]})})]})})}function Ea({label:n,selectedColor:e,onChange:t}){return l.jsxs("div",{className:"space-y-3 select-none",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 select-none",children:n}),l.jsx("div",{className:"flex gap-2 flex-wrap",children:fu.map(s=>l.jsx(le.button,{type:"button",onClick:()=>t(s.rgb),className:`w-8 h-8 rounded-lg border-2 transition-all duration-200 hover:scale-110 ${e===s.rgb?"border-blue-500 shadow-lg":"border-gray-300 hover:border-gray-400"}`,style:{backgroundColor:s.preview},title:s.name,whileHover:{scale:1.1},whileTap:{scale:.95},children:e===s.rgb&&l.jsx(le.div,{className:"w-full h-full flex items-center justify-center",initial:{scale:0},animate:{scale:1},transition:{duration:.2},children:l.jsx("i",{className:`fa-solid fa-check text-sm ${s.name===""||s.name===""?"text-gray-700":"text-white"}`})})},s.name))})]})}const zf=[{id:"1",name:"GitHub",url:"https://github.com",favicon:"https://github.githubassets.com/favicons/favicon.png",tags:["",""],visitCount:42,lastVisit:"2023-05-15",note:""},{id:"2",name:"Dribbble",url:"https://dribbble.com",favicon:"https://cdn.dribbble.com/assets/favicon-b38525134603b9513174e916967b4baaaaaa5ee0297c4f53d6fb3ab8ad26c3a4.ico",tags:["",""],visitCount:28,lastVisit:"2023-05-10",note:""},{id:"3",name:"Medium",url:"https://medium.com",favicon:"https://miro.medium.com/v2/resize:fill:32:32/1*sHhtYhaCe2Uc3IU0IgKwIQ.png",tags:["",""],visitCount:15,lastVisit:"2023-05-05",note:""}];function Ki(n={}){const{enableAutoSync:e=!0,syncDelay:t=100}=n,s=Qs.getInstance(),[r,a]=m.useState(!0),[i,o]=m.useState(null),[d,c]=m.useState(!0),h=m.useCallback(()=>{try{const w=s.getItem("websites");if(w){const b=JSON.parse(w);if(Array.isArray(b)&&b.length>0){const v=b.filter(S=>S.id&&S.name&&S.url);if(v.length>0)return v}}}catch(w){console.warn(":",w),o("")}return zf},[s]),[u,f]=m.useState(()=>{const w=h();return a(!1),w}),p=m.useCallback(w=>{try{s.setItem("websites",JSON.stringify(w))||console.warn("Cookie")}catch(b){console.error(":",b),o("")}},[s]);m.useEffect(()=>{if(!e||!d)return;const w=setTimeout(()=>{const b=h();(b.length!==u.length||JSON.stringify(b.map(v=>v.id).sort())!==JSON.stringify(u.map(v=>v.id).sort()))&&(console.log(" "),f(b)),c(!1)},t);return()=>clearTimeout(w)},[e,t,d,h,u]),m.useEffect(()=>{!d&&e&&p(u)},[u,p,e,d]);const g=m.useCallback(w=>{o(null),f(w)},[]),j=m.useCallback(w=>{const b={...w,visitCount:0,lastVisit:new Date().toISOString().split("T")[0]};g(v=>[...v,b])},[g]),y=m.useCallback((w,b)=>{g(v=>v.map(S=>S.id===w?{...S,...b}:S))},[g]),x=m.useCallback(w=>{g(b=>b.filter(v=>v.id!==w))},[g]),$=m.useCallback(async()=>{try{const w={websites:u,settings:{cardOpacity:parseFloat(localStorage.getItem("cardOpacity")||"0.1"),searchBarOpacity:parseFloat(localStorage.getItem("searchBarOpacity")||"0.1"),parallaxEnabled:JSON.parse(localStorage.getItem("parallaxEnabled")||"true"),wallpaperResolution:localStorage.getItem("wallpaperResolution")||"1080p",theme:localStorage.getItem("theme")||"light"},exportTime:new Date().toISOString(),version:"1.0"};return JSON.stringify(w,null,2)}catch(w){throw new Error(`: ${w instanceof Error?w.message:""}`)}},[u]),_=m.useCallback(async w=>{try{if(!w.websites||!Array.isArray(w.websites))return{success:!1,message:""};const b=w.websites.filter(v=>v.id&&v.name&&v.url&&typeof v.id=="string"&&typeof v.name=="string"&&typeof v.url=="string").map(v=>({...v,visitCount:typeof v.visitCount=="number"?v.visitCount:0,lastVisit:v.lastVisit||new Date().toISOString().split("T")[0],tags:Array.isArray(v.tags)?v.tags:[],note:v.note||""}));return b.length===0?{success:!1,message:""}:(g(b),{success:!0,message:` ${b.length} `,validCount:b.length})}catch(b){return{success:!1,message:`: ${b instanceof Error?b.message:""}`}}},[g]);return{websites:u,setWebsites:g,addWebsite:j,updateWebsite:y,deleteWebsite:x,exportData:$,importData:_,isLoading:r,error:i}}function qf(){const n=m.useCallback(()=>{try{return{cardOpacity:parseFloat(localStorage.getItem("cardOpacity")||"0.1"),searchBarOpacity:parseFloat(localStorage.getItem("searchBarOpacity")||"0.1"),parallaxEnabled:JSON.parse(localStorage.getItem("parallaxEnabled")||"true"),wallpaperResolution:localStorage.getItem("wallpaperResolution")||"1080p",theme:localStorage.getItem("theme")||"light"}}catch(s){return console.warn(":",s),{cardOpacity:.1,searchBarOpacity:.1,parallaxEnabled:!0,wallpaperResolution:"1080p",theme:"light"}}},[]),e=m.useCallback(s=>{const r=[];return s.cardOpacity!==void 0&&(typeof s.cardOpacity!="number"||s.cardOpacity<.05||s.cardOpacity>.3)&&r.push("0.05-0.3"),s.searchBarOpacity!==void 0&&(typeof s.searchBarOpacity!="number"||s.searchBarOpacity<.05||s.searchBarOpacity>.3)&&r.push("0.05-0.3"),s.parallaxEnabled!==void 0&&typeof s.parallaxEnabled!="boolean"&&r.push("truefalse"),s.wallpaperResolution!==void 0&&(["4k","1080p","720p","mobile"].includes(s.wallpaperResolution)||r.push("")),s.theme!==void 0&&(["light","dark"].includes(s.theme)||r.push("lightdark")),{valid:r.length===0,errors:r}},[]),t=m.useCallback(s=>{const r=e(s),a=[];if(!r.valid)return console.warn(":",r.errors),{success:!1,appliedSettings:[]};try{return typeof s.cardOpacity=="number"&&(localStorage.setItem("cardOpacity",s.cardOpacity.toString()),a.push("")),typeof s.searchBarOpacity=="number"&&(localStorage.setItem("searchBarOpacity",s.searchBarOpacity.toString()),a.push("")),typeof s.parallaxEnabled=="boolean"&&(localStorage.setItem("parallaxEnabled",JSON.stringify(s.parallaxEnabled)),a.push("")),s.wallpaperResolution&&["4k","1080p","720p","mobile"].includes(s.wallpaperResolution)&&(localStorage.setItem("wallpaperResolution",s.wallpaperResolution),a.push("")),s.theme&&["light","dark"].includes(s.theme)&&(localStorage.setItem("theme",s.theme),a.push("")),{success:!0,appliedSettings:a}}catch(i){return console.error(":",i),{success:!1,appliedSettings:[]}}},[e]);return{exportSettings:n,importSettings:t,validateSettings:e}}function Wf(n,e){const[t,s]=m.useState(!1),[r,a]=m.useState(!1),[i,o]=m.useState(null),{importData:d}=Ki({enableAutoSync:!1}),{exportSettings:c,importSettings:h}=qf(),u=m.useCallback(async(p={})=>{const{includeSettings:g=!0,includeWebsites:j=!0}=p;if(!t){s(!0),o(null);try{if(j&&(!n||n.length===0)&&!confirm(""))return;const y={exportTime:new Date().toISOString(),version:"1.0"};j&&(y.websites=n||[]),g&&(y.settings=c());const x=JSON.stringify(y,null,2);if(new Blob([x]).size/1024/1024>50)throw new Error("50MB");const _=new Blob([x],{type:"application/json"}),w=`__${new Date().toISOString().split("T")[0]}.json`;if("showSaveFilePicker"in window)try{const I=await(await window.showSaveFilePicker({suggestedName:w,types:[{description:"JSON",accept:{"application/json":[".json"]}}]})).createWritable();await I.write(_),await I.close(),alert(`${j?` ${n.length} `:""}${g?"":""}`);return}catch(S){if(S.name==="AbortError")return;console.warn("API:",S)}const b=URL.createObjectURL(_),v=document.createElement("a");v.href=b,v.download=w,v.style.display="none",document.body.appendChild(v),v.click(),document.body.removeChild(v),setTimeout(()=>URL.revokeObjectURL(b),1e3),alert(`${j?` ${n.length} `:""}${g?"":""}`)}catch(y){const x=y instanceof Error?y.message:"";o(`: ${x}`),alert(`${x}`)}finally{s(!1)}}},[t,n,c]),f=m.useCallback(async p=>r?{success:!1,message:""}:(a(!0),o(null),new Promise(g=>{const j=new FileReader;j.onload=async y=>{var x;try{const $=(x=y.target)==null?void 0:x.result,_=JSON.parse($);let w=0,b=[];if(_.websites){const S=await d(_);S.success&&(e(_.websites.filter(I=>I.id&&I.name&&I.url)),w=S.validCount||0)}if(_.settings){const S=h(_.settings);S.success&&(b=S.appliedSettings)}if(w+b.length===0){g({success:!1,message:""});return}g({success:!0,message:"",details:{websitesImported:w,settingsApplied:b}})}catch($){const _=$ instanceof Error?$.message:"";o(`: ${_}`),g({success:!1,message:`: ${_}`})}finally{a(!1)}},j.onerror=()=>{o(""),a(!1),g({success:!1,message:""})},j.readAsText(p)})),[r,d,h,e]);return{exportAllData:u,importAllData:f,isExporting:t,isImporting:r,error:i}}function Vf({onClose:n,websites:e,setWebsites:t}){const[s,r]=m.useState(!1),[a,i]=m.useState(!1),[o,d]=m.useState(!1),[c,h]=m.useState(null),{exportAllData:u,importAllData:f,isExporting:p,isImporting:g}=Wf(e,t),{cardOpacity:j,searchBarOpacity:y,parallaxEnabled:x,wallpaperResolution:$,cardColor:_,searchBarColor:w,setCardOpacity:b,setSearchBarOpacity:v,setParallaxEnabled:S,setWallpaperResolution:I,setIsSettingsOpen:U,setCardColor:ne,setSearchBarColor:z}=Qt(),{currentUser:V,logout:re}=dt(),ce=m.useRef(null);m.useEffect(()=>(U(!0),()=>U(!1)),[U]);const ae=()=>{U(!1),n()},O=L=>{const A={...L,visitCount:0,lastVisit:new Date().toISOString().split("T")[0]};t([...e,A]),r(!1)},K=async()=>{await u()},Q=L=>{var H;const A=(H=L.target.files)==null?void 0:H[0];if(!A)return;const B=5*1024*1024;if(A.size>B){alert("5MB"),ce.current&&(ce.current.value="");return}if(!A.type.includes("json")&&!A.name.endsWith(".json")){alert("JSON"),ce.current&&(ce.current.value="");return}h(A),d(!0),ce.current&&(ce.current.value="")},Y=async()=>{if(!c||g)return;const L=await f(c);if(L.success){const A=L.details;let B="";A!=null&&A.websitesImported&&(B+=` ${A.websitesImported} `),A!=null&&A.settingsApplied&&A.settingsApplied.length>0&&(B+=`${A.settingsApplied.join("")}`),B+="",alert(B),window.location.reload()}else alert(L.message);h(null)};return l.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center select-none",children:[l.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:ae}),l.jsxs(le.div,{className:"w-96 bg-white rounded-xl shadow-2xl z-50 max-h-[80vh] flex flex-col select-none",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",damping:20,stiffness:300},children:[l.jsx("div",{className:"p-6 pb-0 select-none",children:l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-xl font-medium text-gray-800 select-none",children:""}),l.jsx("button",{onClick:ae,className:"text-gray-500 hover:text-gray-700 select-none",children:l.jsx("i",{className:"fa-solid fa-xmark text-lg select-none"})})]})}),l.jsxs("div",{className:"flex-1 px-6 py-2 pb-6 space-y-6 overflow-y-auto select-none",children:[l.jsxs("div",{className:"space-y-4 select-none",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider select-none",children:""}),V?l.jsxs("div",{className:"bg-gray-100 rounded-lg p-4 space-y-4",children:[l.jsx(Mf,{}),l.jsx("div",{className:"flex justify-center pt-1",children:l.jsxs("button",{onClick:async()=>{try{await re(),ae()}catch(L){console.error(":",L)}},className:"text-red-500 hover:text-red-600 transition-colors flex items-center text-sm select-none",children:[l.jsx("i",{className:"fa-solid fa-sign-out-alt mr-1.5 text-xs select-none"}),""]})})]}):l.jsx("div",{className:"bg-gray-100 rounded-lg p-4",children:l.jsx(Bf,{onSuccess:ae})})]}),l.jsxs("div",{className:"space-y-4 select-none",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider select-none",children:""}),l.jsx("div",{className:"bg-gray-100 rounded-lg p-4",children:l.jsx(Lf,{})})]}),l.jsx("div",{className:"select-none -mt-4",children:l.jsx(Uf,{})}),l.jsxs("div",{className:"space-y-4 select-none",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider select-none",children:""}),l.jsxs("div",{className:"space-y-2 select-none",children:[l.jsxs("label",{className:"text-sm font-medium text-gray-700 select-none",children:[" (",Math.round(y*100),"%)"]}),l.jsx("input",{type:"range",min:"0.05",max:"0.5",step:"0.01",value:y,onChange:L=>v(parseFloat(L.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"})]}),l.jsx(Ea,{label:"",selectedColor:w,onChange:z}),l.jsxs("div",{className:"space-y-2 select-none",children:[l.jsxs("label",{className:"text-sm font-medium text-gray-700 select-none",children:[" (",Math.round(j*100),"%)"]}),l.jsx("input",{type:"range",min:"0.05",max:"0.5",step:"0.01",value:j,onChange:L=>b(parseFloat(L.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"})]}),l.jsx(Ea,{label:"",selectedColor:_,onChange:ne}),l.jsxs("div",{className:"space-y-2 select-none",children:[l.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center justify-between select-none",children:[l.jsx("span",{className:"select-none",children:""}),l.jsx("button",{onClick:()=>S(!x),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors select-none ${x?"bg-blue-500":"bg-gray-300"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform select-none ${x?"translate-x-6":"translate-x-1"}`})})]}),l.jsx("p",{className:"text-xs text-gray-500 select-none",children:x?"":""})]}),l.jsxs("div",{className:"space-y-2 select-none",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 select-none",children:""}),l.jsx("div",{className:"grid grid-cols-2 gap-2 select-none",children:[{value:"4k",label:"4K ",desc:""},{value:"1080p",label:"1080p ",desc:""},{value:"720p",label:"720p ",desc:""},{value:"mobile",label:"",desc:""}].map(L=>l.jsxs("button",{onClick:()=>I(L.value),className:`p-3 rounded-lg border-2 transition-all text-left select-none cursor-pointer ${$===L.value?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"}`,children:[l.jsx("div",{className:"font-medium text-sm",children:L.label}),l.jsx("div",{className:"text-xs text-gray-500",children:L.desc})]},L.value))}),l.jsx("p",{className:"text-xs text-gray-500 select-none",children:""})]})]}),l.jsxs("div",{className:"space-y-4 select-none",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider select-none",children:""}),l.jsxs("button",{onClick:()=>r(!0),className:"w-full px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-md transition-colors select-none",children:[l.jsx("i",{className:"fa-solid fa-plus mr-2 select-none"}),""]})]}),l.jsxs("div",{className:"space-y-4 select-none",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider select-none",children:""}),l.jsxs("div",{className:"grid grid-cols-2 gap-3 select-none",children:[l.jsx("button",{onClick:K,disabled:p,className:`px-3 py-2 rounded-md transition-colors text-sm select-none ${p?"bg-gray-400 cursor-not-allowed text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:p?l.jsxs(l.Fragment,{children:[l.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-1 select-none"}),""]}):l.jsxs(l.Fragment,{children:[l.jsx("i",{className:"fa-solid fa-download mr-1 select-none"}),""]})}),l.jsx("button",{onClick:()=>{var L;return(L=ce.current)==null?void 0:L.click()},disabled:g,className:`px-3 py-2 rounded-md transition-colors text-sm select-none ${g?"bg-gray-400 cursor-not-allowed text-white":"bg-orange-500 hover:bg-orange-600 text-white"}`,children:g?l.jsxs(l.Fragment,{children:[l.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-1 select-none"}),""]}):l.jsxs(l.Fragment,{children:[l.jsx("i",{className:"fa-solid fa-upload mr-1 select-none"}),""]})})]}),l.jsx("input",{ref:ce,type:"file",accept:".json",onChange:Q,className:"hidden"}),l.jsx("p",{className:"text-xs text-gray-500 select-none",children:" "})]}),l.jsxs("div",{className:"space-y-4 select-none",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider select-none",children:"Cookie"}),l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsxs("button",{onClick:()=>i(!0),className:"w-full px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-md transition-colors select-none",children:[l.jsx("i",{className:"fa-solid fa-shield-halved mr-2 select-none"}),""]}),l.jsxs("a",{href:"/tutorial.html",target:"_blank",rel:"noopener noreferrer",className:"w-full px-4 py-2 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-md transition-colors flex items-center justify-center gap-2 font-medium select-none border border-blue-200",style:{textDecoration:"none"},children:[l.jsx("i",{className:"fa-solid fa-graduation-cap"}),""]})]})]})]})]}),s&&l.jsx(bi,{id:`new-${Date.now()}`,name:"",url:"",favicon:"",tags:[],note:"",onClose:()=>r(!1),onSave:O}),a&&l.jsx(Hi,{isOpen:a,onClose:()=>i(!1)}),l.jsx(Ff,{isOpen:o,onClose:()=>{d(!1),h(null)},onConfirm:Y,title:"",message:` 

 
 
 

`,confirmText:"",cancelText:"",type:"warning"})]})}function Hf(){const{currentUser:n,sendVerificationEmail:e,reloadUser:t,logout:s}=dt(),[r,a]=m.useState(!1),[i,o]=m.useState(!1);if(!n||n.emailVerified)return null;const d=async()=>{a(!0);try{await e(),alert(" ")}catch(u){alert(" "),console.error(":",u)}finally{a(!1)}},c=async()=>{o(!0);try{await t(),window.location.reload()}catch(u){console.error(":",u)}finally{o(!1)}},h=async()=>{confirm("")&&await s()};return l.jsx(le.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},className:"fixed top-0 left-0 right-0 z-50 bg-orange-500 text-white shadow-lg",children:l.jsx("div",{className:"container mx-auto px-4 py-3",children:l.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("i",{className:"fa-solid fa-envelope-open-text text-xl"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:""}),l.jsxs("p",{className:"text-sm text-orange-100",children:[" ",l.jsx("strong",{children:n.email})," "]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{onClick:d,disabled:r,className:"bg-orange-600 hover:bg-orange-700 disabled:bg-orange-400 px-3 py-1 rounded text-sm transition-colors",children:r?l.jsxs(l.Fragment,{children:[l.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-1"}),"..."]}):l.jsxs(l.Fragment,{children:[l.jsx("i",{className:"fa-solid fa-paper-plane mr-1"}),""]})}),l.jsx("button",{onClick:c,disabled:i,className:"bg-green-500 hover:bg-green-600 disabled:bg-green-400 px-3 py-1 rounded text-sm transition-colors",children:i?l.jsxs(l.Fragment,{children:[l.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-1"}),"..."]}):l.jsxs(l.Fragment,{children:[l.jsx("i",{className:"fa-solid fa-check-circle mr-1"}),""]})}),l.jsxs("button",{onClick:h,className:"bg-red-500 hover:bg-red-600 px-3 py-1 rounded text-sm transition-colors",children:[l.jsx("i",{className:"fa-solid fa-sign-out-alt mr-1"}),""]})]})]})})})}const wt=class wt{constructor(){de(this,"db",null);de(this,"dbName","WallpaperCache");de(this,"version",1);de(this,"storeName","images")}static getInstance(){return wt.instance||(wt.instance=new wt),wt.instance}async init(){return new Promise((e,t)=>{const s=indexedDB.open(this.dbName,this.version);s.onerror=()=>{console.error("IndexedDB :",s.error),t(s.error)},s.onsuccess=()=>{this.db=s.result,console.log(" IndexedDB "),e()},s.onupgradeneeded=r=>{const a=r.target.result;a.objectStoreNames.contains(this.storeName)||(a.createObjectStore(this.storeName,{keyPath:"key"}).createIndex("timestamp","timestamp",{unique:!1}),console.log("  IndexedDB "))}})}async ensureDB(){return this.db||await this.init(),this.db}async set(e,t,s=2*60*60*1e3){try{const i=(await this.ensureDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName),o={key:e,blob:t,timestamp:Date.now(),ttl:s,size:t.size,type:t.type},d=i.put(o);return new Promise((c,h)=>{d.onsuccess=()=>{console.log(` IndexedDB : ${e} (${(t.size/1024/1024).toFixed(2)}MB)`),c()},d.onerror=()=>{console.error("IndexedDB :",d.error),h(d.error)}})}catch(r){throw console.error("IndexedDB :",r),r}}async get(e){try{const a=(await this.ensureDB()).transaction([this.storeName],"readonly").objectStore(this.storeName).get(e);return new Promise((i,o)=>{a.onsuccess=()=>{const d=a.result;if(!d){i(null);return}if(Date.now()-d.timestamp>d.ttl){console.log(` IndexedDB : ${e}`),this.delete(e),i(null);return}console.log(` IndexedDB : ${e} (${(d.size/1024/1024).toFixed(2)}MB)`),i(d.blob)},a.onerror=()=>{console.error("IndexedDB :",a.error),o(a.error)}})}catch(t){return console.error("IndexedDB :",t),null}}async has(e){try{const a=(await this.ensureDB()).transaction([this.storeName],"readonly").objectStore(this.storeName).get(e);return new Promise(i=>{a.onsuccess=()=>{const o=a.result;if(!o){i(!1);return}if(Date.now()-o.timestamp>o.ttl){this.delete(e),i(!1);return}i(!0)},a.onerror=()=>{i(!1)}})}catch{return!1}}async delete(e){try{const a=(await this.ensureDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(e);return new Promise((i,o)=>{a.onsuccess=()=>{console.log(` IndexedDB : ${e}`),i()},a.onerror=()=>{console.error("IndexedDB :",a.error),o(a.error)}})}catch(t){console.error("IndexedDB :",t)}}async cleanup(){try{const r=(await this.ensureDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName).openCursor();let a=0;const i=Date.now();return new Promise((o,d)=>{r.onsuccess=c=>{const h=c.target.result;if(h){const u=h.value;i-u.timestamp>u.ttl&&(h.delete(),a++),h.continue()}else console.log(` IndexedDB  ${a} `),o()},r.onerror=()=>{console.error("IndexedDB :",r.error),d(r.error)}})}catch(e){console.error("IndexedDB :",e)}}async getStats(){try{const r=(await this.ensureDB()).transaction([this.storeName],"readonly").objectStore(this.storeName).openCursor();let a=0,i=0;return new Promise((o,d)=>{r.onsuccess=c=>{const h=c.target.result;if(h){const u=h.value;a++,i+=u.size||0,h.continue()}else o({count:a,totalSize:i})},r.onerror=()=>{console.error("IndexedDB :",r.error),d(r.error)}})}catch(e){return console.error("IndexedDB :",e),{count:0,totalSize:0}}}};de(wt,"instance");let Vn=wt;const hs=Vn.getInstance(),xt=class xt{constructor(){de(this,"cache",new Map)}static getInstance(){return xt.instance||(xt.instance=new xt),xt.instance}set(e,t,s=5*60*1e3){this.cache.set(e,{data:t,timestamp:Date.now(),ttl:s})}get(e){const t=this.cache.get(e);return t?Date.now()-t.timestamp>t.ttl?(this.cache.delete(e),null):t.data:null}cleanup(){const e=Date.now();for(const[t,s]of this.cache.entries())e-s.timestamp>s.ttl&&this.cache.delete(t)}clear(){this.cache.clear()}size(){return this.cache.size}};de(xt,"instance");let Hn=xt;const Zi=Hn.getInstance();setInterval(()=>{Zi.cleanup()},6e4);const Sn={async cacheWallpaperBlob(n,e){try{console.log(" Blob:",{url:n,cacheKey:e});const t=`wallpaper-blob:${e}`,s=await hs.get(t);if(s)return console.log(" IndexedDB:",t),URL.createObjectURL(s);console.log(" ...");const r=`https://corsproxy.io/?${encodeURIComponent(n)}`;console.log(" CORS:",r);const a=await fetch(r,{mode:"cors",headers:{Accept:"image/*"}});if(!a.ok)throw new Error(`: ${a.status} ${a.statusText}`);console.log(" Blob...");const i=await a.blob(),o=URL.createObjectURL(i);return console.log(" BlobIndexedDB:",{cacheKey:t,blobUrl:o,size:`${(i.size/1024/1024).toFixed(2)}MB`}),await hs.set(t,i,2*60*60*1e3),Zi.set(`wallpaper-source:${e}`,n,2*60*60*1e3),console.log(" IndexedDB:  "),o}catch(t){return console.error(" Blob:",t),console.error(" :",{url:n,cacheKey:e,error:t instanceof Error?t.message:String(t)}),console.log(" CORSBlob"),n}},async preloadTodayWallpapers(){const n=new Date().toDateString(),e=[{url:"https://bing.img.run/uhd.php",key:`bing-${n}`},{url:"https://bing.img.run/1920x1080.php",key:`bing-hd-${n}`},{url:"https://source.unsplash.com/1920x1080/?nature",key:`unsplash-${n}`}],t=await Promise.allSettled(e.map(({url:s,key:r})=>this.cacheWallpaperBlob(s,r)));console.log(" :",t.filter(s=>s.status==="fulfilled").length,"/",t.length)},async getCachedWallpaper(n){const e=`wallpaper-blob:${n}`;try{const t=await hs.get(e);if(t)return console.log(" IndexedDB:",e),URL.createObjectURL(t)}catch(t){console.warn("IndexedDB:",t)}return null},async hasCachedWallpaper(n){const e=`wallpaper-blob:${n}`;return await hs.has(e)},async cleanupWallpaperCache(){try{await hs.cleanup(),console.log(" ")}catch(n){console.error(":",n)}}};function Kf(n,e=[]){const t=m.useRef(null),s=m.useRef(),r=m.useCallback((...i)=>{s.current=i,t.current===null&&(t.current=requestAnimationFrame(()=>{t.current=null,s.current&&n(...s.current)}))},e),a=m.useCallback(()=>{t.current!==null&&(cancelAnimationFrame(t.current),t.current=null)},[]);return Object.assign(r,{cancel:a})}function Zf(n,e=!0){const t=Kf(n,[e]);return m.useCallback(r=>{e&&t(r)},[t,e])}function Gf({websites:n,setWebsites:e}){const{parallaxEnabled:t,wallpaperResolution:s,isSettingsOpen:r}=Qt(),{currentUser:a}=dt(),{displayName:i}=Wi(),{isMobile:o,getGridClasses:d,getSearchBarLayout:c}=xi();Df(n);const h=(O,K)=>{const Q=[...n],[Y]=Q.splice(O,1);Q.splice(K,0,Y),e(Q)},[u,f]=m.useState(""),[p,g]=m.useState(!1),[j,y]=m.useState(!1),[x,$]=m.useState({x:0,y:0}),[_,w]=m.useState(!1),[b,v]=m.useState(0),[S,I]=m.useState(!1);m.useEffect(()=>{const O=()=>new Date().toISOString().split("T")[0],K=()=>`wallpaper-${s}-${O()}`,Y=(()=>{try{const L=K(),A=localStorage.getItem(L);if(A){const{url:B,timestamp:H}=JSON.parse(A),k=Date.now(),T=24*60*60*1e3;if(k-H<T&&B)return B}}catch(L){console.warn(":",L)}return null})();Y&&(f(Y),g(!0),console.log(" "))},[]),m.useEffect(()=>{const O=setTimeout(()=>{const K=()=>new Date().toISOString().split("T")[0],Q=A=>`wallpaper-${A}-${K()}`,L=(A=>{try{const B=Q(A),H=localStorage.getItem(B);if(H){const{url:k,timestamp:T}=JSON.parse(H),N=Date.now(),te=24*60*60*1e3;if(N-T<te&&k)return k}}catch(B){console.warn(":",B)}return null})(s);console.log(L?" ":" ")},300);return()=>clearTimeout(O)},[s]);const U=[...n].sort((O,K)=>{const Q=(K.visitCount||0)-(O.visitCount||0);if(Q!==0)return Q;const Y=new Date(O.lastVisit||"2000-01-01").getTime();return new Date(K.lastVisit||"2000-01-01").getTime()-Y}),ne=()=>{S||(v(O=>O+1),I(!0),w(!0),setTimeout(()=>{w(!1),setTimeout(()=>{I(!1)},300)},1e3))},z=O=>{e(n.map(K=>K.id===O.id?{...K,...O}:K))};m.useEffect(()=>{const O=k=>({"4k":"https://bing.img.run/uhd.php","1080p":"https://bing.img.run/1920x1080.php","720p":"https://bing.img.run/1366x768.php",mobile:"https://bing.img.run/m.php"})[k],K=()=>{const k=["https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1920&h=1080&fit=crop","https://images.unsplash.com/photo-1519904981063-b0cf448d479e?w=1920&h=1080&fit=crop","https://images.unsplash.com/photo-1501594907352-04cda38ebc29?w=1920&h=1080&fit=crop"],T=new Date().getDate();return k[T%k.length]},Q=()=>new Date().toISOString().split("T")[0],Y=()=>`wallpaper-${s}-${Q()}`,L=()=>`blob-${s}-${Q()}`,A=async()=>{try{const k=L();console.log(" Blob:",k);const T=await Sn.getCachedWallpaper(k);if(console.log(" Blob:",T?"":""),T)return console.log(" Blob"),{url:T,type:"blob"};const N=Y();console.log(" URL:",N);const te=localStorage.getItem(N);if(te){const{url:J,timestamp:oe}=JSON.parse(te),X=Date.now(),ye=24*60*60*1e3;if(X-oe<ye&&J)return console.log(" URL"),{url:J,type:"url"}}}catch(k){console.warn(":",k)}return null},B=async k=>{try{const T=Y(),N={url:k,timestamp:Date.now(),resolution:s};localStorage.setItem(T,JSON.stringify(N)),console.log(" URL");const te=L();console.log(" Blob..."),Sn.cacheWallpaperBlob(k,te).then(J=>{console.log(" Blob"),console.log(" Blob URL:",J)}).catch(J=>{console.warn(" BlobURL:",J)}),console.log(" ")}catch(T){console.warn(":",T)}},H=(k,T=!1)=>{console.log(" :",s,T?"()":""),g(!1);const N=new Image,te=setTimeout(()=>{if(N.onload=null,N.onerror=null,console.warn(" "),T)f(""),g(!0);else{const J=K();H(J,!0)}},6e3);N.onload=()=>{clearTimeout(te),f(N.src),g(!0),B(N.src),console.log(" :",N.src)},N.onerror=()=>{if(clearTimeout(te),T)console.warn(" "),f(""),g(!0);else{console.warn(" API");const J=K();H(J,!0)}},N.src=k};A().then(k=>{if(k){if(console.log(` ${k.type==="blob"?"Blob":"URL"}:`,k.url),f(k.url),g(!0),k.type==="url"){const T=L();console.log(" Blob..."),Sn.cacheWallpaperBlob(k.url,T).then(N=>{console.log(" Blob"),console.log(" Blob URL:",N)}).catch(N=>{console.warn(" Blob:",N)})}}else{const T=O(s);console.log("  Bing :",T),H(T)}}).catch(k=>{console.warn(":",k);const T=O(s);console.log("  Bing :",T),H(T)})},[s]);const V=m.useCallback(O=>{$({x:O.clientX,y:O.clientY})},[]),re=Zf(V,t&&!r);m.useEffect(()=>{if(!t||r){$({x:0,y:0});return}return window.addEventListener("mousemove",re,{passive:!0}),()=>{window.removeEventListener("mousemove",re)}},[t,r,re]),m.useEffect(()=>{if(n.length>0){const O=setTimeout(()=>{console.log("  favicon..."),On.batchCacheFaviconsToIndexedDB(n).then(()=>{console.log(" Favicon ")}).catch(K=>{console.warn(" Favicon :",K)})},2e3);return()=>clearTimeout(O)}},[n]);const ae=(()=>{const O=c(),K=d();return{container:`relative min-h-screen ${o?"pt-[25vh]":"pt-[33vh]"}`,searchContainer:O.containerClass,cardContainer:`${o?"pt-8 pb-4":"pt-16 pb-8"} px-4 max-w-6xl mx-auto`,gridLayout:K,userInfo:o?"fixed top-2 right-2 z-40 scale-90":"fixed top-4 right-4 z-40",settingsButton:o?"fixed bottom-2 right-2 z-[9999] p-2 bg-white/10 rounded-full backdrop-blur-sm":"fixed bottom-4 right-4 z-[9999]"}})();return l.jsxs(l.Fragment,{children:[l.jsx(Hf,{}),l.jsx("div",{className:"fixed top-0 left-0 w-full h-full -z-10",style:{backgroundImage:u?`url(${u})`:void 0,backgroundSize:"cover",backgroundPosition:o?"center center":"center top",backgroundRepeat:"no-repeat",filter:p?"none":"blur(2px)",transform:!r&&t&&!o&&x?`translate(${x.x*.02}px, ${x.y*.02}px) scale(1.05)`:"translate(0px, 0px) scale(1)",transition:"filter 1.5s ease-out, transform 0.3s ease-out"}}),u&&l.jsx("div",{className:"fixed top-0 left-0 w-full h-full -z-10",style:{background:o?"linear-gradient(to bottom, rgba(30, 41, 59, 0.6) 0%, rgba(30, 41, 59, 0.4) 50%, rgba(30, 41, 59, 0.2) 100%)":"linear-gradient(to bottom, rgba(30, 41, 59, 0.7) 0%, rgba(30, 41, 59, 0.3) 50%, rgba(30, 41, 59, 0.1) 100%)",opacity:p?0:1,transition:"opacity 1.5s ease-out",pointerEvents:"none"}}),!p&&u&&l.jsx("div",{className:`fixed ${o?"top-2 left-2":"top-4 left-4"} z-40 bg-black/30 backdrop-blur-sm rounded-lg px-4 py-2`,children:l.jsxs("div",{className:"text-white/90 text-sm font-medium flex items-center space-x-2",children:[l.jsx("div",{className:"animate-pulse rounded-full h-2 w-2 bg-white/70"}),l.jsx("span",{className:o?"text-xs":"text-sm",children:""})]})}),l.jsxs("div",{className:ae.container,children:[l.jsx("div",{className:ae.searchContainer,children:l.jsx(bu,{})}),l.jsx("div",{className:ae.cardContainer,children:l.jsx(le.div,{className:ae.gridLayout,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:U.map((O,K)=>l.jsx(vu,{...O,index:K,moveCard:h,onSave:z,onDelete:Q=>{e(n.filter(Y=>Y.id!==Q))}},O.id))})}),j&&l.jsx(Vf,{onClose:()=>y(!1),websites:n,setWebsites:e}),a&&a.emailVerified&&l.jsxs("div",{className:ae.userInfo,children:[l.jsxs("button",{onClick:ne,className:`bg-white/20 backdrop-blur-sm rounded-lg ${o?"px-2 py-1":"px-3 py-2"} flex items-center space-x-2 hover:bg-white/30 transition-colors cursor-pointer`,children:[l.jsx("i",{className:`fa-solid fa-user text-white/80 ${o?"text-xs":""}`}),l.jsx("span",{className:`text-white/90 ${o?"text-xs":"text-sm"} font-medium ${o&&i.length>8?"max-w-[60px] truncate":""}`,children:i})]}),_&&!o&&l.jsxs("div",{className:`absolute top-full right-0 mt-2 bg-white/95 backdrop-blur-sm rounded-lg px-4 py-3 shadow-lg border border-white/20 transition-opacity duration-300 ${_?"opacity-100":"opacity-0"}`,children:[l.jsx("p",{className:"text-gray-800 text-sm font-medium whitespace-nowrap",children:b>=10?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"text-red-500",children:""})," "]}):`"${i}"`}),l.jsx("div",{className:"absolute -top-2 right-4 w-0 h-0 border-l-4 border-r-4 border-b-4 border-l-transparent border-r-transparent border-b-white/95"})]})]}),l.jsx("div",{className:ae.settingsButton,children:l.jsx("button",{onClick:()=>y(!0),className:"p-2 text-white/70 hover:text-white transition-colors","aria-label":"",children:l.jsx("i",{className:`fa-solid fa-sliders ${o?"text-base":"text-lg"}`})})}),!o&&l.jsx(wu,{})]})]})}function Jf({isOpen:n,onClose:e,localWebsites:t,cloudWebsites:s,onChoice:r}){const[a,i]=m.useState(!1);if(!n)return null;const o=async d=>{i(!0);try{await r(d),e()}catch(c){console.error(":",c)}finally{i(!1)}};return l.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:[l.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),l.jsxs(le.div,{className:"w-96 bg-white rounded-xl shadow-2xl z-50 max-h-[80vh] flex flex-col",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",damping:20,stiffness:300},children:[l.jsx("div",{className:"p-6 pb-0",children:l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-xl font-medium text-gray-800",children:""}),l.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",disabled:a,children:l.jsx("i",{className:"fa-solid fa-xmark text-lg"})})]})}),l.jsxs("div",{className:"flex-1 px-6 py-2 pb-6 space-y-4 overflow-y-auto",children:[l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:l.jsxs("p",{className:"text-sm text-blue-800 mb-2",children:[l.jsx("i",{className:"fa-solid fa-info-circle mr-2"}),""]})}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[l.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:[l.jsx("i",{className:"fa-solid fa-computer mr-2"}),""]}),l.jsxs("p",{className:"text-xs text-gray-600",children:[t.length," "]})]}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[l.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:[l.jsx("i",{className:"fa-solid fa-cloud mr-2"}),""]}),l.jsxs("p",{className:"text-xs text-gray-600",children:[s.length," "]})]})]}),l.jsxs("div",{className:"space-y-3 pt-4",children:[l.jsx("button",{onClick:()=>o("cloud"),disabled:a,className:"w-full p-4 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white rounded-lg transition-colors text-left",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("i",{className:"fa-solid fa-cloud-arrow-down text-lg mt-1"}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium",children:""}),l.jsx("div",{className:"text-xs text-blue-100",children:""})]})]})}),l.jsx("button",{onClick:()=>o("local"),disabled:a,className:"w-full p-4 bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white rounded-lg transition-colors text-left",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("i",{className:"fa-solid fa-cloud-arrow-up text-lg mt-1"}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium",children:""}),l.jsx("div",{className:"text-xs text-green-100",children:""})]})]})}),l.jsx("button",{onClick:()=>o("merge"),disabled:a,className:"w-full p-4 bg-purple-500 hover:bg-purple-600 disabled:bg-gray-400 text-white rounded-lg transition-colors text-left",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("i",{className:"fa-solid fa-code-merge text-lg mt-1"}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium",children:""}),l.jsx("div",{className:"text-xs text-purple-100",children:""})]})]})})]}),a&&l.jsxs("div",{className:"flex items-center justify-center py-4",children:[l.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-2"}),l.jsx("span",{className:"text-sm text-gray-600",children:"..."})]})]})]})]})}function Qf(){const{isNetworkOnline:n,isFirebaseConnected:e,error:t}=dt();if(n&&e&&!t)return null;const s=()=>{console.log(" Firebase..."),xu.reset()};return l.jsxs("div",{className:"fixed top-4 right-4 z-50 max-w-sm space-y-2",children:[!n&&l.jsxs("div",{className:"p-3 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded-lg shadow-lg flex items-center space-x-2",children:[l.jsx("i",{className:"fa-solid fa-wifi-slash"}),l.jsx("span",{className:"text-sm",children:""})]}),!e&&n&&l.jsx("div",{className:"p-3 bg-blue-100 border border-blue-400 text-blue-700 rounded-lg shadow-lg",children:l.jsx("div",{className:"flex items-start justify-between space-x-2",children:l.jsxs("div",{className:"flex items-start space-x-2 flex-1",children:[l.jsx("i",{className:"fa-solid fa-cloud-slash mt-0.5"}),l.jsxs("div",{className:"text-sm",children:[l.jsx("div",{className:"font-medium",children:"Firebase"}),l.jsx("div",{className:"text-xs mt-1",children:""}),l.jsx("button",{onClick:s,className:"mt-2 text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700 transition-colors",children:""})]})]})})}),t&&l.jsx("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg shadow-lg",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("i",{className:"fa-solid fa-exclamation-triangle mt-0.5"}),l.jsx("span",{className:"text-sm",children:t})]})})]})}function Yf(n=!0){const{currentUser:e}=sn(),[t,s]=m.useState({cloudWebsites:null,cloudSettings:null,loading:!1,error:null}),r=async()=>{if(!e||!e.email_confirmed_at){s(i=>({...i,error:"",loading:!1}));return}s(i=>({...i,loading:!0,error:null}));try{const[i,o]=await Promise.allSettled([Of(e),Rf(e)]),d=i.status==="fulfilled"?i.value:null,c=o.status==="fulfilled"?o.value:null;s({cloudWebsites:d,cloudSettings:c,loading:!1,error:null}),console.log(" :",{websites:(d==null?void 0:d.length)||0,hasSettings:!!c}),i.status==="rejected"&&console.warn(":",i.reason),o.status==="rejected"&&console.warn(":",o.reason)}catch(i){s(o=>({...o,loading:!1,error:": "+i.message})),console.error(" :",i)}},a=i=>t.cloudWebsites?Af(i,t.cloudWebsites):i;return m.useEffect(()=>{n&&e&&e.email_confirmed_at?r():s({cloudWebsites:null,cloudSettings:null,loading:!1,error:null})},[e,n]),{...t,loadCloudData:r,mergeWithLocalData:a,hasCloudData:!!t.cloudWebsites||!!t.cloudSettings}}const Xf=()=>{m.useEffect(()=>{document.title="jiang_ai_web";const n=()=>{document.hidden?document.title="":document.title="jiang_ai_web"};return document.addEventListener("visibilitychange",n),()=>{document.removeEventListener("visibilitychange",n)}},[])};class ep{constructor(){de(this,"preloadedResources",new Set);de(this,"preloadQueue",[]);de(this,"isProcessing",!1);de(this,"maxConcurrent",3)}async preloadImage(e){return this.preloadedResources.has(e)?!0:new Promise(t=>{const s=new Image;s.onload=()=>{this.preloadedResources.add(e),t(!0)},s.onerror=()=>{t(!1)},s.src=e})}async preloadImages(e){const t=e.filter(s=>!this.preloadedResources.has(s));if(t.length!==0)for(let s=0;s<t.length;s+=this.maxConcurrent){const r=t.slice(s,s+this.maxConcurrent);await Promise.allSettled(r.map(a=>this.preloadImage(a)))}}queuePreload(e){!this.preloadedResources.has(e)&&!this.preloadQueue.includes(e)&&(this.preloadQueue.push(e),this.processQueue())}async processQueue(){if(!(this.isProcessing||this.preloadQueue.length===0)){this.isProcessing=!0;try{"requestIdleCallback"in window?await new Promise(e=>{requestIdleCallback(()=>{this.processBatch(),e()})}):await new Promise(e=>{setTimeout(()=>{this.processBatch(),e()},16)})}finally{this.isProcessing=!1,this.preloadQueue.length>0&&setTimeout(()=>this.processQueue(),100)}}}async processBatch(){const e=this.preloadQueue.splice(0,this.maxConcurrent);e.length!==0&&await Promise.allSettled(e.map(t=>this.preloadImage(t)))}preloadFont(e,t){const s=document.createElement("link");if(s.rel="preload",s.as="font",s.type="font/woff2",s.crossOrigin="anonymous",s.href=e,document.head.appendChild(s),"FontFace"in window){const r=new FontFace(t,`url(${e})`);r.load().then(()=>{document.fonts.add(r)}).catch(a=>{console.warn(":",a)})}}preloadCSS(e){const t=document.createElement("link");t.rel="preload",t.as="style",t.href=e,t.onload=()=>{t.rel="stylesheet"},document.head.appendChild(t)}getStats(){return{preloaded:this.preloadedResources.size,queued:this.preloadQueue.length}}clear(){this.preloadedResources.clear(),this.preloadQueue.length=0}}const Fs=new ep;function tp(n=!0){return m.useEffect(()=>n?(["https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/webfonts/fa-solid-900.woff2","https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/webfonts/fa-regular-400.woff2"].forEach(i=>{Fs.queuePreload(i)}),["https://bing.img.run","https://source.unsplash.com","https://www.google.com","https://favicon.yandex.net","https://icons.duckduckgo.com"].forEach(i=>{const o=document.createElement("link");o.rel="preconnect",o.href=i,document.head.querySelector(`link[href="${i}"]`)||document.head.appendChild(o)}),()=>{}):void 0,[n]),{preloadFavicons:r=>{const a=r.map(i=>i.favicon);Fs.preloadImages(a)},preloadImage:r=>{Fs.queuePreload(r)},getPreloadStats:()=>Fs.getStats()}}function sp({onAccept:n,onDecline:e,onCustomize:t}){const[s,r]=m.useState(!1),[a,i]=m.useState(!1);m.useEffect(()=>{if(!localStorage.getItem("cookie-consent")){const u=setTimeout(()=>{r(!0),i(!0)},2e3);return()=>clearTimeout(u)}},[]);const o=()=>{localStorage.setItem("cookie-consent","accepted"),localStorage.setItem("cookie-consent-date",new Date().toISOString()),i(!1),setTimeout(()=>{r(!1),n==null||n()},300),console.log(" Cookie")},d=()=>{localStorage.setItem("cookie-consent","declined"),localStorage.setItem("cookie-consent-date",new Date().toISOString()),i(!1);try{const h=["cookie-consent","cookie-consent-date"],u=[];for(let f=0;f<localStorage.length;f++){const p=localStorage.key(f);p&&!h.includes(p)&&u.push(p)}u.forEach(f=>localStorage.removeItem(f))}catch(h){console.error(":",h)}setTimeout(()=>{r(!1),e==null||e()},300),console.log(" Cookie")},c=()=>{t==null||t()};return s?l.jsx(bs,{children:a&&l.jsxs(l.Fragment,{children:[l.jsx(le.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/20 z-[9998] pointer-events-none"}),l.jsxs(le.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},transition:{type:"spring",damping:25,stiffness:200},className:"fixed bottom-0 left-0 right-0 z-[9999] bg-white border-t border-gray-200 shadow-2xl",children:[l.jsx("div",{className:"max-w-7xl mx-auto p-4 sm:p-6",children:l.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:"flex-shrink-0 mt-1",children:l.jsx("i",{className:"fa-solid fa-cookie-bite text-amber-500 text-xl"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:" Cookie"}),l.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed",children:["Cookie",l.jsx("br",{}),l.jsxs("span",{className:"inline-flex items-center gap-4 mt-1 text-xs",children:[l.jsx("span",{children:" "}),l.jsx("span",{children:" "}),l.jsx("span",{children:" "}),l.jsx("span",{children:" "})]})]}),l.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Cookie",l.jsx("button",{className:"text-blue-600 hover:text-blue-800 underline mx-1",onClick:()=>window.open("https://github.com/your-repo/privacy-policy","_blank"),children:""})]})]})]})}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[l.jsxs("button",{onClick:c,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[l.jsx("i",{className:"fa-solid fa-cog mr-2"}),""]}),l.jsxs("button",{onClick:d,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[l.jsx("i",{className:"fa-solid fa-times mr-2"}),""]}),l.jsxs("button",{onClick:o,className:"px-6 py-2 text-sm bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-medium",children:[l.jsx("i",{className:"fa-solid fa-check mr-2"}),""]})]})]})}),l.jsx("div",{className:"h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500"})]})]})}):null}function np(n){const e=m.useRef(n.length),t=n.length;return e.current!==t&&(e.current=t),e.current}function rp(n,e){const t=[],s=new Map(n.map(c=>[c.id,c])),r=new Map(e.map(c=>[c.id,c])),a=new Set([...s.keys(),...r.keys()]);let i=0,o=0,d=0;for(const c of a){const h=s.get(c),u=r.get(c);if(h&&!u)t.push({id:c,type:"missing_cloud",localData:h}),i++;else if(!h&&u)t.push({id:c,type:"missing_local",cloudData:u}),o++;else if(h&&u){const f=[];h.name!==u.name&&f.push("name"),h.url!==u.url&&f.push("url"),h.note!==u.note&&f.push("note"),JSON.stringify(h.tags)!==JSON.stringify(u.tags)&&f.push("tags"),f.length>0&&(t.push({id:c,type:"different_content",localData:h,cloudData:u,fields:f}),d++)}}return{hasConflicts:t.length>0,conflicts:t,summary:{totalLocal:n.length,totalCloud:e.length,onlyLocal:i,onlyCloud:o,different:d}}}function ap(n,e){return n.length!==e.length?!0:rp(n,e).hasConflicts}function ip(){Xf();const{websites:n,setWebsites:e}=Ki(),{currentUser:t}=sn(),[s,r]=m.useState(!1),a=s&&!!(t!=null&&t.email_confirmed_at),{cloudWebsites:i,cloudSettings:o,hasCloudData:d,mergeWithLocalData:c}=Yf(a);tp(s);const{setCardOpacity:h,setSearchBarOpacity:u,setParallaxEnabled:f,setWallpaperResolution:p}=Qt(),[g,j]=m.useState(!1),[y,x]=m.useState(!1),[$,_]=m.useState(!1);m.useEffect(()=>{const v=setTimeout(()=>{r(!0)},100);return()=>clearTimeout(v)},[]);const w=np(n);m.useEffect(()=>{if(a&&t&&t.email_confirmed_at&&d&&i&&!y){const v=w,S=i.length;v>0&&S>0&&ap(n,i)?j(!0):(S>0&&v===0&&e(i),x(!0))}},[a,t,d,i,w,y,e,n]),m.useEffect(()=>{a&&t&&t.email_confirmed_at&&o&&(typeof o.cardOpacity=="number"&&h(o.cardOpacity),typeof o.searchBarOpacity=="number"&&u(o.searchBarOpacity),typeof o.parallaxEnabled=="boolean"&&f(o.parallaxEnabled),o.wallpaperResolution&&p(o.wallpaperResolution),o.theme&&localStorage.setItem("theme",o.theme))},[a,t,o,h,u,f,p]);const b=async v=>{if(!(!t||!i))try{let S=[];switch(v){case"cloud":S=i,e(S);break;case"local":S=n,await qn(t,S);break;case"merge":S=c(n),e(S),await qn(t,S);break}x(!0)}catch(S){console.error(" :",S)}};return l.jsxs(l.Fragment,{children:[l.jsx(io,{children:l.jsx(oo,{path:"/",element:l.jsx(Gf,{websites:n,setWebsites:e})})}),g&&i&&l.jsx(Jf,{isOpen:g,onClose:()=>{j(!1),x(!0)},localWebsites:n,cloudWebsites:i,onChoice:b}),l.jsx(sp,{onAccept:()=>{console.log(" Cookie")},onDecline:()=>{console.log(" Cookie")},onCustomize:()=>{_(!0)}}),$&&l.jsx(Hi,{isOpen:$,onClose:()=>_(!1)}),l.jsx(Qf,{})]})}function op(){return l.jsx(Cf,{children:l.jsx(Pf,{children:l.jsx($f,{children:l.jsx(pu,{children:l.jsx(no,{backend:ro,children:l.jsx(ip,{})})})})})})}const lp=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",cp=lp?void 0:"/jiang_ai_web",dp=({error:n})=>l.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100vh",background:"white",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"20px",fontFamily:"Arial, sans-serif"},children:[l.jsx("h1",{style:{color:"red",marginBottom:"20px"},children:""}),l.jsxs("pre",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",fontSize:"14px",maxWidth:"80%",overflow:"auto"},children:[n.message,`

`,n.stack]})]});try{const n=document.getElementById("root");if(!n)throw new Error('id"root"');vr.createRoot(n).render(l.jsx(m.StrictMode,{children:l.jsxs(lo,{basename:cp,children:[l.jsx(op,{}),l.jsx(sl,{})]})}))}catch(n){console.error(" React:",n),vr.createRoot(document.getElementById("root")).render(l.jsx(dp,{error:n}))}
