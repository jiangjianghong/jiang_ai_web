var Ga=Object.defineProperty;var Ja=(t,e,s)=>e in t?Ga(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var oe=(t,e,s)=>Ja(t,typeof e!="symbol"?e+"":e,s);import{j as i,m as re,u as Qa,a as Ya,A as Pt,D as Xa,H as er}from"./ui-vendor-Bc0nx1qi.js";import{R as j,a as tr,r as h,b as sr,c as nr,B as ar}from"./router-vendor-ojeZ8ZvP.js";import{a as rr}from"./react-vendor-BtP0CW_r.js";import{_ as Lt,C as Bt,r as ft,S as ir,a as or,F as Bs,g as Vn,b as xt,c as zt,d as lr,i as Wn,p as cr,u as dr,e as ur,E as Zn,o as fr,L as hr,f as mr,h as pr,v as gr,j as an,k as xr,l as yr,m as br,n as vr,q as wr,s as _r,t as Nr,G as jr,w as Sr,x as kr,y as Cr,z as Tr,A as Er,B as yt,D as Ms,H as Xt,I as Fs}from"./firebase-vendor-ZBlOrbTj.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(a){if(a.ep)return;a.ep=!0;const r=s(a);fetch(a.href,r)}})();var Ht={},rn;function Ir(){if(rn)return Ht;rn=1;var t=rr();return Ht.createRoot=t.createRoot,Ht.hydrateRoot=t.hydrateRoot,Ht}var on=Ir();function Rr(t){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",e.appendChild(s),s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}const Ar=t=>{switch(t){case"success":return $r;case"info":return Lr;case"warning":return Pr;case"error":return Br;default:return null}},Or=Array(12).fill(0),Dr=({visible:t,className:e})=>j.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},j.createElement("div",{className:"sonner-spinner"},Or.map((s,n)=>j.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),$r=j.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},j.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Pr=j.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},j.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Lr=j.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},j.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Br=j.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},j.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Mr=j.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},j.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),j.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),Fr=()=>{const[t,e]=j.useState(document.hidden);return j.useEffect(()=>{const s=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",s),()=>window.removeEventListener("visibilitychange",s)},[]),t};let js=1;class Ur{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const s=this.subscribers.indexOf(e);this.subscribers.splice(s,1)}),this.publish=e=>{this.subscribers.forEach(s=>s(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var s;const{message:n,...a}=e,r=typeof(e==null?void 0:e.id)=="number"||((s=e.id)==null?void 0:s.length)>0?e.id:js++,o=this.toasts.find(u=>u.id===r),l=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(r)&&this.dismissedToasts.delete(r),o?this.toasts=this.toasts.map(u=>u.id===r?(this.publish({...u,...e,id:r,title:n}),{...u,...e,id:r,dismissible:l,title:n}):u):this.addToast({title:n,...a,dismissible:l,id:r}),r},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(s=>s({id:e,dismiss:!0})))):this.toasts.forEach(s=>{this.subscribers.forEach(n=>n({id:s.id,dismiss:!0}))}),e),this.message=(e,s)=>this.create({...s,message:e}),this.error=(e,s)=>this.create({...s,message:e,type:"error"}),this.success=(e,s)=>this.create({...s,type:"success",message:e}),this.info=(e,s)=>this.create({...s,type:"info",message:e}),this.warning=(e,s)=>this.create({...s,type:"warning",message:e}),this.loading=(e,s)=>this.create({...s,type:"loading",message:e}),this.promise=(e,s)=>{if(!s)return;let n;s.loading!==void 0&&(n=this.create({...s,promise:e,type:"loading",message:s.loading,description:typeof s.description!="function"?s.description:void 0}));const a=Promise.resolve(e instanceof Function?e():e);let r=n!==void 0,o;const l=a.then(async c=>{if(o=["resolve",c],j.isValidElement(c))r=!1,this.create({id:n,type:"default",message:c});else if(Vr(c)&&!c.ok){r=!1;const d=typeof s.error=="function"?await s.error(`HTTP error! status: ${c.status}`):s.error,m=typeof s.description=="function"?await s.description(`HTTP error! status: ${c.status}`):s.description,x=typeof d=="object"&&!j.isValidElement(d)?d:{message:d};this.create({id:n,type:"error",description:m,...x})}else if(c instanceof Error){r=!1;const d=typeof s.error=="function"?await s.error(c):s.error,m=typeof s.description=="function"?await s.description(c):s.description,x=typeof d=="object"&&!j.isValidElement(d)?d:{message:d};this.create({id:n,type:"error",description:m,...x})}else if(s.success!==void 0){r=!1;const d=typeof s.success=="function"?await s.success(c):s.success,m=typeof s.description=="function"?await s.description(c):s.description,x=typeof d=="object"&&!j.isValidElement(d)?d:{message:d};this.create({id:n,type:"success",description:m,...x})}}).catch(async c=>{if(o=["reject",c],s.error!==void 0){r=!1;const f=typeof s.error=="function"?await s.error(c):s.error,d=typeof s.description=="function"?await s.description(c):s.description,g=typeof f=="object"&&!j.isValidElement(f)?f:{message:f};this.create({id:n,type:"error",description:d,...g})}}).finally(()=>{r&&(this.dismiss(n),n=void 0),s.finally==null||s.finally.call(s)}),u=()=>new Promise((c,f)=>l.then(()=>o[0]==="reject"?f(o[1]):c(o[1])).catch(f));return typeof n!="string"&&typeof n!="number"?{unwrap:u}:Object.assign(n,{unwrap:u})},this.custom=(e,s)=>{const n=(s==null?void 0:s.id)||js++;return this.create({jsx:e(n),id:n,...s}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const xe=new Ur,zr=(t,e)=>{const s=(e==null?void 0:e.id)||js++;return xe.addToast({title:t,...e,id:s}),s},Vr=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",Wr=zr,Zr=()=>xe.toasts,Hr=()=>xe.getActiveToasts();Object.assign(Wr,{success:xe.success,info:xe.info,warning:xe.warning,error:xe.error,custom:xe.custom,message:xe.message,promise:xe.promise,dismiss:xe.dismiss,loading:xe.loading},{getHistory:Zr,getToasts:Hr});Rr("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function qt(t){return t.label!==void 0}const qr=3,Kr="24px",Gr="16px",ln=4e3,Jr=356,Qr=14,Yr=45,Xr=200;function De(...t){return t.filter(Boolean).join(" ")}function ei(t){const[e,s]=t.split("-"),n=[];return e&&n.push(e),s&&n.push(s),n}const ti=t=>{var e,s,n,a,r,o,l,u,c;const{invert:f,toast:d,unstyled:m,interacting:g,setHeights:x,visibleToasts:$,heights:b,index:S,toasts:L,expanded:O,removeToast:y,defaultRichColors:k,closeButton:v,style:T,cancelButtonStyle:E,actionButtonStyle:se,className:ee="",descriptionClassName:U="",duration:V,position:te,gap:ie,expandByDefault:ne,classNames:I,icons:Z,closeButtonAriaLabel:K="Close toast"}=t,[G,P]=j.useState(null),[R,B]=j.useState(null),[W,p]=j.useState(!1),[_,N]=j.useState(!1),[Y,q]=j.useState(!1),[ae,J]=j.useState(!1),[fe,Ae]=j.useState(!1),[wt,ct]=j.useState(0),[_t,dt]=j.useState(0),Ue=j.useRef(d.duration||V||ln),Nt=j.useRef(null),Ne=j.useRef(null),jt=S===0,us=S+1<=$,me=d.type,Le=d.dismissible!==!1,St=d.className||"",fs=d.descriptionClassName||"",Je=j.useMemo(()=>b.findIndex(z=>z.toastId===d.id)||0,[b,d.id]),hs=j.useMemo(()=>{var z;return(z=d.closeButton)!=null?z:v},[d.closeButton,v]),kt=j.useMemo(()=>d.duration||V||ln,[d.duration,V]),ze=j.useRef(0),je=j.useRef(0),Te=j.useRef(0),Oe=j.useRef(null),[Ct,Za]=te.split("-"),Xs=j.useMemo(()=>b.reduce((z,ue,pe)=>pe>=Je?z:z+ue.height,0),[b,Je]),en=Fr(),Ha=d.invert||f,ms=me==="loading";je.current=j.useMemo(()=>Je*ie+Xs,[Je,Xs]),j.useEffect(()=>{Ue.current=kt},[kt]),j.useEffect(()=>{p(!0)},[]),j.useEffect(()=>{const z=Ne.current;if(z){const ue=z.getBoundingClientRect().height;return dt(ue),x(pe=>[{toastId:d.id,height:ue,position:d.position},...pe]),()=>x(pe=>pe.filter(be=>be.toastId!==d.id))}},[x,d.id]),j.useLayoutEffect(()=>{if(!W)return;const z=Ne.current,ue=z.style.height;z.style.height="auto";const pe=z.getBoundingClientRect().height;z.style.height=ue,dt(pe),x(be=>be.find(he=>he.toastId===d.id)?be.map(he=>he.toastId===d.id?{...he,height:pe}:he):[{toastId:d.id,height:pe,position:d.position},...be])},[W,d.title,d.description,x,d.id,d.jsx,d.action,d.cancel]);const Ve=j.useCallback(()=>{N(!0),ct(je.current),x(z=>z.filter(ue=>ue.toastId!==d.id)),setTimeout(()=>{y(d)},Xr)},[d,y,x,je]);j.useEffect(()=>{if(d.promise&&me==="loading"||d.duration===1/0||d.type==="loading")return;let z;return O||g||en?(()=>{if(Te.current<ze.current){const be=new Date().getTime()-ze.current;Ue.current=Ue.current-be}Te.current=new Date().getTime()})():(()=>{Ue.current!==1/0&&(ze.current=new Date().getTime(),z=setTimeout(()=>{d.onAutoClose==null||d.onAutoClose.call(d,d),Ve()},Ue.current))})(),()=>clearTimeout(z)},[O,g,d,me,en,Ve]),j.useEffect(()=>{d.delete&&(Ve(),d.onDismiss==null||d.onDismiss.call(d,d))},[Ve,d.delete]);function qa(){var z;if(Z!=null&&Z.loading){var ue;return j.createElement("div",{className:De(I==null?void 0:I.loader,d==null||(ue=d.classNames)==null?void 0:ue.loader,"sonner-loader"),"data-visible":me==="loading"},Z.loading)}return j.createElement(Dr,{className:De(I==null?void 0:I.loader,d==null||(z=d.classNames)==null?void 0:z.loader),visible:me==="loading"})}const Ka=d.icon||(Z==null?void 0:Z[me])||Ar(me);var tn,sn;return j.createElement("li",{tabIndex:0,ref:Ne,className:De(ee,St,I==null?void 0:I.toast,d==null||(e=d.classNames)==null?void 0:e.toast,I==null?void 0:I.default,I==null?void 0:I[me],d==null||(s=d.classNames)==null?void 0:s[me]),"data-sonner-toast":"","data-rich-colors":(tn=d.richColors)!=null?tn:k,"data-styled":!(d.jsx||d.unstyled||m),"data-mounted":W,"data-promise":!!d.promise,"data-swiped":fe,"data-removed":_,"data-visible":us,"data-y-position":Ct,"data-x-position":Za,"data-index":S,"data-front":jt,"data-swiping":Y,"data-dismissible":Le,"data-type":me,"data-invert":Ha,"data-swipe-out":ae,"data-swipe-direction":R,"data-expanded":!!(O||ne&&W),style:{"--index":S,"--toasts-before":S,"--z-index":L.length-S,"--offset":`${_?wt:je.current}px`,"--initial-height":ne?"auto":`${_t}px`,...T,...d.style},onDragEnd:()=>{q(!1),P(null),Oe.current=null},onPointerDown:z=>{z.button!==2&&(ms||!Le||(Nt.current=new Date,ct(je.current),z.target.setPointerCapture(z.pointerId),z.target.tagName!=="BUTTON"&&(q(!0),Oe.current={x:z.clientX,y:z.clientY})))},onPointerUp:()=>{var z,ue,pe;if(ae||!Le)return;Oe.current=null;const be=Number(((z=Ne.current)==null?void 0:z.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Wt=Number(((ue=Ne.current)==null?void 0:ue.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),he=new Date().getTime()-((pe=Nt.current)==null?void 0:pe.getTime()),Se=G==="x"?be:Wt,Zt=Math.abs(Se)/he;if(Math.abs(Se)>=Yr||Zt>.11){ct(je.current),d.onDismiss==null||d.onDismiss.call(d,d),B(G==="x"?be>0?"right":"left":Wt>0?"down":"up"),Ve(),J(!0);return}else{var Ee,Ie;(Ee=Ne.current)==null||Ee.style.setProperty("--swipe-amount-x","0px"),(Ie=Ne.current)==null||Ie.style.setProperty("--swipe-amount-y","0px")}Ae(!1),q(!1),P(null)},onPointerMove:z=>{var ue,pe,be;if(!Oe.current||!Le||((ue=window.getSelection())==null?void 0:ue.toString().length)>0)return;const he=z.clientY-Oe.current.y,Se=z.clientX-Oe.current.x;var Zt;const Ee=(Zt=t.swipeDirections)!=null?Zt:ei(te);!G&&(Math.abs(Se)>1||Math.abs(he)>1)&&P(Math.abs(Se)>Math.abs(he)?"x":"y");let Ie={x:0,y:0};const nn=Qe=>1/(1.5+Math.abs(Qe)/20);if(G==="y"){if(Ee.includes("top")||Ee.includes("bottom"))if(Ee.includes("top")&&he<0||Ee.includes("bottom")&&he>0)Ie.y=he;else{const Qe=he*nn(he);Ie.y=Math.abs(Qe)<Math.abs(he)?Qe:he}}else if(G==="x"&&(Ee.includes("left")||Ee.includes("right")))if(Ee.includes("left")&&Se<0||Ee.includes("right")&&Se>0)Ie.x=Se;else{const Qe=Se*nn(Se);Ie.x=Math.abs(Qe)<Math.abs(Se)?Qe:Se}(Math.abs(Ie.x)>0||Math.abs(Ie.y)>0)&&Ae(!0),(pe=Ne.current)==null||pe.style.setProperty("--swipe-amount-x",`${Ie.x}px`),(be=Ne.current)==null||be.style.setProperty("--swipe-amount-y",`${Ie.y}px`)}},hs&&!d.jsx&&me!=="loading"?j.createElement("button",{"aria-label":K,"data-disabled":ms,"data-close-button":!0,onClick:ms||!Le?()=>{}:()=>{Ve(),d.onDismiss==null||d.onDismiss.call(d,d)},className:De(I==null?void 0:I.closeButton,d==null||(n=d.classNames)==null?void 0:n.closeButton)},(sn=Z==null?void 0:Z.close)!=null?sn:Mr):null,(me||d.icon||d.promise)&&d.icon!==null&&((Z==null?void 0:Z[me])!==null||d.icon)?j.createElement("div",{"data-icon":"",className:De(I==null?void 0:I.icon,d==null||(a=d.classNames)==null?void 0:a.icon)},d.promise||d.type==="loading"&&!d.icon?d.icon||qa():null,d.type!=="loading"?Ka:null):null,j.createElement("div",{"data-content":"",className:De(I==null?void 0:I.content,d==null||(r=d.classNames)==null?void 0:r.content)},j.createElement("div",{"data-title":"",className:De(I==null?void 0:I.title,d==null||(o=d.classNames)==null?void 0:o.title)},d.jsx?d.jsx:typeof d.title=="function"?d.title():d.title),d.description?j.createElement("div",{"data-description":"",className:De(U,fs,I==null?void 0:I.description,d==null||(l=d.classNames)==null?void 0:l.description)},typeof d.description=="function"?d.description():d.description):null),j.isValidElement(d.cancel)?d.cancel:d.cancel&&qt(d.cancel)?j.createElement("button",{"data-button":!0,"data-cancel":!0,style:d.cancelButtonStyle||E,onClick:z=>{qt(d.cancel)&&Le&&(d.cancel.onClick==null||d.cancel.onClick.call(d.cancel,z),Ve())},className:De(I==null?void 0:I.cancelButton,d==null||(u=d.classNames)==null?void 0:u.cancelButton)},d.cancel.label):null,j.isValidElement(d.action)?d.action:d.action&&qt(d.action)?j.createElement("button",{"data-button":!0,"data-action":!0,style:d.actionButtonStyle||se,onClick:z=>{qt(d.action)&&(d.action.onClick==null||d.action.onClick.call(d.action,z),!z.defaultPrevented&&Ve())},className:De(I==null?void 0:I.actionButton,d==null||(c=d.classNames)==null?void 0:c.actionButton)},d.action.label):null)};function cn(){if(typeof window>"u"||typeof document>"u")return"ltr";const t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function si(t,e){const s={};return[t,e].forEach((n,a)=>{const r=a===1,o=r?"--mobile-offset":"--offset",l=r?Gr:Kr;function u(c){["top","right","bottom","left"].forEach(f=>{s[`${o}-${f}`]=typeof c=="number"?`${c}px`:c})}typeof n=="number"||typeof n=="string"?u(n):typeof n=="object"?["top","right","bottom","left"].forEach(c=>{n[c]===void 0?s[`${o}-${c}`]=l:s[`${o}-${c}`]=typeof n[c]=="number"?`${n[c]}px`:n[c]}):u(l)}),s}const ni=j.forwardRef(function(e,s){const{invert:n,position:a="bottom-right",hotkey:r=["altKey","KeyT"],expand:o,closeButton:l,className:u,offset:c,mobileOffset:f,theme:d="light",richColors:m,duration:g,style:x,visibleToasts:$=qr,toastOptions:b,dir:S=cn(),gap:L=Qr,icons:O,containerAriaLabel:y="Notifications"}=e,[k,v]=j.useState([]),T=j.useMemo(()=>Array.from(new Set([a].concat(k.filter(R=>R.position).map(R=>R.position)))),[k,a]),[E,se]=j.useState([]),[ee,U]=j.useState(!1),[V,te]=j.useState(!1),[ie,ne]=j.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),I=j.useRef(null),Z=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),K=j.useRef(null),G=j.useRef(!1),P=j.useCallback(R=>{v(B=>{var W;return(W=B.find(p=>p.id===R.id))!=null&&W.delete||xe.dismiss(R.id),B.filter(({id:p})=>p!==R.id)})},[]);return j.useEffect(()=>xe.subscribe(R=>{if(R.dismiss){requestAnimationFrame(()=>{v(B=>B.map(W=>W.id===R.id?{...W,delete:!0}:W))});return}setTimeout(()=>{tr.flushSync(()=>{v(B=>{const W=B.findIndex(p=>p.id===R.id);return W!==-1?[...B.slice(0,W),{...B[W],...R},...B.slice(W+1)]:[R,...B]})})})}),[k]),j.useEffect(()=>{if(d!=="system"){ne(d);return}if(d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ne("dark"):ne("light")),typeof window>"u")return;const R=window.matchMedia("(prefers-color-scheme: dark)");try{R.addEventListener("change",({matches:B})=>{ne(B?"dark":"light")})}catch{R.addListener(({matches:W})=>{try{ne(W?"dark":"light")}catch(p){console.error(p)}})}},[d]),j.useEffect(()=>{k.length<=1&&U(!1)},[k]),j.useEffect(()=>{const R=B=>{var W;if(r.every(N=>B[N]||B.code===N)){var _;U(!0),(_=I.current)==null||_.focus()}B.code==="Escape"&&(document.activeElement===I.current||(W=I.current)!=null&&W.contains(document.activeElement))&&U(!1)};return document.addEventListener("keydown",R),()=>document.removeEventListener("keydown",R)},[r]),j.useEffect(()=>{if(I.current)return()=>{K.current&&(K.current.focus({preventScroll:!0}),K.current=null,G.current=!1)}},[I.current]),j.createElement("section",{ref:s,"aria-label":`${y} ${Z}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},T.map((R,B)=>{var W;const[p,_]=R.split("-");return k.length?j.createElement("ol",{key:R,dir:S==="auto"?cn():S,tabIndex:-1,ref:I,className:u,"data-sonner-toaster":!0,"data-sonner-theme":ie,"data-y-position":p,"data-x-position":_,style:{"--front-toast-height":`${((W=E[0])==null?void 0:W.height)||0}px`,"--width":`${Jr}px`,"--gap":`${L}px`,...x,...si(c,f)},onBlur:N=>{G.current&&!N.currentTarget.contains(N.relatedTarget)&&(G.current=!1,K.current&&(K.current.focus({preventScroll:!0}),K.current=null))},onFocus:N=>{N.target instanceof HTMLElement&&N.target.dataset.dismissible==="false"||G.current||(G.current=!0,K.current=N.relatedTarget)},onMouseEnter:()=>U(!0),onMouseMove:()=>U(!0),onMouseLeave:()=>{V||U(!1)},onDragEnd:()=>U(!1),onPointerDown:N=>{N.target instanceof HTMLElement&&N.target.dataset.dismissible==="false"||te(!0)},onPointerUp:()=>te(!1)},k.filter(N=>!N.position&&B===0||N.position===R).map((N,Y)=>{var q,ae;return j.createElement(ti,{key:N.id,icons:O,index:Y,toast:N,defaultRichColors:m,duration:(q=b==null?void 0:b.duration)!=null?q:g,className:b==null?void 0:b.className,descriptionClassName:b==null?void 0:b.descriptionClassName,invert:n,visibleToasts:$,closeButton:(ae=b==null?void 0:b.closeButton)!=null?ae:l,interacting:V,position:R,style:b==null?void 0:b.style,unstyled:b==null?void 0:b.unstyled,classNames:b==null?void 0:b.classNames,cancelButtonStyle:b==null?void 0:b.cancelButtonStyle,actionButtonStyle:b==null?void 0:b.actionButtonStyle,closeButtonAriaLabel:b==null?void 0:b.closeButtonAriaLabel,removeToast:P,toasts:k.filter(J=>J.position==N.position),heights:E.filter(J=>J.position==N.position),setHeights:se,expandByDefault:o,gap:L,expanded:ee,swipeDirections:e.swipeDirections})})):null}))});var X;(function(t){t.assertEqual=a=>{};function e(a){}t.assertIs=e;function s(a){throw new Error}t.assertNever=s,t.arrayToEnum=a=>{const r={};for(const o of a)r[o]=o;return r},t.getValidEnumValues=a=>{const r=t.objectKeys(a).filter(l=>typeof a[a[l]]!="number"),o={};for(const l of r)o[l]=a[l];return t.objectValues(o)},t.objectValues=a=>t.objectKeys(a).map(function(r){return a[r]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const r=[];for(const o in a)Object.prototype.hasOwnProperty.call(a,o)&&r.push(o);return r},t.find=(a,r)=>{for(const o of a)if(r(o))return o},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function n(a,r=" | "){return a.map(o=>typeof o=="string"?`'${o}'`:o).join(r)}t.joinValues=n,t.jsonStringifyReplacer=(a,r)=>typeof r=="bigint"?r.toString():r})(X||(X={}));var dn;(function(t){t.mergeShapes=(e,s)=>({...e,...s})})(dn||(dn={}));const A=X.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),We=t=>{switch(typeof t){case"undefined":return A.undefined;case"string":return A.string;case"number":return Number.isNaN(t)?A.nan:A.number;case"boolean":return A.boolean;case"function":return A.function;case"bigint":return A.bigint;case"symbol":return A.symbol;case"object":return Array.isArray(t)?A.array:t===null?A.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?A.promise:typeof Map<"u"&&t instanceof Map?A.map:typeof Set<"u"&&t instanceof Set?A.set:typeof Date<"u"&&t instanceof Date?A.date:A.object;default:return A.unknown}},w=X.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Me extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const s=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,s):this.__proto__=s,this.name="ZodError",this.issues=e}format(e){const s=e||function(r){return r.message},n={_errors:[]},a=r=>{for(const o of r.issues)if(o.code==="invalid_union")o.unionErrors.map(a);else if(o.code==="invalid_return_type")a(o.returnTypeError);else if(o.code==="invalid_arguments")a(o.argumentsError);else if(o.path.length===0)n._errors.push(s(o));else{let l=n,u=0;for(;u<o.path.length;){const c=o.path[u];u===o.path.length-1?(l[c]=l[c]||{_errors:[]},l[c]._errors.push(s(o))):l[c]=l[c]||{_errors:[]},l=l[c],u++}}};return a(this),n}static assert(e){if(!(e instanceof Me))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,X.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=s=>s.message){const s={},n=[];for(const a of this.issues)if(a.path.length>0){const r=a.path[0];s[r]=s[r]||[],s[r].push(e(a))}else n.push(e(a));return{formErrors:n,fieldErrors:s}}get formErrors(){return this.flatten()}}Me.create=t=>new Me(t);const Ss=(t,e)=>{let s;switch(t.code){case w.invalid_type:t.received===A.undefined?s="Required":s=`Expected ${t.expected}, received ${t.received}`;break;case w.invalid_literal:s=`Invalid literal value, expected ${JSON.stringify(t.expected,X.jsonStringifyReplacer)}`;break;case w.unrecognized_keys:s=`Unrecognized key(s) in object: ${X.joinValues(t.keys,", ")}`;break;case w.invalid_union:s="Invalid input";break;case w.invalid_union_discriminator:s=`Invalid discriminator value. Expected ${X.joinValues(t.options)}`;break;case w.invalid_enum_value:s=`Invalid enum value. Expected ${X.joinValues(t.options)}, received '${t.received}'`;break;case w.invalid_arguments:s="Invalid function arguments";break;case w.invalid_return_type:s="Invalid function return type";break;case w.invalid_date:s="Invalid date";break;case w.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(s=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(s=`${s} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?s=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?s=`Invalid input: must end with "${t.validation.endsWith}"`:X.assertNever(t.validation):t.validation!=="regex"?s=`Invalid ${t.validation}`:s="Invalid";break;case w.too_small:t.type==="array"?s=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?s=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?s=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?s=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?s=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:s="Invalid input";break;case w.too_big:t.type==="array"?s=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?s=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?s=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?s=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?s=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:s="Invalid input";break;case w.custom:s="Invalid input";break;case w.invalid_intersection_types:s="Intersection results could not be merged";break;case w.not_multiple_of:s=`Number must be a multiple of ${t.multipleOf}`;break;case w.not_finite:s="Number must be finite";break;default:s=e.defaultError,X.assertNever(t)}return{message:s}};let ai=Ss;function ri(){return ai}const ii=t=>{const{data:e,path:s,errorMaps:n,issueData:a}=t,r=[...s,...a.path||[]],o={...a,path:r};if(a.message!==void 0)return{...a,path:r,message:a.message};let l="";const u=n.filter(c=>!!c).slice().reverse();for(const c of u)l=c(o,{data:e,defaultError:l}).message;return{...a,path:r,message:l}};function C(t,e){const s=ri(),n=ii({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,s,s===Ss?void 0:Ss].filter(a=>!!a)});t.common.issues.push(n)}class _e{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,s){const n=[];for(const a of s){if(a.status==="aborted")return M;a.status==="dirty"&&e.dirty(),n.push(a.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,s){const n=[];for(const a of s){const r=await a.key,o=await a.value;n.push({key:r,value:o})}return _e.mergeObjectSync(e,n)}static mergeObjectSync(e,s){const n={};for(const a of s){const{key:r,value:o}=a;if(r.status==="aborted"||o.status==="aborted")return M;r.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),r.value!=="__proto__"&&(typeof o.value<"u"||a.alwaysSet)&&(n[r.value]=o.value)}return{status:e.value,value:n}}}const M=Object.freeze({status:"aborted"}),At=t=>({status:"dirty",value:t}),ke=t=>({status:"valid",value:t}),un=t=>t.status==="aborted",fn=t=>t.status==="dirty",ht=t=>t.status==="valid",es=t=>typeof Promise<"u"&&t instanceof Promise;var D;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(D||(D={}));class Ke{constructor(e,s,n,a){this._cachedPath=[],this.parent=e,this.data=s,this._path=n,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const hn=(t,e)=>{if(ht(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const s=new Me(t.common.issues);return this._error=s,this._error}}};function H(t){if(!t)return{};const{errorMap:e,invalid_type_error:s,required_error:n,description:a}=t;if(e&&(s||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(o,l)=>{const{message:u}=t;return o.code==="invalid_enum_value"?{message:u??l.defaultError}:typeof l.data>"u"?{message:u??n??l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:u??s??l.defaultError}},description:a}}class Q{get description(){return this._def.description}_getType(e){return We(e.data)}_getOrReturnCtx(e,s){return s||{common:e.parent.common,data:e.data,parsedType:We(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new _e,ctx:{common:e.parent.common,data:e.data,parsedType:We(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const s=this._parse(e);if(es(s))throw new Error("Synchronous parse encountered promise.");return s}_parseAsync(e){const s=this._parse(e);return Promise.resolve(s)}parse(e,s){const n=this.safeParse(e,s);if(n.success)return n.data;throw n.error}safeParse(e,s){const n={common:{issues:[],async:(s==null?void 0:s.async)??!1,contextualErrorMap:s==null?void 0:s.errorMap},path:(s==null?void 0:s.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:We(e)},a=this._parseSync({data:e,path:n.path,parent:n});return hn(n,a)}"~validate"(e){var n,a;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:We(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:s});return ht(r)?{value:r.value}:{issues:s.common.issues}}catch(r){(a=(n=r==null?void 0:r.message)==null?void 0:n.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:s}).then(r=>ht(r)?{value:r.value}:{issues:s.common.issues})}async parseAsync(e,s){const n=await this.safeParseAsync(e,s);if(n.success)return n.data;throw n.error}async safeParseAsync(e,s){const n={common:{issues:[],contextualErrorMap:s==null?void 0:s.errorMap,async:!0},path:(s==null?void 0:s.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:We(e)},a=this._parse({data:e,path:n.path,parent:n}),r=await(es(a)?a:Promise.resolve(a));return hn(n,r)}refine(e,s){const n=a=>typeof s=="string"||typeof s>"u"?{message:s}:typeof s=="function"?s(a):s;return this._refinement((a,r)=>{const o=e(a),l=()=>r.addIssue({code:w.custom,...n(a)});return typeof Promise<"u"&&o instanceof Promise?o.then(u=>u?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,s){return this._refinement((n,a)=>e(n)?!0:(a.addIssue(typeof s=="function"?s(n,a):s),!1))}_refinement(e){return new pt({schema:this,typeName:F.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:s=>this["~validate"](s)}}optional(){return qe.create(this,this._def)}nullable(){return gt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Pe.create(this)}promise(){return as.create(this,this._def)}or(e){return ss.create([this,e],this._def)}and(e){return ns.create(this,e,this._def)}transform(e){return new pt({...H(this._def),schema:this,typeName:F.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const s=typeof e=="function"?e:()=>e;return new Cs({...H(this._def),innerType:this,defaultValue:s,typeName:F.ZodDefault})}brand(){return new Ei({typeName:F.ZodBranded,type:this,...H(this._def)})}catch(e){const s=typeof e=="function"?e:()=>e;return new Ts({...H(this._def),innerType:this,catchValue:s,typeName:F.ZodCatch})}describe(e){const s=this.constructor;return new s({...this._def,description:e})}pipe(e){return Us.create(this,e)}readonly(){return Es.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const oi=/^c[^\s-]{8,}$/i,li=/^[0-9a-z]+$/,ci=/^[0-9A-HJKMNP-TV-Z]{26}$/i,di=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,ui=/^[a-z0-9_-]{21}$/i,fi=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,hi=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,mi=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,pi="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let ps;const gi=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,xi=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,yi=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,bi=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,vi=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,wi=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Hn="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",_i=new RegExp(`^${Hn}$`);function qn(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const s=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${s}`}function Ni(t){return new RegExp(`^${qn(t)}$`)}function ji(t){let e=`${Hn}T${qn(t)}`;const s=[];return s.push(t.local?"Z?":"Z"),t.offset&&s.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${s.join("|")})`,new RegExp(`^${e}$`)}function Si(t,e){return!!((e==="v4"||!e)&&gi.test(t)||(e==="v6"||!e)&&yi.test(t))}function ki(t,e){if(!fi.test(t))return!1;try{const[s]=t.split(".");if(!s)return!1;const n=s.replace(/-/g,"+").replace(/_/g,"/").padEnd(s.length+(4-s.length%4)%4,"="),a=JSON.parse(atob(n));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||e&&a.alg!==e)}catch{return!1}}function Ci(t,e){return!!((e==="v4"||!e)&&xi.test(t)||(e==="v6"||!e)&&bi.test(t))}class He extends Q{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==A.string){const r=this._getOrReturnCtx(e);return C(r,{code:w.invalid_type,expected:A.string,received:r.parsedType}),M}const n=new _e;let a;for(const r of this._def.checks)if(r.kind==="min")e.data.length<r.value&&(a=this._getOrReturnCtx(e,a),C(a,{code:w.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),n.dirty());else if(r.kind==="max")e.data.length>r.value&&(a=this._getOrReturnCtx(e,a),C(a,{code:w.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),n.dirty());else if(r.kind==="length"){const o=e.data.length>r.value,l=e.data.length<r.value;(o||l)&&(a=this._getOrReturnCtx(e,a),o?C(a,{code:w.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}):l&&C(a,{code:w.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}),n.dirty())}else if(r.kind==="email")mi.test(e.data)||(a=this._getOrReturnCtx(e,a),C(a,{validation:"email",code:w.invalid_string,message:r.message}),n.dirty());else if(r.kind==="emoji")ps||(ps=new RegExp(pi,"u")),ps.test(e.data)||(a=this._getOrReturnCtx(e,a),C(a,{validation:"emoji",code:w.invalid_string,message:r.message}),n.dirty());else if(r.kind==="uuid")di.test(e.data)||(a=this._getOrReturnCtx(e,a),C(a,{validation:"uuid",code:w.invalid_string,message:r.message}),n.dirty());else if(r.kind==="nanoid")ui.test(e.data)||(a=this._getOrReturnCtx(e,a),C(a,{validation:"nanoid",code:w.invalid_string,message:r.message}),n.dirty());else if(r.kind==="cuid")oi.test(e.data)||(a=this._getOrReturnCtx(e,a),C(a,{validation:"cuid",code:w.invalid_string,message:r.message}),n.dirty());else if(r.kind==="cuid2")li.test(e.data)||(a=this._getOrReturnCtx(e,a),C(a,{validation:"cuid2",code:w.invalid_string,message:r.message}),n.dirty());else if(r.kind==="ulid")ci.test(e.data)||(a=this._getOrReturnCtx(e,a),C(a,{validation:"ulid",code:w.invalid_string,message:r.message}),n.dirty());else if(r.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),C(a,{validation:"url",code:w.invalid_string,message:r.message}),n.dirty()}else r.kind==="regex"?(r.regex.lastIndex=0,r.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),C(a,{validation:"regex",code:w.invalid_string,message:r.message}),n.dirty())):r.kind==="trim"?e.data=e.data.trim():r.kind==="includes"?e.data.includes(r.value,r.position)||(a=this._getOrReturnCtx(e,a),C(a,{code:w.invalid_string,validation:{includes:r.value,position:r.position},message:r.message}),n.dirty()):r.kind==="toLowerCase"?e.data=e.data.toLowerCase():r.kind==="toUpperCase"?e.data=e.data.toUpperCase():r.kind==="startsWith"?e.data.startsWith(r.value)||(a=this._getOrReturnCtx(e,a),C(a,{code:w.invalid_string,validation:{startsWith:r.value},message:r.message}),n.dirty()):r.kind==="endsWith"?e.data.endsWith(r.value)||(a=this._getOrReturnCtx(e,a),C(a,{code:w.invalid_string,validation:{endsWith:r.value},message:r.message}),n.dirty()):r.kind==="datetime"?ji(r).test(e.data)||(a=this._getOrReturnCtx(e,a),C(a,{code:w.invalid_string,validation:"datetime",message:r.message}),n.dirty()):r.kind==="date"?_i.test(e.data)||(a=this._getOrReturnCtx(e,a),C(a,{code:w.invalid_string,validation:"date",message:r.message}),n.dirty()):r.kind==="time"?Ni(r).test(e.data)||(a=this._getOrReturnCtx(e,a),C(a,{code:w.invalid_string,validation:"time",message:r.message}),n.dirty()):r.kind==="duration"?hi.test(e.data)||(a=this._getOrReturnCtx(e,a),C(a,{validation:"duration",code:w.invalid_string,message:r.message}),n.dirty()):r.kind==="ip"?Si(e.data,r.version)||(a=this._getOrReturnCtx(e,a),C(a,{validation:"ip",code:w.invalid_string,message:r.message}),n.dirty()):r.kind==="jwt"?ki(e.data,r.alg)||(a=this._getOrReturnCtx(e,a),C(a,{validation:"jwt",code:w.invalid_string,message:r.message}),n.dirty()):r.kind==="cidr"?Ci(e.data,r.version)||(a=this._getOrReturnCtx(e,a),C(a,{validation:"cidr",code:w.invalid_string,message:r.message}),n.dirty()):r.kind==="base64"?vi.test(e.data)||(a=this._getOrReturnCtx(e,a),C(a,{validation:"base64",code:w.invalid_string,message:r.message}),n.dirty()):r.kind==="base64url"?wi.test(e.data)||(a=this._getOrReturnCtx(e,a),C(a,{validation:"base64url",code:w.invalid_string,message:r.message}),n.dirty()):X.assertNever(r);return{status:n.value,value:e.data}}_regex(e,s,n){return this.refinement(a=>e.test(a),{validation:s,code:w.invalid_string,...D.errToObj(n)})}_addCheck(e){return new He({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...D.errToObj(e)})}url(e){return this._addCheck({kind:"url",...D.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...D.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...D.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...D.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...D.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...D.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...D.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...D.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...D.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...D.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...D.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...D.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...D.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...D.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...D.errToObj(e)})}regex(e,s){return this._addCheck({kind:"regex",regex:e,...D.errToObj(s)})}includes(e,s){return this._addCheck({kind:"includes",value:e,position:s==null?void 0:s.position,...D.errToObj(s==null?void 0:s.message)})}startsWith(e,s){return this._addCheck({kind:"startsWith",value:e,...D.errToObj(s)})}endsWith(e,s){return this._addCheck({kind:"endsWith",value:e,...D.errToObj(s)})}min(e,s){return this._addCheck({kind:"min",value:e,...D.errToObj(s)})}max(e,s){return this._addCheck({kind:"max",value:e,...D.errToObj(s)})}length(e,s){return this._addCheck({kind:"length",value:e,...D.errToObj(s)})}nonempty(e){return this.min(1,D.errToObj(e))}trim(){return new He({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new He({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new He({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const s of this._def.checks)s.kind==="min"&&(e===null||s.value>e)&&(e=s.value);return e}get maxLength(){let e=null;for(const s of this._def.checks)s.kind==="max"&&(e===null||s.value<e)&&(e=s.value);return e}}He.create=t=>new He({checks:[],typeName:F.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...H(t)});function Ti(t,e){const s=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,a=s>n?s:n,r=Number.parseInt(t.toFixed(a).replace(".","")),o=Number.parseInt(e.toFixed(a).replace(".",""));return r%o/10**a}class Mt extends Q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==A.number){const r=this._getOrReturnCtx(e);return C(r,{code:w.invalid_type,expected:A.number,received:r.parsedType}),M}let n;const a=new _e;for(const r of this._def.checks)r.kind==="int"?X.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),C(n,{code:w.invalid_type,expected:"integer",received:"float",message:r.message}),a.dirty()):r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(n=this._getOrReturnCtx(e,n),C(n,{code:w.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),a.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(n=this._getOrReturnCtx(e,n),C(n,{code:w.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),a.dirty()):r.kind==="multipleOf"?Ti(e.data,r.value)!==0&&(n=this._getOrReturnCtx(e,n),C(n,{code:w.not_multiple_of,multipleOf:r.value,message:r.message}),a.dirty()):r.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),C(n,{code:w.not_finite,message:r.message}),a.dirty()):X.assertNever(r);return{status:a.value,value:e.data}}gte(e,s){return this.setLimit("min",e,!0,D.toString(s))}gt(e,s){return this.setLimit("min",e,!1,D.toString(s))}lte(e,s){return this.setLimit("max",e,!0,D.toString(s))}lt(e,s){return this.setLimit("max",e,!1,D.toString(s))}setLimit(e,s,n,a){return new Mt({...this._def,checks:[...this._def.checks,{kind:e,value:s,inclusive:n,message:D.toString(a)}]})}_addCheck(e){return new Mt({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:D.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:D.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:D.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:D.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:D.toString(e)})}multipleOf(e,s){return this._addCheck({kind:"multipleOf",value:e,message:D.toString(s)})}finite(e){return this._addCheck({kind:"finite",message:D.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:D.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:D.toString(e)})}get minValue(){let e=null;for(const s of this._def.checks)s.kind==="min"&&(e===null||s.value>e)&&(e=s.value);return e}get maxValue(){let e=null;for(const s of this._def.checks)s.kind==="max"&&(e===null||s.value<e)&&(e=s.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&X.isInteger(e.value))}get isFinite(){let e=null,s=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(s===null||n.value>s)&&(s=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(s)&&Number.isFinite(e)}}Mt.create=t=>new Mt({checks:[],typeName:F.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...H(t)});class Ft extends Q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==A.bigint)return this._getInvalidInput(e);let n;const a=new _e;for(const r of this._def.checks)r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(n=this._getOrReturnCtx(e,n),C(n,{code:w.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),a.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(n=this._getOrReturnCtx(e,n),C(n,{code:w.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),a.dirty()):r.kind==="multipleOf"?e.data%r.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),C(n,{code:w.not_multiple_of,multipleOf:r.value,message:r.message}),a.dirty()):X.assertNever(r);return{status:a.value,value:e.data}}_getInvalidInput(e){const s=this._getOrReturnCtx(e);return C(s,{code:w.invalid_type,expected:A.bigint,received:s.parsedType}),M}gte(e,s){return this.setLimit("min",e,!0,D.toString(s))}gt(e,s){return this.setLimit("min",e,!1,D.toString(s))}lte(e,s){return this.setLimit("max",e,!0,D.toString(s))}lt(e,s){return this.setLimit("max",e,!1,D.toString(s))}setLimit(e,s,n,a){return new Ft({...this._def,checks:[...this._def.checks,{kind:e,value:s,inclusive:n,message:D.toString(a)}]})}_addCheck(e){return new Ft({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:D.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:D.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:D.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:D.toString(e)})}multipleOf(e,s){return this._addCheck({kind:"multipleOf",value:e,message:D.toString(s)})}get minValue(){let e=null;for(const s of this._def.checks)s.kind==="min"&&(e===null||s.value>e)&&(e=s.value);return e}get maxValue(){let e=null;for(const s of this._def.checks)s.kind==="max"&&(e===null||s.value<e)&&(e=s.value);return e}}Ft.create=t=>new Ft({checks:[],typeName:F.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...H(t)});class mn extends Q{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==A.boolean){const n=this._getOrReturnCtx(e);return C(n,{code:w.invalid_type,expected:A.boolean,received:n.parsedType}),M}return ke(e.data)}}mn.create=t=>new mn({typeName:F.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...H(t)});class ts extends Q{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==A.date){const r=this._getOrReturnCtx(e);return C(r,{code:w.invalid_type,expected:A.date,received:r.parsedType}),M}if(Number.isNaN(e.data.getTime())){const r=this._getOrReturnCtx(e);return C(r,{code:w.invalid_date}),M}const n=new _e;let a;for(const r of this._def.checks)r.kind==="min"?e.data.getTime()<r.value&&(a=this._getOrReturnCtx(e,a),C(a,{code:w.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),n.dirty()):r.kind==="max"?e.data.getTime()>r.value&&(a=this._getOrReturnCtx(e,a),C(a,{code:w.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),n.dirty()):X.assertNever(r);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ts({...this._def,checks:[...this._def.checks,e]})}min(e,s){return this._addCheck({kind:"min",value:e.getTime(),message:D.toString(s)})}max(e,s){return this._addCheck({kind:"max",value:e.getTime(),message:D.toString(s)})}get minDate(){let e=null;for(const s of this._def.checks)s.kind==="min"&&(e===null||s.value>e)&&(e=s.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const s of this._def.checks)s.kind==="max"&&(e===null||s.value<e)&&(e=s.value);return e!=null?new Date(e):null}}ts.create=t=>new ts({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:F.ZodDate,...H(t)});class pn extends Q{_parse(e){if(this._getType(e)!==A.symbol){const n=this._getOrReturnCtx(e);return C(n,{code:w.invalid_type,expected:A.symbol,received:n.parsedType}),M}return ke(e.data)}}pn.create=t=>new pn({typeName:F.ZodSymbol,...H(t)});class gn extends Q{_parse(e){if(this._getType(e)!==A.undefined){const n=this._getOrReturnCtx(e);return C(n,{code:w.invalid_type,expected:A.undefined,received:n.parsedType}),M}return ke(e.data)}}gn.create=t=>new gn({typeName:F.ZodUndefined,...H(t)});class xn extends Q{_parse(e){if(this._getType(e)!==A.null){const n=this._getOrReturnCtx(e);return C(n,{code:w.invalid_type,expected:A.null,received:n.parsedType}),M}return ke(e.data)}}xn.create=t=>new xn({typeName:F.ZodNull,...H(t)});class yn extends Q{constructor(){super(...arguments),this._any=!0}_parse(e){return ke(e.data)}}yn.create=t=>new yn({typeName:F.ZodAny,...H(t)});class bn extends Q{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ke(e.data)}}bn.create=t=>new bn({typeName:F.ZodUnknown,...H(t)});class Ge extends Q{_parse(e){const s=this._getOrReturnCtx(e);return C(s,{code:w.invalid_type,expected:A.never,received:s.parsedType}),M}}Ge.create=t=>new Ge({typeName:F.ZodNever,...H(t)});class vn extends Q{_parse(e){if(this._getType(e)!==A.undefined){const n=this._getOrReturnCtx(e);return C(n,{code:w.invalid_type,expected:A.void,received:n.parsedType}),M}return ke(e.data)}}vn.create=t=>new vn({typeName:F.ZodVoid,...H(t)});class Pe extends Q{_parse(e){const{ctx:s,status:n}=this._processInputParams(e),a=this._def;if(s.parsedType!==A.array)return C(s,{code:w.invalid_type,expected:A.array,received:s.parsedType}),M;if(a.exactLength!==null){const o=s.data.length>a.exactLength.value,l=s.data.length<a.exactLength.value;(o||l)&&(C(s,{code:o?w.too_big:w.too_small,minimum:l?a.exactLength.value:void 0,maximum:o?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(a.minLength!==null&&s.data.length<a.minLength.value&&(C(s,{code:w.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&s.data.length>a.maxLength.value&&(C(s,{code:w.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),s.common.async)return Promise.all([...s.data].map((o,l)=>a.type._parseAsync(new Ke(s,o,s.path,l)))).then(o=>_e.mergeArray(n,o));const r=[...s.data].map((o,l)=>a.type._parseSync(new Ke(s,o,s.path,l)));return _e.mergeArray(n,r)}get element(){return this._def.type}min(e,s){return new Pe({...this._def,minLength:{value:e,message:D.toString(s)}})}max(e,s){return new Pe({...this._def,maxLength:{value:e,message:D.toString(s)}})}length(e,s){return new Pe({...this._def,exactLength:{value:e,message:D.toString(s)}})}nonempty(e){return this.min(1,e)}}Pe.create=(t,e)=>new Pe({type:t,minLength:null,maxLength:null,exactLength:null,typeName:F.ZodArray,...H(e)});function ut(t){if(t instanceof de){const e={};for(const s in t.shape){const n=t.shape[s];e[s]=qe.create(ut(n))}return new de({...t._def,shape:()=>e})}else return t instanceof Pe?new Pe({...t._def,type:ut(t.element)}):t instanceof qe?qe.create(ut(t.unwrap())):t instanceof gt?gt.create(ut(t.unwrap())):t instanceof at?at.create(t.items.map(e=>ut(e))):t}class de extends Q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),s=X.objectKeys(e);return this._cached={shape:e,keys:s},this._cached}_parse(e){if(this._getType(e)!==A.object){const c=this._getOrReturnCtx(e);return C(c,{code:w.invalid_type,expected:A.object,received:c.parsedType}),M}const{status:n,ctx:a}=this._processInputParams(e),{shape:r,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof Ge&&this._def.unknownKeys==="strip"))for(const c in a.data)o.includes(c)||l.push(c);const u=[];for(const c of o){const f=r[c],d=a.data[c];u.push({key:{status:"valid",value:c},value:f._parse(new Ke(a,d,a.path,c)),alwaysSet:c in a.data})}if(this._def.catchall instanceof Ge){const c=this._def.unknownKeys;if(c==="passthrough")for(const f of l)u.push({key:{status:"valid",value:f},value:{status:"valid",value:a.data[f]}});else if(c==="strict")l.length>0&&(C(a,{code:w.unrecognized_keys,keys:l}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const f of l){const d=a.data[f];u.push({key:{status:"valid",value:f},value:c._parse(new Ke(a,d,a.path,f)),alwaysSet:f in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const c=[];for(const f of u){const d=await f.key,m=await f.value;c.push({key:d,value:m,alwaysSet:f.alwaysSet})}return c}).then(c=>_e.mergeObjectSync(n,c)):_e.mergeObjectSync(n,u)}get shape(){return this._def.shape()}strict(e){return D.errToObj,new de({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(s,n)=>{var r,o;const a=((o=(r=this._def).errorMap)==null?void 0:o.call(r,s,n).message)??n.defaultError;return s.code==="unrecognized_keys"?{message:D.errToObj(e).message??a}:{message:a}}}:{}})}strip(){return new de({...this._def,unknownKeys:"strip"})}passthrough(){return new de({...this._def,unknownKeys:"passthrough"})}extend(e){return new de({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new de({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:F.ZodObject})}setKey(e,s){return this.augment({[e]:s})}catchall(e){return new de({...this._def,catchall:e})}pick(e){const s={};for(const n of X.objectKeys(e))e[n]&&this.shape[n]&&(s[n]=this.shape[n]);return new de({...this._def,shape:()=>s})}omit(e){const s={};for(const n of X.objectKeys(this.shape))e[n]||(s[n]=this.shape[n]);return new de({...this._def,shape:()=>s})}deepPartial(){return ut(this)}partial(e){const s={};for(const n of X.objectKeys(this.shape)){const a=this.shape[n];e&&!e[n]?s[n]=a:s[n]=a.optional()}return new de({...this._def,shape:()=>s})}required(e){const s={};for(const n of X.objectKeys(this.shape))if(e&&!e[n])s[n]=this.shape[n];else{let r=this.shape[n];for(;r instanceof qe;)r=r._def.innerType;s[n]=r}return new de({...this._def,shape:()=>s})}keyof(){return Kn(X.objectKeys(this.shape))}}de.create=(t,e)=>new de({shape:()=>t,unknownKeys:"strip",catchall:Ge.create(),typeName:F.ZodObject,...H(e)});de.strictCreate=(t,e)=>new de({shape:()=>t,unknownKeys:"strict",catchall:Ge.create(),typeName:F.ZodObject,...H(e)});de.lazycreate=(t,e)=>new de({shape:t,unknownKeys:"strip",catchall:Ge.create(),typeName:F.ZodObject,...H(e)});class ss extends Q{_parse(e){const{ctx:s}=this._processInputParams(e),n=this._def.options;function a(r){for(const l of r)if(l.result.status==="valid")return l.result;for(const l of r)if(l.result.status==="dirty")return s.common.issues.push(...l.ctx.common.issues),l.result;const o=r.map(l=>new Me(l.ctx.common.issues));return C(s,{code:w.invalid_union,unionErrors:o}),M}if(s.common.async)return Promise.all(n.map(async r=>{const o={...s,common:{...s.common,issues:[]},parent:null};return{result:await r._parseAsync({data:s.data,path:s.path,parent:o}),ctx:o}})).then(a);{let r;const o=[];for(const u of n){const c={...s,common:{...s.common,issues:[]},parent:null},f=u._parseSync({data:s.data,path:s.path,parent:c});if(f.status==="valid")return f;f.status==="dirty"&&!r&&(r={result:f,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(r)return s.common.issues.push(...r.ctx.common.issues),r.result;const l=o.map(u=>new Me(u));return C(s,{code:w.invalid_union,unionErrors:l}),M}}get options(){return this._def.options}}ss.create=(t,e)=>new ss({options:t,typeName:F.ZodUnion,...H(e)});function ks(t,e){const s=We(t),n=We(e);if(t===e)return{valid:!0,data:t};if(s===A.object&&n===A.object){const a=X.objectKeys(e),r=X.objectKeys(t).filter(l=>a.indexOf(l)!==-1),o={...t,...e};for(const l of r){const u=ks(t[l],e[l]);if(!u.valid)return{valid:!1};o[l]=u.data}return{valid:!0,data:o}}else if(s===A.array&&n===A.array){if(t.length!==e.length)return{valid:!1};const a=[];for(let r=0;r<t.length;r++){const o=t[r],l=e[r],u=ks(o,l);if(!u.valid)return{valid:!1};a.push(u.data)}return{valid:!0,data:a}}else return s===A.date&&n===A.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class ns extends Q{_parse(e){const{status:s,ctx:n}=this._processInputParams(e),a=(r,o)=>{if(un(r)||un(o))return M;const l=ks(r.value,o.value);return l.valid?((fn(r)||fn(o))&&s.dirty(),{status:s.value,value:l.data}):(C(n,{code:w.invalid_intersection_types}),M)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([r,o])=>a(r,o)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}ns.create=(t,e,s)=>new ns({left:t,right:e,typeName:F.ZodIntersection,...H(s)});class at extends Q{_parse(e){const{status:s,ctx:n}=this._processInputParams(e);if(n.parsedType!==A.array)return C(n,{code:w.invalid_type,expected:A.array,received:n.parsedType}),M;if(n.data.length<this._def.items.length)return C(n,{code:w.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),M;!this._def.rest&&n.data.length>this._def.items.length&&(C(n,{code:w.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),s.dirty());const r=[...n.data].map((o,l)=>{const u=this._def.items[l]||this._def.rest;return u?u._parse(new Ke(n,o,n.path,l)):null}).filter(o=>!!o);return n.common.async?Promise.all(r).then(o=>_e.mergeArray(s,o)):_e.mergeArray(s,r)}get items(){return this._def.items}rest(e){return new at({...this._def,rest:e})}}at.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new at({items:t,typeName:F.ZodTuple,rest:null,...H(e)})};class wn extends Q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:s,ctx:n}=this._processInputParams(e);if(n.parsedType!==A.map)return C(n,{code:w.invalid_type,expected:A.map,received:n.parsedType}),M;const a=this._def.keyType,r=this._def.valueType,o=[...n.data.entries()].map(([l,u],c)=>({key:a._parse(new Ke(n,l,n.path,[c,"key"])),value:r._parse(new Ke(n,u,n.path,[c,"value"]))}));if(n.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const u of o){const c=await u.key,f=await u.value;if(c.status==="aborted"||f.status==="aborted")return M;(c.status==="dirty"||f.status==="dirty")&&s.dirty(),l.set(c.value,f.value)}return{status:s.value,value:l}})}else{const l=new Map;for(const u of o){const c=u.key,f=u.value;if(c.status==="aborted"||f.status==="aborted")return M;(c.status==="dirty"||f.status==="dirty")&&s.dirty(),l.set(c.value,f.value)}return{status:s.value,value:l}}}}wn.create=(t,e,s)=>new wn({valueType:e,keyType:t,typeName:F.ZodMap,...H(s)});class Ut extends Q{_parse(e){const{status:s,ctx:n}=this._processInputParams(e);if(n.parsedType!==A.set)return C(n,{code:w.invalid_type,expected:A.set,received:n.parsedType}),M;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(C(n,{code:w.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),s.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(C(n,{code:w.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),s.dirty());const r=this._def.valueType;function o(u){const c=new Set;for(const f of u){if(f.status==="aborted")return M;f.status==="dirty"&&s.dirty(),c.add(f.value)}return{status:s.value,value:c}}const l=[...n.data.values()].map((u,c)=>r._parse(new Ke(n,u,n.path,c)));return n.common.async?Promise.all(l).then(u=>o(u)):o(l)}min(e,s){return new Ut({...this._def,minSize:{value:e,message:D.toString(s)}})}max(e,s){return new Ut({...this._def,maxSize:{value:e,message:D.toString(s)}})}size(e,s){return this.min(e,s).max(e,s)}nonempty(e){return this.min(1,e)}}Ut.create=(t,e)=>new Ut({valueType:t,minSize:null,maxSize:null,typeName:F.ZodSet,...H(e)});class _n extends Q{get schema(){return this._def.getter()}_parse(e){const{ctx:s}=this._processInputParams(e);return this._def.getter()._parse({data:s.data,path:s.path,parent:s})}}_n.create=(t,e)=>new _n({getter:t,typeName:F.ZodLazy,...H(e)});class Nn extends Q{_parse(e){if(e.data!==this._def.value){const s=this._getOrReturnCtx(e);return C(s,{received:s.data,code:w.invalid_literal,expected:this._def.value}),M}return{status:"valid",value:e.data}}get value(){return this._def.value}}Nn.create=(t,e)=>new Nn({value:t,typeName:F.ZodLiteral,...H(e)});function Kn(t,e){return new mt({values:t,typeName:F.ZodEnum,...H(e)})}class mt extends Q{_parse(e){if(typeof e.data!="string"){const s=this._getOrReturnCtx(e),n=this._def.values;return C(s,{expected:X.joinValues(n),received:s.parsedType,code:w.invalid_type}),M}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const s=this._getOrReturnCtx(e),n=this._def.values;return C(s,{received:s.data,code:w.invalid_enum_value,options:n}),M}return ke(e.data)}get options(){return this._def.values}get enum(){const e={};for(const s of this._def.values)e[s]=s;return e}get Values(){const e={};for(const s of this._def.values)e[s]=s;return e}get Enum(){const e={};for(const s of this._def.values)e[s]=s;return e}extract(e,s=this._def){return mt.create(e,{...this._def,...s})}exclude(e,s=this._def){return mt.create(this.options.filter(n=>!e.includes(n)),{...this._def,...s})}}mt.create=Kn;class jn extends Q{_parse(e){const s=X.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==A.string&&n.parsedType!==A.number){const a=X.objectValues(s);return C(n,{expected:X.joinValues(a),received:n.parsedType,code:w.invalid_type}),M}if(this._cache||(this._cache=new Set(X.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const a=X.objectValues(s);return C(n,{received:n.data,code:w.invalid_enum_value,options:a}),M}return ke(e.data)}get enum(){return this._def.values}}jn.create=(t,e)=>new jn({values:t,typeName:F.ZodNativeEnum,...H(e)});class as extends Q{unwrap(){return this._def.type}_parse(e){const{ctx:s}=this._processInputParams(e);if(s.parsedType!==A.promise&&s.common.async===!1)return C(s,{code:w.invalid_type,expected:A.promise,received:s.parsedType}),M;const n=s.parsedType===A.promise?s.data:Promise.resolve(s.data);return ke(n.then(a=>this._def.type.parseAsync(a,{path:s.path,errorMap:s.common.contextualErrorMap})))}}as.create=(t,e)=>new as({type:t,typeName:F.ZodPromise,...H(e)});class pt extends Q{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===F.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:s,ctx:n}=this._processInputParams(e),a=this._def.effect||null,r={addIssue:o=>{C(n,o),o.fatal?s.abort():s.dirty()},get path(){return n.path}};if(r.addIssue=r.addIssue.bind(r),a.type==="preprocess"){const o=a.transform(n.data,r);if(n.common.async)return Promise.resolve(o).then(async l=>{if(s.value==="aborted")return M;const u=await this._def.schema._parseAsync({data:l,path:n.path,parent:n});return u.status==="aborted"?M:u.status==="dirty"||s.value==="dirty"?At(u.value):u});{if(s.value==="aborted")return M;const l=this._def.schema._parseSync({data:o,path:n.path,parent:n});return l.status==="aborted"?M:l.status==="dirty"||s.value==="dirty"?At(l.value):l}}if(a.type==="refinement"){const o=l=>{const u=a.refinement(l,r);if(n.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return l.status==="aborted"?M:(l.status==="dirty"&&s.dirty(),o(l.value),{status:s.value,value:l.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>l.status==="aborted"?M:(l.status==="dirty"&&s.dirty(),o(l.value).then(()=>({status:s.value,value:l.value}))))}if(a.type==="transform")if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!ht(o))return M;const l=a.transform(o.value,r);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:s.value,value:l}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>ht(o)?Promise.resolve(a.transform(o.value,r)).then(l=>({status:s.value,value:l})):M);X.assertNever(a)}}pt.create=(t,e,s)=>new pt({schema:t,typeName:F.ZodEffects,effect:e,...H(s)});pt.createWithPreprocess=(t,e,s)=>new pt({schema:e,effect:{type:"preprocess",transform:t},typeName:F.ZodEffects,...H(s)});class qe extends Q{_parse(e){return this._getType(e)===A.undefined?ke(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}qe.create=(t,e)=>new qe({innerType:t,typeName:F.ZodOptional,...H(e)});class gt extends Q{_parse(e){return this._getType(e)===A.null?ke(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}gt.create=(t,e)=>new gt({innerType:t,typeName:F.ZodNullable,...H(e)});class Cs extends Q{_parse(e){const{ctx:s}=this._processInputParams(e);let n=s.data;return s.parsedType===A.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:s.path,parent:s})}removeDefault(){return this._def.innerType}}Cs.create=(t,e)=>new Cs({innerType:t,typeName:F.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...H(e)});class Ts extends Q{_parse(e){const{ctx:s}=this._processInputParams(e),n={...s,common:{...s.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return es(a)?a.then(r=>({status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new Me(n.common.issues)},input:n.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Me(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Ts.create=(t,e)=>new Ts({innerType:t,typeName:F.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...H(e)});class Sn extends Q{_parse(e){if(this._getType(e)!==A.nan){const n=this._getOrReturnCtx(e);return C(n,{code:w.invalid_type,expected:A.nan,received:n.parsedType}),M}return{status:"valid",value:e.data}}}Sn.create=t=>new Sn({typeName:F.ZodNaN,...H(t)});class Ei extends Q{_parse(e){const{ctx:s}=this._processInputParams(e),n=s.data;return this._def.type._parse({data:n,path:s.path,parent:s})}unwrap(){return this._def.type}}class Us extends Q{_parse(e){const{status:s,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const r=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return r.status==="aborted"?M:r.status==="dirty"?(s.dirty(),At(r.value)):this._def.out._parseAsync({data:r.value,path:n.path,parent:n})})();{const a=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?M:a.status==="dirty"?(s.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:n.path,parent:n})}}static create(e,s){return new Us({in:e,out:s,typeName:F.ZodPipeline})}}class Es extends Q{_parse(e){const s=this._def.innerType._parse(e),n=a=>(ht(a)&&(a.value=Object.freeze(a.value)),a);return es(s)?s.then(a=>n(a)):n(s)}unwrap(){return this._def.innerType}}Es.create=(t,e)=>new Es({innerType:t,typeName:F.ZodReadonly,...H(e)});var F;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(F||(F={}));const Kt=He.create;Ge.create;Pe.create;const Ii=de.create;ss.create;ns.create;at.create;mt.create;as.create;qe.create;gt.create;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gn="firebasestorage.googleapis.com",Jn="storageBucket",Ri=2*60*1e3,Ai=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce extends Bs{constructor(e,s,n=0){super(gs(e),`Firebase Storage: ${s} (${gs(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ce.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return gs(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var le;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(le||(le={}));function gs(t){return"storage/"+t}function zs(){const t="An unknown error occurred, please check the error payload for server response.";return new ce(le.UNKNOWN,t)}function Oi(t){return new ce(le.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function Di(t){return new ce(le.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function $i(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ce(le.UNAUTHENTICATED,t)}function Pi(){return new ce(le.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Li(t){return new ce(le.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function Bi(){return new ce(le.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Mi(){return new ce(le.CANCELED,"User canceled the upload/download.")}function Fi(t){return new ce(le.INVALID_URL,"Invalid URL '"+t+"'.")}function Ui(t){return new ce(le.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function zi(){return new ce(le.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Jn+"' property when initializing the app?")}function Vi(){return new ce(le.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Wi(){return new ce(le.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Zi(t){return new ce(le.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Is(t){return new ce(le.INVALID_ARGUMENT,t)}function Qn(){return new ce(le.APP_DELETED,"The Firebase app was deleted.")}function Hi(t){return new ce(le.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ot(t,e){return new ce(le.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Tt(t){throw new ce(le.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e,s){this.bucket=e,this.path_=s}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,s){let n;try{n=ve.makeFromUrl(e,s)}catch{return new ve(e,"")}if(n.path==="")return n;throw Ui(e)}static makeFromUrl(e,s){let n=null;const a="([A-Za-z0-9.\\-_]+)";function r(y){y.path.charAt(y.path.length-1)==="/"&&(y.path_=y.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+a+o,"i"),u={bucket:1,path:3};function c(y){y.path_=decodeURIComponent(y.path)}const f="v[A-Za-z0-9_]+",d=s.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",g=new RegExp(`^https?://${d}/${f}/b/${a}/o${m}`,"i"),x={bucket:1,path:3},$=s===Gn?"(?:storage.googleapis.com|storage.cloud.google.com)":s,b="([^?#]*)",S=new RegExp(`^https?://${$}/${a}/${b}`,"i"),O=[{regex:l,indices:u,postModify:r},{regex:g,indices:x,postModify:c},{regex:S,indices:{bucket:1,path:2},postModify:c}];for(let y=0;y<O.length;y++){const k=O[y],v=k.regex.exec(e);if(v){const T=v[k.indices.bucket];let E=v[k.indices.path];E||(E=""),n=new ve(T,E),k.postModify(n);break}}if(n==null)throw Fi(e);return n}}class qi{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ki(t,e,s){let n=1,a=null,r=null,o=!1,l=0;function u(){return l===2}let c=!1;function f(...b){c||(c=!0,e.apply(null,b))}function d(b){a=setTimeout(()=>{a=null,t(g,u())},b)}function m(){r&&clearTimeout(r)}function g(b,...S){if(c){m();return}if(b){m(),f.call(null,b,...S);return}if(u()||o){m(),f.call(null,b,...S);return}n<64&&(n*=2);let O;l===1?(l=2,O=0):O=(n+Math.random())*1e3,d(O)}let x=!1;function $(b){x||(x=!0,m(),!c&&(a!==null?(b||(l=2),clearTimeout(a),d(0)):b||(l=1)))}return d(0),r=setTimeout(()=>{o=!0,$(!0)},s),$}function Gi(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ji(t){return t!==void 0}function Qi(t){return typeof t=="object"&&!Array.isArray(t)}function Vs(t){return typeof t=="string"||t instanceof String}function kn(t){return Ws()&&t instanceof Blob}function Ws(){return typeof Blob<"u"}function Cn(t,e,s,n){if(n<e)throw Is(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>s)throw Is(`Invalid value for '${t}'. Expected ${s} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zs(t,e,s){let n=e;return s==null&&(n=`https://${e}`),`${s}://${n}/v0${t}`}function Yn(t){const e=encodeURIComponent;let s="?";for(const n in t)if(t.hasOwnProperty(n)){const a=e(n)+"="+e(t[n]);s=s+a+"&"}return s=s.slice(0,-1),s}var nt;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(nt||(nt={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yi(t,e){const s=t>=500&&t<600,a=[408,429].indexOf(t)!==-1,r=e.indexOf(t)!==-1;return s||a||r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e,s,n,a,r,o,l,u,c,f,d,m=!0,g=!1){this.url_=e,this.method_=s,this.headers_=n,this.body_=a,this.successCodes_=r,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=c,this.progressCallback_=f,this.connectionFactory_=d,this.retry=m,this.isUsingEmulator=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,$)=>{this.resolve_=x,this.reject_=$,this.start_()})}start_(){const e=(n,a)=>{if(a){n(!1,new Gt(!1,null,!0));return}const r=this.connectionFactory_();this.pendingConnection_=r;const o=l=>{const u=l.loaded,c=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,c)};this.progressCallback_!==null&&r.addUploadProgressListener(o),r.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&r.removeUploadProgressListener(o),this.pendingConnection_=null;const l=r.getErrorCode()===nt.NO_ERROR,u=r.getStatus();if(!l||Yi(u,this.additionalRetryCodes_)&&this.retry){const f=r.getErrorCode()===nt.ABORT;n(!1,new Gt(!1,null,f));return}const c=this.successCodes_.indexOf(u)!==-1;n(!0,new Gt(c,r))})},s=(n,a)=>{const r=this.resolve_,o=this.reject_,l=a.connection;if(a.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());Ji(u)?r(u):r()}catch(u){o(u)}else if(l!==null){const u=zs();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(a.canceled){const u=this.appDelete_?Qn():Mi();o(u)}else{const u=Bi();o(u)}};this.canceled_?s(!1,new Gt(!1,null,!0)):this.backoffId_=Ki(e,s,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Gi(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Gt{constructor(e,s,n){this.wasSuccessCode=e,this.connection=s,this.canceled=!!n}}function eo(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function to(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function so(t,e){e&&(t["X-Firebase-GMPID"]=e)}function no(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function ao(t,e,s,n,a,r,o=!0,l=!1){const u=Yn(t.urlParams),c=t.url+u,f=Object.assign({},t.headers);return so(f,e),eo(f,s),to(f,r),no(f,n),new Xi(c,t.method,f,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,a,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ro(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function io(...t){const e=ro();if(e!==void 0){const s=new e;for(let n=0;n<t.length;n++)s.append(t[n]);return s.getBlob()}else{if(Ws())return new Blob(t);throw new ce(le.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function oo(t,e,s){return t.webkitSlice?t.webkitSlice(e,s):t.mozSlice?t.mozSlice(e,s):t.slice?t.slice(e,s):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lo(t){if(typeof atob>"u")throw Zi("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $e={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class xs{constructor(e,s){this.data=e,this.contentType=s||null}}function co(t,e){switch(t){case $e.RAW:return new xs(Xn(e));case $e.BASE64:case $e.BASE64URL:return new xs(ea(t,e));case $e.DATA_URL:return new xs(fo(e),ho(e))}throw zs()}function Xn(t){const e=[];for(let s=0;s<t.length;s++){let n=t.charCodeAt(s);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(s<t.length-1&&(t.charCodeAt(s+1)&64512)===56320))e.push(239,191,189);else{const r=n,o=t.charCodeAt(++s);n=65536|(r&1023)<<10|o&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function uo(t){let e;try{e=decodeURIComponent(t)}catch{throw Ot($e.DATA_URL,"Malformed data URL.")}return Xn(e)}function ea(t,e){switch(t){case $e.BASE64:{const a=e.indexOf("-")!==-1,r=e.indexOf("_")!==-1;if(a||r)throw Ot(t,"Invalid character '"+(a?"-":"_")+"' found: is it base64url encoded?");break}case $e.BASE64URL:{const a=e.indexOf("+")!==-1,r=e.indexOf("/")!==-1;if(a||r)throw Ot(t,"Invalid character '"+(a?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let s;try{s=lo(e)}catch(a){throw a.message.includes("polyfill")?a:Ot(t,"Invalid character found")}const n=new Uint8Array(s.length);for(let a=0;a<s.length;a++)n[a]=s.charCodeAt(a);return n}class ta{constructor(e){this.base64=!1,this.contentType=null;const s=e.match(/^data:([^,]+)?,/);if(s===null)throw Ot($e.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=s[1]||null;n!=null&&(this.base64=mo(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function fo(t){const e=new ta(t);return e.base64?ea($e.BASE64,e.rest):uo(e.rest)}function ho(t){return new ta(t).contentType}function mo(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e,s){let n=0,a="";kn(e)?(this.data_=e,n=e.size,a=e.type):e instanceof ArrayBuffer?(s?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(s?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=a}size(){return this.size_}type(){return this.type_}slice(e,s){if(kn(this.data_)){const n=this.data_,a=oo(n,e,s);return a===null?null:new Ze(a)}else{const n=new Uint8Array(this.data_.buffer,e,s-e);return new Ze(n,!0)}}static getBlob(...e){if(Ws()){const s=e.map(n=>n instanceof Ze?n.data_:n);return new Ze(io.apply(null,s))}else{const s=e.map(o=>Vs(o)?co($e.RAW,o).data:o.data_);let n=0;s.forEach(o=>{n+=o.byteLength});const a=new Uint8Array(n);let r=0;return s.forEach(o=>{for(let l=0;l<o.length;l++)a[r++]=o[l]}),new Ze(a,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sa(t){let e;try{e=JSON.parse(t)}catch{return null}return Qi(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function po(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function go(t,e){const s=e.split("/").filter(n=>n.length>0).join("/");return t.length===0?s:t+"/"+s}function na(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xo(t,e){return e}class ge{constructor(e,s,n,a){this.server=e,this.local=s||e,this.writable=!!n,this.xform=a||xo}}let Jt=null;function yo(t){return!Vs(t)||t.length<2?t:na(t)}function aa(){if(Jt)return Jt;const t=[];t.push(new ge("bucket")),t.push(new ge("generation")),t.push(new ge("metageneration")),t.push(new ge("name","fullPath",!0));function e(r,o){return yo(o)}const s=new ge("name");s.xform=e,t.push(s);function n(r,o){return o!==void 0?Number(o):o}const a=new ge("size");return a.xform=n,t.push(a),t.push(new ge("timeCreated")),t.push(new ge("updated")),t.push(new ge("md5Hash",null,!0)),t.push(new ge("cacheControl",null,!0)),t.push(new ge("contentDisposition",null,!0)),t.push(new ge("contentEncoding",null,!0)),t.push(new ge("contentLanguage",null,!0)),t.push(new ge("contentType",null,!0)),t.push(new ge("metadata","customMetadata",!0)),Jt=t,Jt}function bo(t,e){function s(){const n=t.bucket,a=t.fullPath,r=new ve(n,a);return e._makeStorageReference(r)}Object.defineProperty(t,"ref",{get:s})}function vo(t,e,s){const n={};n.type="file";const a=s.length;for(let r=0;r<a;r++){const o=s[r];n[o.local]=o.xform(n,e[o.server])}return bo(n,t),n}function ra(t,e,s){const n=sa(e);return n===null?null:vo(t,n,s)}function wo(t,e,s,n){const a=sa(e);if(a===null||!Vs(a.downloadTokens))return null;const r=a.downloadTokens;if(r.length===0)return null;const o=encodeURIComponent;return r.split(",").map(c=>{const f=t.bucket,d=t.fullPath,m="/b/"+o(f)+"/o/"+o(d),g=Zs(m,s,n),x=Yn({alt:"media",token:c});return g+x})[0]}function _o(t,e){const s={},n=e.length;for(let a=0;a<n;a++){const r=e[a];r.writable&&(s[r.server]=t[r.local])}return JSON.stringify(s)}class ia{constructor(e,s,n,a){this.url=e,this.method=s,this.handler=n,this.timeout=a,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oa(t){if(!t)throw zs()}function No(t,e){function s(n,a){const r=ra(t,a,e);return oa(r!==null),r}return s}function jo(t,e){function s(n,a){const r=ra(t,a,e);return oa(r!==null),wo(r,a,t.host,t._protocol)}return s}function la(t){function e(s,n){let a;return s.getStatus()===401?s.getErrorText().includes("Firebase App Check token is invalid")?a=Pi():a=$i():s.getStatus()===402?a=Di(t.bucket):s.getStatus()===403?a=Li(t.path):a=n,a.status=s.getStatus(),a.serverResponse=n.serverResponse,a}return e}function So(t){const e=la(t);function s(n,a){let r=e(n,a);return n.getStatus()===404&&(r=Oi(t.path)),r.serverResponse=a.serverResponse,r}return s}function ko(t,e,s){const n=e.fullServerUrl(),a=Zs(n,t.host,t._protocol),r="GET",o=t.maxOperationRetryTime,l=new ia(a,r,jo(t,s),o);return l.errorHandler=So(e),l}function Co(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function To(t,e,s){const n=Object.assign({},s);return n.fullPath=t.path,n.size=e.size(),n.contentType||(n.contentType=Co(null,e)),n}function Eo(t,e,s,n,a){const r=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let O="";for(let y=0;y<2;y++)O=O+Math.random().toString().slice(2);return O}const u=l();o["Content-Type"]="multipart/related; boundary="+u;const c=To(e,n,a),f=_o(c,s),d="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+f+`\r
--`+u+`\r
Content-Type: `+c.contentType+`\r
\r
`,m=`\r
--`+u+"--",g=Ze.getBlob(d,n,m);if(g===null)throw Vi();const x={name:c.fullPath},$=Zs(r,t.host,t._protocol),b="POST",S=t.maxUploadRetryTime,L=new ia($,b,No(t,s),S);return L.urlParams=x,L.headers=o,L.body=g.uploadData(),L.errorHandler=la(e),L}class Io{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=nt.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=nt.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=nt.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,s,n,a,r){if(this.sent_)throw Tt("cannot .send() more than once");if(Wn(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(s,e,!0),r!==void 0)for(const o in r)r.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,r[o].toString());return a!==void 0?this.xhr_.send(a):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Tt("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Tt("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Tt("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Tt("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Ro extends Io{initXhr(){this.xhr_.responseType="text"}}function ca(){return new Ro}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e,s){this._service=e,s instanceof ve?this._location=s:this._location=ve.makeFromUrl(s,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,s){return new rt(e,s)}get root(){const e=new ve(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return na(this._location.path)}get storage(){return this._service}get parent(){const e=po(this._location.path);if(e===null)return null;const s=new ve(this._location.bucket,e);return new rt(this._service,s)}_throwIfRoot(e){if(this._location.path==="")throw Hi(e)}}function Ao(t,e,s){t._throwIfRoot("uploadBytes");const n=Eo(t.storage,t._location,aa(),new Ze(e,!0),s);return t.storage.makeRequestWithTokens(n,ca).then(a=>({metadata:a,ref:t}))}function Oo(t){t._throwIfRoot("getDownloadURL");const e=ko(t.storage,t._location,aa());return t.storage.makeRequestWithTokens(e,ca).then(s=>{if(s===null)throw Wi();return s})}function Do(t,e){const s=go(t._location.path,e),n=new ve(t._location.bucket,s);return new rt(t.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $o(t){return/^[A-Za-z]+:\/\//.test(t)}function Po(t,e){return new rt(t,e)}function da(t,e){if(t instanceof Hs){const s=t;if(s._bucket==null)throw zi();const n=new rt(s,s._bucket);return e!=null?da(n,e):n}else return e!==void 0?Do(t,e):t}function Lo(t,e){if(e&&$o(e)){if(t instanceof Hs)return Po(t,e);throw Is("To use ref(service, url), the first argument must be a Storage instance.")}else return da(t,e)}function Tn(t,e){const s=e==null?void 0:e[Jn];return s==null?null:ve.makeFromBucketSpec(s,t)}function Bo(t,e,s,n={}){t.host=`${e}:${s}`;const a=Wn(e);a&&(cr(`https://${t.host}/b`),dr("Storage",!0)),t._isUsingEmulator=!0,t._protocol=a?"https":"http";const{mockUserToken:r}=n;r&&(t._overrideAuthToken=typeof r=="string"?r:ur(r,t.app.options.projectId))}class Hs{constructor(e,s,n,a,r,o=!1){this.app=e,this._authProvider=s,this._appCheckProvider=n,this._url=a,this._firebaseVersion=r,this._isUsingEmulator=o,this._bucket=null,this._host=Gn,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Ri,this._maxUploadRetryTime=Ai,this._requests=new Set,a!=null?this._bucket=ve.makeFromBucketSpec(a,this._host):this._bucket=Tn(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ve.makeFromBucketSpec(this._url,e):this._bucket=Tn(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Cn("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Cn("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const s=await e.getToken();if(s!==null)return s.accessToken}return null}async _getAppCheckToken(){if(or(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new rt(this,e)}_makeRequest(e,s,n,a,r=!0){if(this._deleted)return new qi(Qn());{const o=ao(e,this._appId,n,a,s,this._firebaseVersion,r,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,s){const[n,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,s,n,a).getPromise()}}const En="@firebase/storage",In="0.13.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ua="storage";function Mo(t,e,s){return t=xt(t),Ao(t,e,s)}function Fo(t){return t=xt(t),Oo(t)}function Uo(t,e){return t=xt(t),Lo(t,e)}function zo(t=Vn(),e){t=xt(t);const n=zt(t,ua).getImmediate({identifier:e}),a=lr("storage");return a&&Vo(n,...a),n}function Vo(t,e,s,n={}){Bo(t,e,s,n)}function Wo(t,{instanceIdentifier:e}){const s=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),a=t.getProvider("app-check-internal");return new Hs(s,n,a,e,ir)}function Zo(){Lt(new Bt(ua,Wo,"PUBLIC").setMultipleInstances(!0)),ft(En,In,""),ft(En,In,"esm2017")}Zo();const fa="@firebase/installations",qs="0.6.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ha=1e4,ma=`w:${qs}`,pa="FIS_v2",Ho="https://firebaseinstallations.googleapis.com/v1",qo=60*60*1e3,Ko="installations",Go="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jo={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},it=new Zn(Ko,Go,Jo);function ga(t){return t instanceof Bs&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xa({projectId:t}){return`${Ho}/projects/${t}/installations`}function ya(t){return{token:t.token,requestStatus:2,expiresIn:Yo(t.expiresIn),creationTime:Date.now()}}async function ba(t,e){const n=(await e.json()).error;return it.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function va({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function Qo(t,{refreshToken:e}){const s=va(t);return s.append("Authorization",Xo(e)),s}async function wa(t){const e=await t();return e.status>=500&&e.status<600?t():e}function Yo(t){return Number(t.replace("s","000"))}function Xo(t){return`${pa} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function el({appConfig:t,heartbeatServiceProvider:e},{fid:s}){const n=xa(t),a=va(t),r=e.getImmediate({optional:!0});if(r){const c=await r.getHeartbeatsHeader();c&&a.append("x-firebase-client",c)}const o={fid:s,authVersion:pa,appId:t.appId,sdkVersion:ma},l={method:"POST",headers:a,body:JSON.stringify(o)},u=await wa(()=>fetch(n,l));if(u.ok){const c=await u.json();return{fid:c.fid||s,registrationStatus:2,refreshToken:c.refreshToken,authToken:ya(c.authToken)}}else throw await ba("Create Installation",u)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _a(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tl(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sl=/^[cdef][\w-]{21}$/,Rs="";function nl(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const s=al(t);return sl.test(s)?s:Rs}catch{return Rs}}function al(t){return tl(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ls(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Na=new Map;function ja(t,e){const s=ls(t);Sa(s,e),rl(s,e)}function Sa(t,e){const s=Na.get(t);if(s)for(const n of s)n(e)}function rl(t,e){const s=il();s&&s.postMessage({key:t,fid:e}),ol()}let st=null;function il(){return!st&&"BroadcastChannel"in self&&(st=new BroadcastChannel("[Firebase] FID Change"),st.onmessage=t=>{Sa(t.data.key,t.data.fid)}),st}function ol(){Na.size===0&&st&&(st.close(),st=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ll="firebase-installations-database",cl=1,ot="firebase-installations-store";let ys=null;function Ks(){return ys||(ys=fr(ll,cl,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(ot)}}})),ys}async function rs(t,e){const s=ls(t),a=(await Ks()).transaction(ot,"readwrite"),r=a.objectStore(ot),o=await r.get(s);return await r.put(e,s),await a.done,(!o||o.fid!==e.fid)&&ja(t,e.fid),e}async function ka(t){const e=ls(t),n=(await Ks()).transaction(ot,"readwrite");await n.objectStore(ot).delete(e),await n.done}async function cs(t,e){const s=ls(t),a=(await Ks()).transaction(ot,"readwrite"),r=a.objectStore(ot),o=await r.get(s),l=e(o);return l===void 0?await r.delete(s):await r.put(l,s),await a.done,l&&(!o||o.fid!==l.fid)&&ja(t,l.fid),l}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gs(t){let e;const s=await cs(t.appConfig,n=>{const a=dl(n),r=ul(t,a);return e=r.registrationPromise,r.installationEntry});return s.fid===Rs?{installationEntry:await e}:{installationEntry:s,registrationPromise:e}}function dl(t){const e=t||{fid:nl(),registrationStatus:0};return Ca(e)}function ul(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const a=Promise.reject(it.create("app-offline"));return{installationEntry:e,registrationPromise:a}}const s={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=fl(t,s);return{installationEntry:s,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:hl(t)}:{installationEntry:e}}async function fl(t,e){try{const s=await el(t,e);return rs(t.appConfig,s)}catch(s){throw ga(s)&&s.customData.serverCode===409?await ka(t.appConfig):await rs(t.appConfig,{fid:e.fid,registrationStatus:0}),s}}async function hl(t){let e=await Rn(t.appConfig);for(;e.registrationStatus===1;)await _a(100),e=await Rn(t.appConfig);if(e.registrationStatus===0){const{installationEntry:s,registrationPromise:n}=await Gs(t);return n||s}return e}function Rn(t){return cs(t,e=>{if(!e)throw it.create("installation-not-found");return Ca(e)})}function Ca(t){return ml(t)?{fid:t.fid,registrationStatus:0}:t}function ml(t){return t.registrationStatus===1&&t.registrationTime+ha<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pl({appConfig:t,heartbeatServiceProvider:e},s){const n=gl(t,s),a=Qo(t,s),r=e.getImmediate({optional:!0});if(r){const c=await r.getHeartbeatsHeader();c&&a.append("x-firebase-client",c)}const o={installation:{sdkVersion:ma,appId:t.appId}},l={method:"POST",headers:a,body:JSON.stringify(o)},u=await wa(()=>fetch(n,l));if(u.ok){const c=await u.json();return ya(c)}else throw await ba("Generate Auth Token",u)}function gl(t,{fid:e}){return`${xa(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Js(t,e=!1){let s;const n=await cs(t.appConfig,r=>{if(!Ta(r))throw it.create("not-registered");const o=r.authToken;if(!e&&bl(o))return r;if(o.requestStatus===1)return s=xl(t,e),r;{if(!navigator.onLine)throw it.create("app-offline");const l=wl(r);return s=yl(t,l),l}});return s?await s:n.authToken}async function xl(t,e){let s=await An(t.appConfig);for(;s.authToken.requestStatus===1;)await _a(100),s=await An(t.appConfig);const n=s.authToken;return n.requestStatus===0?Js(t,e):n}function An(t){return cs(t,e=>{if(!Ta(e))throw it.create("not-registered");const s=e.authToken;return _l(s)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function yl(t,e){try{const s=await pl(t,e),n=Object.assign(Object.assign({},e),{authToken:s});return await rs(t.appConfig,n),s}catch(s){if(ga(s)&&(s.customData.serverCode===401||s.customData.serverCode===404))await ka(t.appConfig);else{const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await rs(t.appConfig,n)}throw s}}function Ta(t){return t!==void 0&&t.registrationStatus===2}function bl(t){return t.requestStatus===2&&!vl(t)}function vl(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+qo}function wl(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function _l(t){return t.requestStatus===1&&t.requestTime+ha<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nl(t){const e=t,{installationEntry:s,registrationPromise:n}=await Gs(e);return n?n.catch(console.error):Js(e).catch(console.error),s.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jl(t,e=!1){const s=t;return await Sl(s),(await Js(s,e)).token}async function Sl(t){const{registrationPromise:e}=await Gs(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kl(t){if(!t||!t.options)throw bs("App Configuration");if(!t.name)throw bs("App Name");const e=["projectId","apiKey","appId"];for(const s of e)if(!t.options[s])throw bs(s);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function bs(t){return it.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ea="installations",Cl="installations-internal",Tl=t=>{const e=t.getProvider("app").getImmediate(),s=kl(e),n=zt(e,"heartbeat");return{app:e,appConfig:s,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},El=t=>{const e=t.getProvider("app").getImmediate(),s=zt(e,Ea).getImmediate();return{getId:()=>Nl(s),getToken:a=>jl(s,a)}};function Il(){Lt(new Bt(Ea,Tl,"PUBLIC")),Lt(new Bt(Cl,El,"PRIVATE"))}Il();ft(fa,qs);ft(fa,qs,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const is="analytics",Rl="firebase_id",Al="origin",Ol=60*1e3,Dl="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Qs="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ye=new hr("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $l={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},we=new Zn("analytics","Analytics",$l);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pl(t){if(!t.startsWith(Qs)){const e=we.create("invalid-gtag-resource",{gtagURL:t});return ye.warn(e.message),""}return t}function Ia(t){return Promise.all(t.map(e=>e.catch(s=>s)))}function Ll(t,e){let s;return window.trustedTypes&&(s=window.trustedTypes.createPolicy(t,e)),s}function Bl(t,e){const s=Ll("firebase-js-sdk-policy",{createScriptURL:Pl}),n=document.createElement("script"),a=`${Qs}?l=${t}&id=${e}`;n.src=s?s==null?void 0:s.createScriptURL(a):a,n.async=!0,document.head.appendChild(n)}function Ml(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function Fl(t,e,s,n,a,r){const o=n[a];try{if(o)await e[o];else{const u=(await Ia(s)).find(c=>c.measurementId===a);u&&await e[u.appId]}}catch(l){ye.error(l)}t("config",a,r)}async function Ul(t,e,s,n,a){try{let r=[];if(a&&a.send_to){let o=a.send_to;Array.isArray(o)||(o=[o]);const l=await Ia(s);for(const u of o){const c=l.find(d=>d.measurementId===u),f=c&&e[c.appId];if(f)r.push(f);else{r=[];break}}}r.length===0&&(r=Object.values(e)),await Promise.all(r),t("event",n,a||{})}catch(r){ye.error(r)}}function zl(t,e,s,n){async function a(r,...o){try{if(r==="event"){const[l,u]=o;await Ul(t,e,s,l,u)}else if(r==="config"){const[l,u]=o;await Fl(t,e,s,n,l,u)}else if(r==="consent"){const[l,u]=o;t("consent",l,u)}else if(r==="get"){const[l,u,c]=o;t("get",l,u,c)}else if(r==="set"){const[l]=o;t("set",l)}else t(r,...o)}catch(l){ye.error(l)}}return a}function Vl(t,e,s,n,a){let r=function(...o){window[n].push(arguments)};return window[a]&&typeof window[a]=="function"&&(r=window[a]),window[a]=zl(r,t,e,s),{gtagCore:r,wrappedGtag:window[a]}}function Wl(t){const e=window.document.getElementsByTagName("script");for(const s of Object.values(e))if(s.src&&s.src.includes(Qs)&&s.src.includes(t))return s;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zl=30,Hl=1e3;class ql{constructor(e={},s=Hl){this.throttleMetadata=e,this.intervalMillis=s}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,s){this.throttleMetadata[e]=s}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const Ra=new ql;function Kl(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function Gl(t){var e;const{appId:s,apiKey:n}=t,a={method:"GET",headers:Kl(n)},r=Dl.replace("{app-id}",s),o=await fetch(r,a);if(o.status!==200&&o.status!==304){let l="";try{const u=await o.json();!((e=u.error)===null||e===void 0)&&e.message&&(l=u.error.message)}catch{}throw we.create("config-fetch-failed",{httpStatus:o.status,responseMessage:l})}return o.json()}async function Jl(t,e=Ra,s){const{appId:n,apiKey:a,measurementId:r}=t.options;if(!n)throw we.create("no-app-id");if(!a){if(r)return{measurementId:r,appId:n};throw we.create("no-api-key")}const o=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new Xl;return setTimeout(async()=>{l.abort()},Ol),Aa({appId:n,apiKey:a,measurementId:r},o,l,e)}async function Aa(t,{throttleEndTimeMillis:e,backoffCount:s},n,a=Ra){var r;const{appId:o,measurementId:l}=t;try{await Ql(n,e)}catch(u){if(l)return ye.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:o,measurementId:l};throw u}try{const u=await Gl(t);return a.deleteThrottleMetadata(o),u}catch(u){const c=u;if(!Yl(c)){if(a.deleteThrottleMetadata(o),l)return ye.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:l};throw u}const f=Number((r=c==null?void 0:c.customData)===null||r===void 0?void 0:r.httpStatus)===503?an(s,a.intervalMillis,Zl):an(s,a.intervalMillis),d={throttleEndTimeMillis:Date.now()+f,backoffCount:s+1};return a.setThrottleMetadata(o,d),ye.debug(`Calling attemptFetch again in ${f} millis`),Aa(t,d,n,a)}}function Ql(t,e){return new Promise((s,n)=>{const a=Math.max(e-Date.now(),0),r=setTimeout(s,a);t.addEventListener(()=>{clearTimeout(r),n(we.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Yl(t){if(!(t instanceof Bs)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class Xl{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function ec(t,e,s,n,a){if(a&&a.global){t("event",s,n);return}else{const r=await e,o=Object.assign(Object.assign({},n),{send_to:r});t("event",s,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tc(){if(pr())try{await gr()}catch(t){return ye.warn(we.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return ye.warn(we.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function sc(t,e,s,n,a,r,o){var l;const u=Jl(t);u.then(g=>{s[g.measurementId]=g.appId,t.options.measurementId&&g.measurementId!==t.options.measurementId&&ye.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${g.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(g=>ye.error(g)),e.push(u);const c=tc().then(g=>{if(g)return n.getId()}),[f,d]=await Promise.all([u,c]);Wl(r)||Bl(r,f.measurementId),a("js",new Date);const m=(l=o==null?void 0:o.config)!==null&&l!==void 0?l:{};return m[Al]="firebase",m.update=!0,d!=null&&(m[Rl]=d),a("config",f.measurementId,m),f.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e){this.app=e}_delete(){return delete Dt[this.app.options.appId],Promise.resolve()}}let Dt={},On=[];const Dn={};let vs="dataLayer",ac="gtag",$n,Oa,Pn=!1;function rc(){const t=[];if(mr()&&t.push("This is a browser extension environment."),yr()||t.push("Cookies are not available."),t.length>0){const e=t.map((n,a)=>`(${a+1}) ${n}`).join(" "),s=we.create("invalid-analytics-context",{errorInfo:e});ye.warn(s.message)}}function ic(t,e,s){rc();const n=t.options.appId;if(!n)throw we.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)ye.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw we.create("no-api-key");if(Dt[n]!=null)throw we.create("already-exists",{id:n});if(!Pn){Ml(vs);const{wrappedGtag:r,gtagCore:o}=Vl(Dt,On,Dn,vs,ac);Oa=r,$n=o,Pn=!0}return Dt[n]=sc(t,On,Dn,e,$n,vs,s),new nc(t)}function oc(t=Vn()){t=xt(t);const e=zt(t,is);return e.isInitialized()?e.getImmediate():lc(t)}function lc(t,e={}){const s=zt(t,is);if(s.isInitialized()){const a=s.getImmediate();if(xr(e,s.getOptions()))return a;throw we.create("already-initialized")}return s.initialize({options:e})}function cc(t,e,s,n){t=xt(t),ec(Oa,Dt[t.app.options.appId],e,s,n).catch(a=>ye.error(a))}const Ln="@firebase/analytics",Bn="0.10.17";function dc(){Lt(new Bt(is,(e,{options:s})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("installations-internal").getImmediate();return ic(n,a,s)},"PUBLIC")),Lt(new Bt("analytics-internal",t,"PRIVATE")),ft(Ln,Bn),ft(Ln,Bn,"esm2017");function t(e){try{const s=e.getProvider(is).getImmediate();return{logEvent:(n,a,r)=>cc(s,n,a,r)}}catch(s){throw we.create("interop-component-reg-failed",{reason:s})}}}dc();const uc={apiKey:"AIzaSyAgRdBtg_I5NMAC5x3gh-7_CvQ058n25go",authDomain:"jiang-ai-web.firebaseapp.com",projectId:"jiang-ai-web",storageBucket:"jiang-ai-web.firebasestorage.app",messagingSenderId:"923755523160",appId:"1:923755523160:web:043dca5d76b6ded7ecee2d",measurementId:"G-8FXGZWC0M4"},ds=br(uc),Fe=vr(ds),bt=wr(ds),fc=zo(ds);typeof window<"u"&&oc(ds);async function hc(t,e){try{if(t.includes("firebase")&&t.includes("storage")||t==="/icon/icon.jpg"||t.includes("/icon/icon.jpg"))return t;if(t.startsWith("data:"))return console.log("📋 检测到 data URL，跳过上传"),t;console.log("🔄 开始上传图标到 Storage:",t);let s;try{s=await fetch(t)}catch(c){console.warn("⚠️ 直接获取失败，尝试使用CORS代理:",c);const f=`https://cors-anywhere.herokuapp.com/${t}`;s=await fetch(f)}if(!s.ok)throw new Error(`Failed to fetch icon: ${s.status}`);const n=await s.blob(),a=Date.now();let r="png";if(n.type){const c=n.type.toLowerCase();c.includes("svg")?r="svg":c.includes("png")?r="png":c.includes("jpeg")||c.includes("jpg")?r="jpg":c.includes("ico")?r="ico":c.includes("gif")?r="gif":c.includes("webp")&&(r="webp")}const o=`favicons/${e}-${a}.${r}`,l=Uo(fc,o);await Mo(l,n);const u=await Fo(l);return console.log("✅ 图标上传成功:",u),u}catch(s){return console.error("❌ 图标上传失败:",s),t}}const mc=Ii({name:Kt().min(1,"网站名不能为空"),url:Kt().url("请输入有效的网址"),favicon:Kt().url("请输入有效的图标URL"),note:Kt().optional()});function Da({id:t,name:e,url:s,favicon:n,tags:a,note:r,onClose:o,onSave:l,onDelete:u}){const[c,f]=h.useState({name:e,url:s,favicon:n,note:r||""}),[d,m]=h.useState({}),[g,x]=h.useState(!1),[$,b]=h.useState(!1),S=v=>{const T=/\{([^}]+)\}/g;return(v.match(T)||[]).map(se=>se.replace(/\{|\}/g,"").trim())},L=v=>v.replace(/\{[^}]+\}/g,"").trim(),O=async()=>{if(!c.url||!c.url.startsWith("http")){m({url:"请输入有效的网址(以http://或https://开头)"});return}try{x(!0);const v=new URL(c.url).hostname,E=(U=>{try{return new URL(U).hostname.replace(/^www\./,"")}catch{return U.replace(/^(https?:\/\/)?(www\.)?/,"").split("/")[0]}})(c.url);console.log("🧹 清除域名缓存:",E);try{const U="favicon-cache-simple",V=localStorage.getItem(U);if(V){const te=JSON.parse(V);delete te[E],localStorage.setItem(U,JSON.stringify(te))}}catch(U){console.warn("清除缓存失败:",U)}const se=Date.now(),ee=`https://www.google.com/s2/favicons?domain=${c.url}&sz=64&t=${se}`;f(U=>({...U,favicon:ee})),f(U=>({...U,name:v.replace("www.","").split(".")[0]})),m(U=>{const V={...U};return delete V.url,V}),console.log("✅ 自动获取完成，新图标:",ee)}catch(v){console.error("自动获取信息失败:",v),m({url:"无法解析该网址，请检查格式是否正确"})}finally{x(!1)}},y=async v=>{v.preventDefault();try{b(!0);const T=mc.safeParse(c);if(!T.success){const U={};T.error.errors.forEach(V=>{U[V.path[0]]=V.message}),m(U);return}const E=S(c.note||""),se=L(c.note||"");let ee=c.favicon;if(c.favicon!==n){console.log("🔄 图标已变更，开始上传到数据库...");try{ee=await hc(c.favicon,t),console.log("✅ 图标上传完成:",ee)}catch(U){console.warn("⚠️ 图标上传失败，使用原始URL:",U)}}else console.log("📋 图标未变更，跳过上传");if(c.favicon!==n){console.log("🔄 Favicon 已更改，清除缓存");const V=(te=>{try{return new URL(te).hostname.replace(/^www\./,"")}catch{return te.replace(/^(https?:\/\/)?(www\.)?/,"").split("/")[0]}})(c.url);try{const te="favicon-cache-simple",ie=localStorage.getItem(te);if(ie){const ne=JSON.parse(ie);delete ne[V],localStorage.setItem(te,JSON.stringify(ne)),console.log("🧹 已清除域名缓存:",V)}}catch(te){console.warn("清除缓存失败:",te)}}l({id:t,name:c.name,url:c.url,favicon:ee,tags:E,note:se}),o()}catch(T){console.error("保存失败:",T),m({submit:"保存失败，请重试"})}finally{b(!1)}},k=v=>{const{name:T,value:E}=v.target;f(se=>({...se,[T]:E})),d[T]&&m(se=>{const ee={...se};return delete ee[T],ee})};return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 select-none",children:i.jsxs(re.div,{className:"w-full max-w-md bg-white rounded-xl shadow-xl p-6 select-none",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{type:"spring",damping:25},children:[i.jsxs("div",{className:"flex justify-between items-center mb-4 select-none",children:[i.jsx("h2",{className:"text-xl font-semibold select-none",children:"编辑卡片"}),i.jsx("button",{onClick:o,className:"text-gray-500 hover:text-gray-700 select-none",children:i.jsx("i",{className:"fa-solid fa-xmark select-none"})})]}),i.jsxs("form",{onSubmit:y,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1 select-none",children:"网址"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"url",name:"url",value:c.url,onChange:k,className:"flex-1 px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com"}),i.jsx("button",{type:"button",onClick:O,disabled:g||!c.url,className:"px-3 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:bg-blue-300 select-none",children:g?"获取中...":"自动获取"})]}),d.url&&i.jsx("p",{className:"mt-1 text-sm text-red-500 select-none",children:d.url})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1 select-none",children:"网站名"}),i.jsx("input",{type:"text",name:"name",value:c.name,onChange:k,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"网站名称"}),d.name&&i.jsx("p",{className:"mt-1 text-sm text-red-500 select-none",children:d.name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1 select-none",children:"图标"}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"flex-1",children:i.jsx("input",{type:"url",name:"favicon",value:c.favicon,onChange:k,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com/favicon.ico"})}),i.jsx("span",{className:"text-gray-400 select-none",children:"或"}),i.jsxs("label",{className:"cursor-pointer select-none",children:[i.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:v=>{var E;const T=(E=v.target.files)==null?void 0:E[0];if(T){const se=new FileReader;se.onload=ee=>{var U;(U=ee.target)!=null&&U.result&&f(V=>{var te;return{...V,favicon:(te=ee.target)==null?void 0:te.result}})},se.readAsDataURL(T)}}}),i.jsxs("div",{className:"px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-md text-sm text-gray-700 transition-colors select-none",children:[i.jsx("i",{className:"fa-solid fa-upload mr-1 select-none"}),"上传"]})]})]}),c.favicon&&i.jsxs("div",{className:"mt-2 flex items-center select-none",children:[i.jsx("img",{src:c.favicon,alt:"图标预览",className:"w-8 h-8 rounded mr-2 select-none"}),i.jsx("span",{className:"text-xs text-gray-500 truncate max-w-xs select-none",children:c.favicon.startsWith("data:image")?"上传的图标":c.favicon})]}),d.favicon&&i.jsx("p",{className:"mt-1 text-sm text-red-500 select-none",children:d.favicon})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 select-none",children:["备注 (使用","标记标签，如: 备注内容 ","工作"," ","代码",")"]}),i.jsxs("div",{className:"text-xs text-gray-500 mb-1 select-none",children:["花括号","内的内容会被识别为标签"]}),i.jsx("textarea",{name:"note",value:c.note,onChange:k,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"网站用途说明..."})]}),i.jsxs("div",{className:"flex flex-col gap-4 pt-4 select-none",children:[i.jsxs("div",{className:"flex gap-2 select-none",children:[i.jsx("button",{type:"button",onClick:o,className:"flex-1 px-4 py-2 text-gray-700 border rounded-md hover:bg-gray-50 select-none",children:"取消"}),i.jsx("button",{type:"submit",disabled:$,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed select-none",children:$?i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-2"}),"上传中..."]}):"保存"})]}),d.submit&&i.jsx("p",{className:"text-red-500 text-sm text-center select-none",children:d.submit}),u&&i.jsxs("button",{type:"button",onClick:()=>{confirm("确定要删除这个卡片吗？")&&(u(t),o())},className:"w-full px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 shadow-md select-none",children:[i.jsx("i",{className:"fa-solid fa-trash mr-2 select-none"}),"删除卡片"]})]})]})]})})}const pc=[{name:"黑色",rgb:"0, 0, 0",preview:"#000000"},{name:"白色",rgb:"255, 255, 255",preview:"#ffffff"},{name:"红色",rgb:"239, 68, 68",preview:"#ef4444"},{name:"黄色",rgb:"245, 158, 11",preview:"#f59e0b"},{name:"蓝色",rgb:"59, 130, 246",preview:"#3b82f6"},{name:"绿色",rgb:"34, 197, 94",preview:"#22c55e"},{name:"紫色",rgb:"147, 51, 234",preview:"#9333ea"}],$a=h.createContext(void 0);function gc({children:t}){const[e,s]=h.useState(()=>{const b=localStorage.getItem("cardOpacity");let S=b?parseFloat(b):.1;return S>1&&(S=S/100),Math.max(.05,Math.min(1,S))}),[n,a]=h.useState(()=>{const b=localStorage.getItem("searchBarOpacity");let S=b?parseFloat(b):.1;return S>1&&(S=S/100),Math.max(.05,Math.min(1,S))}),[r,o]=h.useState(()=>{const b=localStorage.getItem("parallaxEnabled");return b?JSON.parse(b):!0}),[l,u]=h.useState(()=>localStorage.getItem("cardColor")||"255, 255, 255"),[c,f]=h.useState(()=>localStorage.getItem("searchBarColor")||"255, 255, 255"),d=()=>window.innerHeight>window.innerWidth?"mobile":"1080p",[m,g]=h.useState(()=>localStorage.getItem("wallpaperResolution")||d()),[x,$]=h.useState(!1);return h.useEffect(()=>{localStorage.setItem("cardOpacity",e.toString())},[e]),h.useEffect(()=>{localStorage.setItem("searchBarOpacity",n.toString())},[n]),h.useEffect(()=>{localStorage.setItem("parallaxEnabled",JSON.stringify(r))},[r]),h.useEffect(()=>{localStorage.setItem("wallpaperResolution",m)},[m]),h.useEffect(()=>{localStorage.setItem("cardColor",l)},[l]),h.useEffect(()=>{localStorage.setItem("searchBarColor",c)},[c]),i.jsx($a.Provider,{value:{cardOpacity:e,searchBarOpacity:n,parallaxEnabled:r,wallpaperResolution:m,isSettingsOpen:x,cardColor:l,searchBarColor:c,setCardOpacity:s,setSearchBarOpacity:a,setParallaxEnabled:o,setWallpaperResolution:g,setIsSettingsOpen:$,setCardColor:u,setSearchBarColor:f},children:t})}function vt(){const t=h.useContext($a);if(t===void 0)throw new Error("useTransparency must be used within a TransparencyProvider");return t}class xc{constructor(){oe(this,"cacheKey","favicon-cache-simple");oe(this,"defaultExpiry",7*24*60*60*1e3);oe(this,"cache",{});oe(this,"loadingPromises",new Map);this.loadCache()}loadCache(){try{const e=localStorage.getItem(this.cacheKey);e&&(this.cache=JSON.parse(e),this.cleanExpiredCache())}catch(e){console.warn("加载 favicon 缓存失败:",e),this.cache={}}}saveCache(){try{localStorage.setItem(this.cacheKey,JSON.stringify(this.cache))}catch(e){console.warn("保存 favicon 缓存失败:",e)}}cleanExpiredCache(){const e=Date.now(),s=[];for(const[n,a]of Object.entries(this.cache))e>a.expiry&&s.push(n);s.forEach(n=>{delete this.cache[n]}),s.length>0&&this.saveCache()}extractDomain(e){try{return new URL(e).hostname.replace(/^www\./,"")}catch{return e.replace(/^(https?:\/\/)?(www\.)?/,"").split("/")[0]}}getFaviconUrls(e,s){return[e,`https://www.google.com/s2/favicons?domain=${s}&sz=64`,`https://www.google.com/s2/favicons?domain=${s}&sz=32`,`https://icons.duckduckgo.com/ip3/${s}.ico`,`https://${s}/favicon.ico`,"/icon/icon.jpg"]}async tryLoadFavicon(e){for(const s of e)try{return await new Promise((n,a)=>{const r=new Image;r.onload=()=>n(),r.onerror=()=>a(),r.src=s,setTimeout(()=>a(new Error("超时")),1e3)}),console.log(`✅ Favicon 加载成功: ${s}`),s}catch(n){console.log(`❌ Favicon 加载失败: ${s} (${n})`);continue}return console.log("🔄 所有 favicon 尝试失败，使用默认图标"),"/icon/icon.jpg"}getCachedFavicon(e){const s=this.extractDomain(e),n=this.cache[s];return n&&Date.now()<n.expiry?n.cachedUrl:null}async getFavicon(e,s){const n=this.extractDomain(e),a=this.getCachedFavicon(e);if(a)return console.log(`📁 使用缓存 favicon: ${n} -> ${a}`),a;if(!navigator.onLine)return console.log(`🔌 网络不可用，使用默认图标: ${n}`),"/icon/icon.jpg";if(this.loadingPromises.has(n))return this.loadingPromises.get(n);const r=this.loadFavicon(e,s,n);this.loadingPromises.set(n,r);try{return await r}finally{this.loadingPromises.delete(n)}}async loadFavicon(e,s,n){const a=this.getFaviconUrls(s,n);try{const r=await this.tryLoadFavicon(a);return this.cache[n]={url:e,cachedUrl:r,timestamp:Date.now(),expiry:Date.now()+this.defaultExpiry},this.saveCache(),r}catch(r){return console.warn(`获取 favicon 失败: ${n}`,r),"/icon/icon.jpg"}}async getFaviconWithIndexedDB(e,s){return this.getFavicon(e,s)}async getFaviconWithHybridCache(e,s){return this.getFavicon(e,s)}async batchCacheFaviconsToIndexedDB(e){console.log(`🚀 开始简单批量缓存 ${e.length} 个 favicon`);let s=0,n=0,a=0;const r=2;for(let o=0;o<e.length;o+=r){const u=e.slice(o,o+r).map(async(c,f)=>{const d=this.extractDomain(c.url);try{if(this.getCachedFavicon(c.url)){n++;return}const g=(f+1)*500;await new Promise($=>setTimeout($,g)),console.log(`🔄 [${o+f+1}/${e.length}] 处理: ${d}`),await this.getFavicon(c.url,c.favicon)?(s++,console.log(`✅ 缓存成功: ${d}`)):a++}catch(m){a++,console.warn(`❌ 批量缓存失败: ${d}`,m)}});await Promise.allSettled(u),o+r<e.length&&await new Promise(c=>setTimeout(c,1e3))}console.log("✅ 简单批量 favicon 缓存完成:"),console.log(`   成功: ${s}, 跳过: ${n}, 失败: ${a}`)}clearCache(){this.cache={},this.loadingPromises.clear();try{localStorage.removeItem(this.cacheKey)}catch(e){console.warn("清理 favicon 缓存失败:",e)}}getCacheStats(){const e=Date.now(),s=Object.keys(this.cache).length,n=Object.values(this.cache).filter(r=>e>r.expiry).length;let a="0 KB";try{a=`${(new Blob([JSON.stringify(this.cache)]).size/1024).toFixed(1)} KB`}catch{}return{total:s,expired:n,size:a}}}const As=new xc;function yc(t,e){const[s,n]=h.useState(e),[a,r]=h.useState(!1),[o,l]=h.useState(!1);return h.useEffect(()=>{n(e),l(!1),r(!1);const u=e==="/icon/icon.jpg",c=e.includes("google.com/s2/favicons")&&!e.includes("&t=");if(u||c){const f=As.getCachedFavicon(t);if(f&&f!==e&&f!=="/icon/icon.jpg"){console.log("📦 使用缓存的更好图标:",f),n(f);return}u&&(r(!0),As.getFavicon(t,e).then(d=>{d!==e&&d!=="/icon/icon.jpg"&&(console.log("✅ 获取到更好的图标:",d),n(d)),l(!1)}).catch(d=>{console.warn("Favicon 优化失败:",d),l(!0)}).finally(()=>{r(!1)}))}},[t,e]),{faviconUrl:s,isLoading:a,error:o}}const Qt={mobile:640,tablet:768,desktop:1024,wide:1440},bc={columns:{mobile:2,tablet:3,tabletLandscape:4,desktop:6,wide:8},gaps:{mobile:"gap-x-2 gap-y-6",tablet:"gap-x-3 gap-y-8",desktop:"gap-x-4 gap-y-10"},cardSizes:{mobile:"w-full max-w-[160px]",tablet:"w-full max-w-[180px]",desktop:"w-full max-w-[200px]"}};function Pa(t){const[e,s]=h.useState({width:typeof window<"u"?window.innerWidth:1024,height:typeof window<"u"?window.innerHeight:768}),[n,a]=h.useState("landscape"),[r,o]=h.useState("desktop"),l={...bc,...t};h.useEffect(()=>{const m=()=>{const g=window.innerWidth,x=window.innerHeight;s({width:g,height:x}),a(g>x?"landscape":"portrait"),g<Qt.mobile||g<Qt.tablet?o("mobile"):g<Qt.desktop?o("tablet"):g<Qt.wide?o("desktop"):o("wide")};return m(),window.addEventListener("resize",m),window.addEventListener("orientationchange",m),()=>{window.removeEventListener("resize",m),window.removeEventListener("orientationchange",m)}},[]);const u=()=>{const m=r==="tablet"&&n==="landscape";return{columns:m?l.columns.tabletLandscape:l.columns[r],gap:l.gaps[r==="wide"?"desktop":r],cardSize:l.cardSizes[r==="wide"?"desktop":r],deviceType:r,orientation:n,screenSize:e,isMobile:r==="mobile",isTablet:r==="tablet",isDesktop:r==="desktop"||r==="wide",isTabletLandscape:m}},c=()=>{const m=u(),g="grid";return m.isMobile?`${g} grid-cols-2 ${m.gap} px-2`:m.isTablet?m.isTabletLandscape?`${g} grid-cols-4 ${m.gap} px-4`:`${g} grid-cols-3 ${m.gap} px-4`:`${g} grid-cols-6 lg:grid-cols-8 ${m.gap} px-6`},f=()=>{const m=u(),g="relative group";return m.isMobile?`${g} ${m.cardSize} mx-auto`:m.isTablet?`${g} ${m.cardSize} mx-auto transform transition-transform duration-200 hover:scale-105`:`${g} ${m.cardSize} mx-auto transform transition-all duration-300 hover:scale-110 hover:z-10`},d=()=>{const m=u();return m.isMobile?{containerClass:"px-4 py-4",searchClass:"w-full max-w-lg mx-auto",buttonSize:"text-sm px-3 py-2"}:m.isTablet?{containerClass:"px-6 py-6",searchClass:"w-full max-w-2xl mx-auto",buttonSize:"text-base px-4 py-2"}:{containerClass:"px-8 py-8",searchClass:"w-full max-w-3xl mx-auto",buttonSize:"text-lg px-6 py-3"}};return{...u(),getGridClasses:c,getCardClasses:f,getSearchBarLayout:d}}function vc({id:t,name:e,url:s,favicon:n,tags:a,visitCount:r,note:o,index:l,moveCard:u,onSave:c,onDelete:f}){const[d,m]=h.useState(!1),[g,x]=h.useState(!1),[$,b]=h.useState(!1),S=h.useRef(null),L=h.useRef(null),{cardOpacity:O,cardColor:y}=vt(),{faviconUrl:k,isLoading:v,error:T}=yc(s,n),{isMobile:E,getCardClasses:se}=Pa(),[{isDragging:ee},U]=Qa({type:"WEBSITE_CARD",item:{id:t,index:l},collect:P=>({isDragging:P.isDragging()}),canDrag:()=>!E}),[,V]=Ya({accept:"WEBSITE_CARD",hover(P){if(!S.current)return;const R=P.index,B=l;R!==B&&(u(R,B),P.index=B)}});V(S),U(S);const te=()=>{L.current&&(clearTimeout(L.current),L.current=null)};h.useEffect(()=>()=>{te()},[]);const ie=()=>{!E&&!ee&&x(!0)},ne=()=>{E||x(!1)},I=()=>{E&&(b(!0),setTimeout(()=>b(!1),200)),window.open(s,"_blank"),c({id:t,name:e,url:s,favicon:n,tags:a,note:o,visitCount:r+1,lastVisit:new Date().toISOString().split("T")[0]})},Z=()=>{E&&m(!0)},K=()=>{E&&(L.current=setTimeout(Z,500))},G=()=>{L.current&&(clearTimeout(L.current),L.current=null)};return i.jsxs(i.Fragment,{children:[i.jsxs(re.div,{className:`${se()} relative rounded-lg`,style:{opacity:ee?.5:1,backgroundColor:`rgba(${y}, ${O})`,backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.2)",transform:$&&E?"scale(0.95)":"scale(1)",transition:E?"transform 0.15s ease-in-out":"background-color 0.3s ease, border-color 0.3s ease"},onMouseEnter:ie,onMouseLeave:ne,onTouchStart:K,onTouchEnd:G,onTouchMove:G,onTouchCancel:G,onClick:I,whileTap:E?{scale:.95,transition:{duration:.15,ease:"easeInOut"}}:{},whileHover:E?{}:{scale:1.03,y:-4,transition:{duration:.3,ease:[.4,0,.2,1],type:"spring",stiffness:200,damping:15}},initial:{opacity:0,y:20},whileInView:{opacity:1,y:0,transition:{duration:.6,ease:"easeOut",delay:.1}},viewport:{once:!0},ref:S,children:[i.jsx("div",{className:`absolute ${E?"top-1 right-1":"bottom-0.5 right-0.5"} z-10`,children:i.jsx("button",{onClick:P=>{P.stopPropagation(),m(!0)},className:`p-1 text-white/50 hover:text-white select-none transition-all duration-500 ease-out ${E?"text-xs bg-black/20 rounded-full":""} ${g&&!E?"opacity-100":E?"opacity-70":"opacity-0"}`,children:i.jsx("i",{className:"fa-solid fa-gear text-xs select-none"})})}),i.jsxs("div",{className:`h-full flex flex-col ${E?"pt-2":"pt-3"} select-none`,children:[i.jsxs("div",{className:`flex flex-col items-center ${E?"px-1":"px-2"} select-none`,children:[i.jsxs("div",{className:`${E?"w-8 h-8 mb-1":"w-11 h-11 mb-1"} rounded-md overflow-hidden select-none relative`,children:[i.jsx("img",{src:k,alt:`${e} favicon`,className:"w-full h-full object-contain select-none",loading:"lazy",draggable:"false"}),v&&i.jsx("div",{className:`absolute top-0 right-0 ${E?"w-1.5 h-1.5":"w-2 h-2"} bg-yellow-400 rounded-full animate-pulse`,title:"加载中..."}),!v&&T&&i.jsx("div",{className:`absolute top-0 right-0 ${E?"w-1.5 h-1.5":"w-2 h-2"} bg-red-400 rounded-full`,title:"加载失败"})]}),i.jsx("h3",{className:`${E?"text-[0.65rem]":"text-xs"} font-medium text-white text-center line-clamp-2 px-2 mt-1 select-none`,children:e})]}),!E&&i.jsx("div",{className:"px-2 mb-1 select-none",children:i.jsx("p",{className:"text-white/60 text-[0.65rem] text-center line-clamp-2 select-none",children:o||new URL(s).hostname})}),i.jsx("div",{className:`mt-0 ${E?"px-1 pb-1":"px-3 pb-2"} select-none`,children:i.jsx("div",{className:"flex flex-wrap gap-1 justify-center select-none",children:a.slice(0,E?2:6).map(P=>i.jsx("span",{className:`px-1.5 py-0.5 bg-white/20 rounded-full ${E?"text-[0.55rem]":"text-[0.65rem]"} text-white ${E?"max-w-[45px]":"max-w-[60px]"} truncate select-none`,children:P},P))})}),r>0&&i.jsx("div",{className:"px-2 pb-2 select-none",children:i.jsx("div",{className:"text-center",children:i.jsxs("span",{className:`px-2 py-1 bg-blue-500/20 text-blue-200 rounded-full ${E?"text-[0.55rem]":"text-[0.65rem]"} border border-blue-300/30`,children:[i.jsx("i",{className:"fa-solid fa-eye mr-1"}),r,"次访问"]})})}),i.jsx("div",{className:"flex-1"})]}),!E&&g&&i.jsx(re.div,{className:"absolute inset-0 rounded-lg ring-2 ring-white/30 pointer-events-none",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.4,ease:"easeOut"}}),!E&&g&&i.jsx(re.div,{className:"absolute inset-0 rounded-lg pointer-events-none",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5,ease:"easeOut"},style:{boxShadow:"0 8px 25px rgba(0,0,0,0.2)",zIndex:-1}})]}),d&&i.jsx(Da,{id:t,name:e,url:s,favicon:n,tags:a,note:o,onClose:()=>m(!1),onSave:P=>{c(P),m(!1)},onDelete:f})]})}function wc(t={}){var B,W;const e=h.useRef(null);h.useEffect(()=>{const p=_=>{if(_.code==="Space"||_.key===" "||_.keyCode===32){const N=document.activeElement;!(N&&(N.tagName==="INPUT"||N.tagName==="TEXTAREA"||N.isContentEditable))&&e.current&&(_.preventDefault(),e.current.focus())}};return window.addEventListener("keydown",p,{capture:!0}),()=>window.removeEventListener("keydown",p,{capture:!0})},[]);const[s,n]=h.useState(""),[a,r]=h.useState(!1),[o,l]=h.useState("bing"),[u,c]=h.useState(!1),[f,d]=h.useState([]),[m,g]=h.useState(!1),[x,$]=h.useState(-1),b=h.useRef(null),[S,L]=h.useState(null),[O,y]=h.useState(null),[k,v]=h.useState(!1),T=h.useRef(null),{searchBarOpacity:E,searchBarColor:se}=vt(),ee=[{key:"bing",label:"Bing",icon:i.jsx("i",{className:"fa-brands fa-microsoft text-blue-400"})},{key:"google",label:"Google",icon:i.jsx("i",{className:"fa-brands fa-google text-blue-500"})}],U=(p,_)=>{const N=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FECA57","#FF9FF3","#54A0FF","#5F27CD","#00D2D3","#FF9F43","#EE5A24","#FD79A8","#0FB9B1","#A55EEA","#26D0CE","#FDCB6E","#6C5CE7","#74B9FF","#E17055","#F39C12","#E74C3C","#3498DB","#9B59B6","#1ABC9C"],Y=["M2,5 Q12,2 22,5 Q32,8 42,5 L42,8 Q32,11 22,8 Q12,5 2,8 Z","M20,2 L38,2 L29,12 Z","M20,7 A6,6 0,1,1 20,7.1 Z","M20,2 L30,7 L20,12 L10,7 Z","M20,2 L22,8 L28,8 L23,11 L25,17 L20,14 L15,17 L17,11 L12,8 L18,8 Z","M2,6 Q15,2 28,6 Q41,10 54,6 L54,9 Q41,13 28,9 Q15,5 2,9 Z","M5,5 L10,2 L15,5 L20,2 L25,5 L30,2 L35,5 L35,8 L30,11 L25,8 L20,11 L15,8 L10,11 L5,8 Z","M20,2 Q25,7 20,12 Q15,7 20,2 M20,2 Q25,7 30,2 Q25,7 30,12 Q25,7 20,12","M20,4 C18,2 15,2 15,5 C15,8 20,12 20,12 C20,12 25,8 25,5 C25,2 22,2 20,4 Z","M15,4 Q10,7 15,10 Q20,7 25,10 Q30,7 25,4 Q20,7 15,4","M5,4 Q20,2 35,4 Q40,7 35,10 Q20,8 5,10 Q0,7 5,4","M2,7 Q10,3 18,7 Q26,11 34,7 Q38,5 42,7 L42,10 Q38,8 34,10 Q26,14 18,10 Q10,6 2,10 Z"];for(let ae=0;ae<50;ae++){const J=document.createElementNS("http://www.w3.org/2000/svg","svg"),fe=document.createElementNS("http://www.w3.org/2000/svg","path"),Ae=N[Math.floor(Math.random()*N.length)],wt=Y[Math.floor(Math.random()*Y.length)],ct=Math.random()*.6+.5,_t=44*ct,dt=16*ct;if(J.setAttribute("width",_t.toString()),J.setAttribute("height",dt.toString()),J.setAttribute("viewBox","0 0 44 16"),J.style.cssText=`
        position: fixed;
        pointer-events: none;
        z-index: 10000;
        left: ${p-_t/2}px;
        top: ${_-dt/2}px;
        transform-origin: center;
      `,fe.setAttribute("d",wt),fe.setAttribute("fill",Ae),Math.random()>.5&&(fe.setAttribute("stroke",Ae),fe.setAttribute("stroke-width","1"),fe.setAttribute("fill-opacity","0.8")),Math.random()>.7){const ze=`gradient-${Date.now()}-${ae}`,je=document.createElementNS("http://www.w3.org/2000/svg","defs"),Te=document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),Oe=document.createElementNS("http://www.w3.org/2000/svg","stop"),Ct=document.createElementNS("http://www.w3.org/2000/svg","stop");Te.setAttribute("id",ze),Te.setAttribute("x1","0%"),Te.setAttribute("y1","0%"),Te.setAttribute("x2","100%"),Te.setAttribute("y2","100%"),Oe.setAttribute("offset","0%"),Oe.setAttribute("stop-color",Ae),Ct.setAttribute("offset","100%"),Ct.setAttribute("stop-color",N[Math.floor(Math.random()*N.length)]),Te.appendChild(Oe),Te.appendChild(Ct),je.appendChild(Te),J.appendChild(je),fe.setAttribute("fill",`url(#${ze})`)}J.appendChild(fe),document.body.appendChild(J);const Ue=Math.random()*360*(Math.PI/180),Nt=Math.random()*4+2;let Ne=Math.cos(Ue)*Nt,jt=Math.sin(Ue)*Nt;const us=(Math.random()-.5)*80;let me=Math.random()*360,Le=p-_t/2,St=_-dt/2;const fs=.2,Je=.998,hs=Date.now(),kt=()=>{const ze=(Date.now()-hs)/1e3;jt+=fs,Ne*=Je,jt*=Je,Le+=Ne,St+=jt,me+=us*(1/60),J.style.left=Le+"px",J.style.top=St+"px",J.style.transform=`rotate(${me}deg)`;const je=Math.max(0,1-ze/7);J.style.opacity=je.toString(),je>0&&St<window.innerHeight+100?requestAnimationFrame(kt):document.body.contains(J)&&document.body.removeChild(J)};setTimeout(()=>{requestAnimationFrame(kt)},Math.random()*150)}},V=()=>{const p=ee.findIndex(N=>N.key===o),_=ee[(p+1)%ee.length].key;if(l(_),T.current){const N=T.current.getBoundingClientRect(),Y=N.left+60,q=N.top+N.height/2;U(Y,q)}},te=["chatGPT","Gemini","Deepseek","Kimi"],ie=["https://chatgpt.com/","https://gemini.google.com/","https://chat.deepseek.com/","https://www.kimi.com/"],ne=[i.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:22,height:22,verticalAlign:"middle",position:"relative",top:"1px",userSelect:"none"},children:i.jsx("img",{src:"/jiang_ai_web/icon/chatgpt.svg",alt:"chatGPT",style:{width:20,height:20,display:"block",userSelect:"none"}})}),i.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:22,height:22,verticalAlign:"middle",position:"relative",top:"1px",userSelect:"none"},children:i.jsx("img",{src:"/jiang_ai_web/icon/gemini.svg",alt:"Gemini",style:{width:20,height:20,display:"block",userSelect:"none"}})}),i.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:22,height:22,verticalAlign:"middle",position:"relative",top:"1px",userSelect:"none"},children:i.jsx("img",{src:"/jiang_ai_web/icon/deepseek.svg",alt:"Deepseek",style:{width:20,height:20,display:"block",userSelect:"none"}})}),i.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:22,height:22,verticalAlign:"middle",position:"relative",top:"1px",userSelect:"none"},children:i.jsx("img",{src:"/jiang_ai_web/icon/kimi.svg",alt:"Kimi",style:{width:20,height:20,display:"block",userSelect:"none"}})})],I=(p,_)=>{switch(p){case"google":return`https://www.google.com/search?q=${encodeURIComponent(_)}`;default:return`https://www.bing.com/search?q=${encodeURIComponent(_)}`}},Z=async p=>{if(!p.trim())return[];try{const _=document.createElement("script"),N=`baiduCallback_${Date.now()}`;return new Promise(Y=>{window[N]=q=>{if(q&&q.s&&Array.isArray(q.s)){const ae=q.s.slice(0,5).map((J,fe)=>({id:`baidu-${fe}`,text:J,query:J}));Y(ae)}else{const ae=K(p);Y(ae.slice(0,5).map((J,fe)=>({id:`local-${fe}`,text:J,query:J})))}document.head.removeChild(_),delete window[N]},setTimeout(()=>{if(window[N]){const q=K(p);Y(q.slice(0,5).map((ae,J)=>({id:`local-${J}`,text:ae,query:ae}))),document.head.contains(_)&&document.head.removeChild(_),delete window[N]}},2e3),_.src=`https://suggestion.baidu.com/su?wd=${encodeURIComponent(p)}&cb=${N}`,_.onerror=()=>{const q=K(p);Y(q.slice(0,5).map((ae,J)=>({id:`local-${J}`,text:ae,query:ae}))),document.head.contains(_)&&document.head.removeChild(_),delete window[N]},document.head.appendChild(_)})}catch(_){return console.warn("Failed to fetch Baidu suggestions:",_),K(p).slice(0,5).map((Y,q)=>({id:`local-${q}`,text:Y,query:Y}))}},K=p=>{const _=[],N=p.toLowerCase(),Y=[p,`${p} 是什么`,`${p} 怎么用`,`${p} 教程`,`如何 ${p}`,`${p} 下载`,`${p} 官网`,`${p} 价格`];return N.includes("什么")||N.includes("how")?_.push(`${p}`,`${p} 详解`,`${p} 原理`):N.includes("怎么")||N.includes("如何")?_.push(`${p}`,`${p} 步骤`,`${p} 方法`):_.push(...Y),[...new Set(_)]};h.useEffect(()=>{const p=setTimeout(()=>{s.trim()?Z(s).then(_=>{d(_),g(_.length>0),$(-1)}):(d([]),g(!1),$(-1))},500);return()=>clearTimeout(p)},[s]);const G=(p,_)=>{p.preventDefault();const N=_||(x>=0&&f[x]?f[x].query:s);N.trim()&&(window.open(I(o,N),"_blank"),n(""),g(!1))},P=p=>{switch(p.key){case"ArrowDown":if(!m)return;p.preventDefault(),$(_=>_<f.length-1?_+1:_);break;case"ArrowUp":if(!m)return;p.preventDefault(),$(_=>_>-1?_-1:-1);break;case"Escape":g(!1),$(-1);break;case"Tab":p.shiftKey||(p.preventDefault(),V());break}},R=h.useRef(null);return h.useLayoutEffect(()=>{if(u&&b.current){const p=b.current.getBoundingClientRect();L({left:p.left+p.width/2,top:p.top})}else L(null)},[u,o]),i.jsx("div",{className:"relative left-0 right-0 z-50 flex justify-center px-4 select-none",children:i.jsx(re.div,{className:"w-full flex justify-center",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},children:i.jsx("form",{ref:T,onSubmit:G,className:"relative flex items-center justify-center",onMouseEnter:()=>{R.current&&(clearTimeout(R.current),R.current=null),r(!0)},onMouseLeave:()=>{R.current&&clearTimeout(R.current),R.current=setTimeout(()=>{r(!1),c(!1),setTimeout(()=>{g(!1)},100)},200)},children:i.jsxs(re.div,{animate:{width:a?520:340},initial:{width:340},transition:{type:"tween",duration:.28,ease:"easeInOut"},style:{display:"flex",alignItems:"center",position:"relative"},onAnimationComplete:()=>{a&&c(!0)},children:[i.jsxs("div",{className:"relative flex items-center",children:[i.jsxs("button",{type:"button",className:"flex items-center gap-2 px-1.5 py-1 text-white/80 hover:text-white bg-transparent border-none outline-none text-lg select-none relative z-20",style:{pointerEvents:"auto",height:36,minWidth:36,minHeight:36,justifyContent:"center",alignItems:"center",display:"flex"},tabIndex:-1,onClick:()=>{V()},onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),children:[(B=ee.find(p=>p.key===o))==null?void 0:B.icon,i.jsx("span",{className:"hidden sm:inline text-base font-semibold select-none",children:(W=ee.find(p=>p.key===o))==null?void 0:W.label})]}),k&&i.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800/90 text-white text-sm rounded-lg shadow-lg backdrop-blur-sm border border-white/10 whitespace-nowrap z-30",children:["切换至 ",o==="bing"?"Google":"Bing",i.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-800/90"})]})]}),i.jsx("span",{className:"mx-2 text-white/30 select-none font-normal text-base z-10",children:"|"}),i.jsx("span",{className:"text-white/60 select-none font-normal text-base z-10"}),i.jsx("input",{ref:e,type:"text",value:s,onChange:p=>n(p.target.value),onKeyDown:P,placeholder:"🧸搜点啥捏...",className:"backdrop-blur-md border border-white/20 rounded-full pl-4 py-2 text-white placeholder-white/60 outline-none text-base transition-all duration-200 pr-12 w-full ml-3",style:{backgroundColor:`rgba(${se}, ${E})`,minWidth:"4rem",maxWidth:"100%"}}),i.jsx("button",{ref:b,type:"submit",className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 text-white/70 hover:text-white transition-colors bg-transparent border-none outline-none group select-none",style:{pointerEvents:"auto"},children:i.jsx(re.i,{className:"fa-solid fa-magnifying-glass text-sm",whileHover:{scale:1.22,rotate:18,color:"#fff"},whileTap:{scale:.95,rotate:0},animate:{color:a?"#fff":void 0},transition:{type:"spring",stiffness:350,damping:18},style:{display:"inline-block"}})}),m&&f.length>0&&i.jsx(re.div,{className:"absolute top-full left-0 right-0 mt-2 backdrop-blur-md rounded-lg shadow-lg border border-white/20 z-50 overflow-hidden max-h-60 overflow-y-auto",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.2},style:{pointerEvents:"auto",backgroundColor:"rgba(255, 255, 255, 0.9)"},children:f.map((p,_)=>i.jsx("div",{className:`px-4 py-3 cursor-pointer transition-colors border-b border-white/10 last:border-b-0 select-none ${_===x?"bg-blue-500/20 text-gray-800":"hover:bg-white/50 text-gray-700"}`,onClick:N=>{N.stopPropagation(),n(p.text),G(N,p.query)},onMouseEnter:()=>$(_),onMouseDown:N=>N.preventDefault(),children:i.jsxs("div",{className:"flex items-center gap-3 select-none",children:[i.jsx("i",{className:"fa-solid fa-magnifying-glass text-gray-400 text-sm w-4 select-none"}),i.jsx("div",{className:"flex-1 min-w-0 select-none",children:i.jsx("div",{className:"font-medium text-sm truncate select-none",children:p.text})})]})},p.id))}),a&&u&&S&&i.jsx("div",{className:"fixed z-30",style:{left:S.left,top:S.top,width:0,height:0,pointerEvents:"auto",transform:"translate(-50%, -50%)"},children:i.jsx("div",{style:{position:"absolute",left:0,top:0},children:ne.map((p,_,N)=>{const q=(-60+120/(N.length-1)*_)*(Math.PI/180),ae=44,J=ae*Math.cos(q),fe=ae*Math.sin(q),Ae=19,wt=Ae*3.6;return i.jsxs(re.span,{role:"img","aria-label":te[_],initial:{x:0,y:0,scale:.3,opacity:0,filter:"none"},animate:{x:J,y:fe,scale:1.18,opacity:1,filter:"none"},whileHover:{scale:1.38,filter:"drop-shadow(0 0 4px #fff) drop-shadow(0 0 8px #fff)"},transition:{type:"spring",stiffness:400,damping:22,delay:.08*_},style:{position:"absolute",left:0,top:0,fontSize:22,cursor:"pointer",userSelect:"none",zIndex:2,willChange:"filter, transform"},onClick:()=>window.open(ie[_],"_blank"),onMouseEnter:()=>y(_),onMouseLeave:()=>y(null),children:[p,O===_&&i.jsx("div",{style:{position:"absolute",left:28,top:"50%",transform:"translateY(-50%)",height:Ae,width:wt,background:"rgba(255,255,255,0.98)",color:"#222",borderRadius:Ae/2,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 12px #0003",fontSize:14,fontWeight:500,pointerEvents:"auto",zIndex:10,padding:"0 10px",whiteSpace:"nowrap"},children:i.jsx("span",{style:{userSelect:"none"},children:te[_]})})]},_)})})})]})})})})}function _c(){const[t,e]=h.useState(!1);h.useEffect(()=>{const n=setTimeout(()=>{e(!0)},1e4);return()=>clearTimeout(n)},[]);const s=()=>{window.open("https://github.com/jiangjianghong","_blank")};return t?i.jsx("div",{className:"cat-container",children:i.jsxs("div",{className:"cat",onClick:s,style:{cursor:"pointer"},children:[i.jsx("div",{className:"paw"}),i.jsx("div",{className:"paw"}),i.jsxs("div",{className:"shake",children:[i.jsx("div",{className:"tail"}),i.jsxs("div",{className:"main",children:[i.jsx("div",{className:"head"}),i.jsx("div",{className:"body",children:i.jsx("div",{className:"leg"})}),i.jsxs("div",{className:"face",children:[i.jsxs("div",{className:"mustache_cont",children:[i.jsx("div",{className:"mustache"}),i.jsx("div",{className:"mustache"})]}),i.jsxs("div",{className:"mustache_cont",children:[i.jsx("div",{className:"mustache"}),i.jsx("div",{className:"mustache"})]}),i.jsx("div",{className:"nose"}),i.jsx("div",{className:"eye"}),i.jsx("div",{className:"eye"}),i.jsxs("div",{className:"brow_cont",children:[i.jsx("div",{className:"brow"}),i.jsx("div",{className:"brow"})]}),i.jsxs("div",{className:"brow_cont",children:[i.jsx("div",{className:"brow"}),i.jsx("div",{className:"brow"})]}),i.jsx("div",{className:"ear_l",children:i.jsx("div",{className:"inner"})}),i.jsxs("div",{className:"ear_r",children:[i.jsx("div",{className:"outer"}),i.jsx("div",{className:"inner"})]})]})]})]})]})}):null}const Ye=class Ye{constructor(){oe(this,"isConnected",!0);oe(this,"lastSuccessfulOperation",Date.now());oe(this,"consecutiveFailures",0);oe(this,"listeners",[])}static getInstance(){return Ye.instance||(Ye.instance=new Ye),Ye.instance}recordSuccess(){this.lastSuccessfulOperation=Date.now(),this.consecutiveFailures=0,this.isConnected||(this.isConnected=!0,console.log("🌐 Firebase连接恢复"),this.notifyListeners(!0))}recordFailure(e){this.consecutiveFailures++,this.consecutiveFailures>=3&&!navigator.onLine&&this.isConnected&&(this.isConnected=!1,console.log("🔌 Firebase连接中断"),this.notifyListeners(!1)),console.log(`⚠️ Firebase操作失败 (${this.consecutiveFailures}/3):`,(e==null?void 0:e.message)||e)}isFirebaseConnected(){return navigator.onLine?Date.now()-this.lastSuccessfulOperation<5*60*1e3?!0:this.isConnected:!1}addListener(e){return this.listeners.push(e),e(this.isFirebaseConnected()),()=>{const s=this.listeners.indexOf(e);s>-1&&this.listeners.splice(s,1)}}notifyListeners(e){this.listeners.forEach(s=>{try{s(e)}catch(n){console.warn("Firebase连接状态监听器执行失败:",n)}})}reset(){this.isConnected=!0,this.consecutiveFailures=0,this.lastSuccessfulOperation=Date.now()}};oe(Ye,"instance");let Os=Ye;const $t=Os.getInstance(),lt=()=>navigator.onLine;function Vt(t,e=1e4){return new Promise((s,n)=>{const a=setTimeout(()=>{$t.recordFailure(new Error(`操作超时 (${e}ms)`)),n(new Error(`操作超时 (${e}ms)`))},e);t.then(r=>{clearTimeout(a),$t.recordSuccess(),s(r)}).catch(r=>{clearTimeout(a),$t.recordFailure(r),n(r)})})}const Nc=async(t,e,s=5e3)=>{if(!lt())throw new Error("网络连接不可用，请检查网络设置");return Vt(Cr(Fe,t,e),s)},jc=async(t,e,s=5e3)=>{if(!lt())throw new Error("网络连接不可用，请检查网络设置");return Vt(kr(Fe,t,e),s)},Sc=async(t=5e3)=>{if(!lt())throw new Error("网络连接不可用，请检查网络设置");const e=new jr;return e.setCustomParameters({prompt:"select_account"}),Vt(Sr(Fe,e),t)},Mn=async(t=5e3)=>{if(!lt())throw new Error("网络连接不可用，请检查网络设置");if(!Fe.currentUser)throw new Error("用户未登录");return Vt(Nr(Fe.currentUser),t)},kc=async(t=5e3)=>{if(!lt())throw new Error("网络连接不可用，请检查网络设置");if(!Fe.currentUser)throw new Error("用户未登录");return Vt(_r(Fe.currentUser),t)},Et=t=>{if(!lt())return"网络连接不可用，请检查网络设置后重试";const e=(t==null?void 0:t.code)||(t==null?void 0:t.message)||"";if(e.includes("超时")||e.includes("timeout"))return"网络响应超时，请检查网络连接后重试";switch(e){case"auth/network-request-failed":return"网络请求失败，请检查网络连接";case"auth/timeout":return"连接超时，请稍后重试";case"auth/too-many-requests":return"请求过于频繁，请稍后再试";case"auth/user-not-found":return"用户不存在";case"auth/wrong-password":return"密码错误";case"auth/email-already-in-use":return"邮箱已被使用";case"auth/weak-password":return"密码强度不够";case"auth/invalid-email":return"邮箱格式不正确";case"auth/popup-closed-by-user":return"登录窗口被关闭";case"auth/cancelled-popup-request":return"登录请求被取消";default:return(t==null?void 0:t.message)||"未知错误，请稍后重试"}},Cc=t=>{const e=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",e),window.addEventListener("offline",s),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}},La=h.createContext(void 0);function Ce(){const t=h.useContext(La);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}function Tc({children:t}){const[e,s]=h.useState(null),[n,a]=h.useState(!0),[r,o]=h.useState(lt()),[l,u]=h.useState(!0),[c,f]=h.useState(null),d=()=>f(null),m=async(O,y)=>{try{d(),await Nc(O,y)}catch(k){const v=Et(k);throw f(v),new Error(v)}},g=async(O,y)=>{try{if(d(),(await jc(O,y)).user)try{await Mn()}catch(v){console.warn("发送验证邮件失败:",v)}}catch(k){const v=Et(k);throw f(v),new Error(v)}},x=async()=>{try{d(),e&&!e.emailVerified&&await Mn()}catch(O){const y=Et(O);throw f(y),new Error(y)}},$=async()=>{try{d(),e&&await kc()}catch(O){const y=Et(O);throw f(y),new Error(y)}},b=async()=>{try{d(),await Sc()}catch(O){const y=Et(O);throw f(y),new Error(y)}},S=async()=>{d(),await Er(Fe)};h.useEffect(()=>{const O=setTimeout(()=>{n&&(console.warn("Firebase连接超时，进入离线模式"),a(!1),f("当前处于离线模式，部分功能可能不可用"))},2e3),y=Tr(Fe,k=>{clearTimeout(O),s(k),a(!1),c!=null&&c.includes("离线模式")&&f(null)});return()=>{clearTimeout(O),y()}},[]),h.useEffect(()=>$t.addListener(y=>{u(y),y?c!=null&&c.includes("Firebase")&&f(null):f("Firebase服务暂时不可用，部分功能可能受限")}),[]),h.useEffect(()=>Cc(y=>{o(y),f(y?k=>k!=null&&k.includes("网络")?null:k:"网络连接已断开")}),[]);const L={currentUser:e,login:m,register:g,loginWithGoogle:b,logout:S,sendVerificationEmail:x,reloadUser:$,loading:n,isNetworkOnline:r,isFirebaseConnected:l,error:c};return i.jsx(La.Provider,{value:L,children:t})}const Ba=async(t,e=3,s=1e3)=>{let n;for(let a=0;a<=e;a++)try{return await t()}catch(r){if(n=r,a===e)throw n;const o=s*Math.pow(2,a);console.log(`🔄 同步失败，${o}ms后重试 (${a+1}/${e+1})`),await new Promise(l=>setTimeout(l,o))}throw n},Ec=async(t,e,s)=>{var n,a;try{return(n=s==null?void 0:s.onSyncStart)==null||n.call(s),await Ba(async()=>{const r=yt(bt,"userSettings",t.uid);await Fs(r,{...e,lastSync:Xt()},{merge:!0})}),console.log("用户设置已同步到云端"),(a=s==null?void 0:s.onSyncSuccess)==null||a.call(s,"设置已同步到云端"),!0}catch(r){return console.error("保存用户设置失败:",r),!1}},Ic=async t=>{try{const e=new Promise((a,r)=>setTimeout(()=>r(new Error("连接超时")),5e3)),s=yt(bt,"userSettings",t.uid),n=await Promise.race([Ms(s),e]);if(n.exists()){const a=n.data();return console.log("从云端获取用户设置成功"),a}else return console.log("用户设置不存在，将使用默认设置"),null}catch(e){return console.error("获取用户设置失败:",e),null}},Ds=async(t,e,s)=>{var n,a;try{return(n=s==null?void 0:s.onSyncStart)==null||n.call(s),await Ba(async()=>{const r=yt(bt,"userWebsites",t.uid);await Fs(r,{websites:e,lastSync:Xt()})}),console.log("网站数据已同步到云端"),(a=s==null?void 0:s.onSyncSuccess)==null||a.call(s,"网站数据已同步到云端"),!0}catch(r){return console.error("保存网站数据失败:",r),!1}},Rc=async t=>{try{const e=new Promise((a,r)=>setTimeout(()=>r(new Error("连接超时")),5e3)),s=yt(bt,"userWebsites",t.uid),n=await Promise.race([Ms(s),e]);if(n.exists()){const a=n.data();return console.log("从云端获取网站数据成功"),a.websites}else return console.log("用户网站数据不存在"),null}catch(e){return console.error("获取网站数据失败:",e),null}},Ac=(t,e)=>{const s={};return t.forEach(n=>{s[n.id]={...n}}),e.forEach(n=>{const a=s[n.id];if(!a)s[n.id]={...n};else{const r=new Date(a.lastVisit||"2000-01-01").getTime(),o=new Date(n.lastVisit||"2000-01-01").getTime();let l;o>r?l={...n}:r>o?l={...a}:l=n.visitCount>a.visitCount?{...n}:{...a},l.visitCount=Math.max(a.visitCount||0,n.visitCount||0),l.lastVisit=r>o?a.lastVisit:n.lastVisit,s[n.id]=l}}),Object.values(s)};let ws=null,Re=0;const It=3,$s=(t,e,s,n)=>{ws&&clearTimeout(ws),ws=setTimeout(async()=>{var a,r,o,l;(a=n==null?void 0:n.onSyncStart)==null||a.call(n);try{const c=(await Promise.allSettled([Ds(t,e),Ec(t,s)])).filter(f=>f.status==="rejected");c.length===0?(Re=0,(r=n==null?void 0:n.onSyncSuccess)==null||r.call(n,"数据已静默同步到云端")):Re<It?(Re++,console.log(`🔄 同步部分失败，${Re}/${It} 次重试中...`),setTimeout(()=>{$s(t,e,s,n)},1e3*Math.pow(2,Re-1))):(Re=0,(o=n==null?void 0:n.onSyncError)==null||o.call(n,`${c.length} 个数据同步失败，已重试 ${It} 次`))}catch(u){Re<It?(Re++,console.log(`🔄 同步异常，${Re}/${It} 次重试中...`),setTimeout(()=>{$s(t,e,s,n)},1e3*Math.pow(2,Re-1))):(Re=0,(l=n==null?void 0:n.onSyncError)==null||l.call(n,"同步过程中发生错误: "+u.message))}},5e3)},Fn=async(t,e,s)=>{var n,a;try{(n=s==null?void 0:s.onSyncStart)==null||n.call(s);const r=yt(bt,"userProfiles",t.uid),o={uid:t.uid,email:t.email||"",displayName:e,createdAt:Xt(),updatedAt:Xt()};return await Fs(r,o,{merge:!0}),console.log("用户资料已同步到云端"),(a=s==null?void 0:s.onSyncSuccess)==null||a.call(s,"用户资料已保存"),!0}catch(r){return console.error("保存用户资料失败:",r),!1}},_s=async t=>{try{const e=yt(bt,"userProfiles",t.uid),s=await Ms(e);if(s.exists()){const n=s.data();return console.log("从云端获取用户资料成功"),n}else return console.log("用户资料不存在"),null}catch(e){return console.error("获取用户资料失败:",e),null}},Ma=h.createContext(void 0);function Fa(){const t=h.useContext(Ma);if(t===void 0)throw new Error("useUserProfile must be used within a UserProfileProvider");return t}function Oc({children:t}){const{currentUser:e}=Ce(),[s,n]=h.useState(null),[a,r]=h.useState(!1),o=(s==null?void 0:s.displayName)||"用户",l=async c=>{if(!e||!e.emailVerified)return!1;r(!0);try{return await Fn(e,c)?(n(d=>d?{...d,displayName:c,updatedAt:new Date}:null),setTimeout(async()=>{const d=await _s(e);d&&n(d)},1e3),!0):!1}catch(f){return console.error("更新用户名失败:",f),!1}finally{r(!1)}};h.useEffect(()=>{(async()=>{var f;if(e&&e.emailVerified){r(!0);try{const d=await _s(e);if(d)n(d);else{const m=((f=e.email)==null?void 0:f.split("@")[0])||"用户";await Fn(e,m);const g=await _s(e);n(g)}}catch(d){console.error("加载用户资料失败:",d)}finally{r(!1)}}else n(null)})()},[e]);const u={userProfile:s,displayName:o,updateDisplayName:l,loading:a};return i.jsx(Ma.Provider,{value:u,children:t})}const Un={isOnline:navigator.onLine,lastSyncTime:null,syncInProgress:!1,syncError:null,pendingChanges:0},Ua=h.createContext(void 0);function Ys(){const t=h.useContext(Ua);if(t===void 0)throw new Error("useSyncStatus must be used within a SyncProvider");return t}function Dc({children:t}){const[e,s]=h.useState(Un),n=o=>{s(l=>({...l,...o}))},a=()=>{s(Un)};h.useEffect(()=>{const o=()=>{n({isOnline:!0,syncError:null}),console.log("🌐 网络已连接，同步功能恢复")},l=()=>{n({isOnline:!1,syncError:"网络连接断开，同步功能暂停",syncInProgress:!1}),console.log("📴 网络连接断开，同步功能暂停")};return window.addEventListener("online",o),window.addEventListener("offline",l),n({isOnline:navigator.onLine}),()=>{window.removeEventListener("online",o),window.removeEventListener("offline",l)}},[]);const r={syncStatus:e,updateSyncStatus:n,resetSyncStatus:a};return i.jsx(Ua.Provider,{value:r,children:t})}function $c(t){const{currentUser:e}=Ce(),{updateSyncStatus:s}=Ys(),{cardOpacity:n,searchBarOpacity:a,parallaxEnabled:r,wallpaperResolution:o}=vt(),l=h.useRef(""),u=h.useRef(null),c=h.useRef(null),f=h.useRef(0),d=h.useCallback((m=!1)=>{if(!navigator.onLine){s({syncInProgress:!1,syncError:"网络连接断开，无法同步数据",pendingChanges:1});return}if(!e||!e.emailVerified){e&&!e.emailVerified&&s({syncInProgress:!1,syncError:"请先验证邮箱才能同步数据到云端",pendingChanges:1});return}if((document.querySelector('[role="dialog"]')||document.querySelector(".modal")||document.querySelector("[data-modal]"))&&!m){console.log("🛑 检测到编辑窗口打开，延迟同步"),setTimeout(()=>d(!1),5e3);return}const x={cardOpacity:n,searchBarOpacity:a,parallaxEnabled:r,wallpaperResolution:o,theme:localStorage.getItem("theme")||"light",lastSync:null};console.log(m?"⏰ 强制执行数据同步...":"🚀 开始执行数据同步..."),$s(e,t,x,{onSyncStart:()=>{s({syncInProgress:!0,syncError:null,pendingChanges:0})},onSyncSuccess:$=>{const b=JSON.stringify({websites:t.map(S=>({id:S.id,name:S.name,url:S.url,visitCount:S.visitCount})),settings:{cardOpacity:n,searchBarOpacity:a,parallaxEnabled:r,wallpaperResolution:o,theme:x.theme}});l.current=b,f.current=0,s({syncInProgress:!1,lastSyncTime:new Date,syncError:null,pendingChanges:0}),console.log("✅ 同步成功:",$)},onSyncError:$=>{s({syncInProgress:!1,syncError:$,pendingChanges:1}),console.error("❌ 同步失败:",$)}})},[e,t,n,a,r,o,s]);h.useEffect(()=>{if(JSON.stringify({websites:t.map(S=>({id:S.id,name:S.name,url:S.url,visitCount:S.visitCount})),settings:{cardOpacity:n,searchBarOpacity:a,parallaxEnabled:r,wallpaperResolution:o,theme:localStorage.getItem("theme")||"light"}})===l.current)return;const g=Date.now();f.current===0&&(f.current=g),u.current&&clearTimeout(u.current);const x=g-f.current,$=45e3,b=5e3;if(x>=$){console.log("⏰ 达到最大等待时间，立即强制同步"),c.current&&(clearTimeout(c.current),c.current=null),d(!0);return}if(u.current=setTimeout(()=>{d(!1)},b),!c.current){const S=$-x;console.log(`⏲️ 设置强制同步计时器，${Math.round(S/1e3)}秒后强制同步`),c.current=setTimeout(()=>{console.log("⏰ 强制同步计时器触发"),u.current&&(clearTimeout(u.current),u.current=null),d(!0)},S)}return()=>{u.current&&clearTimeout(u.current)}},[e,t,n,a,r,o,d]),h.useEffect(()=>()=>{u.current&&clearTimeout(u.current),c.current&&clearTimeout(c.current)},[])}function Pc(){const{syncStatus:t}=Ys(),{currentUser:e}=Ce(),[,s]=h.useState(0);if(h.useEffect(()=>{const l=()=>{if(!t.lastSyncTime)return 6e4;const d=Math.floor((new Date().getTime()-t.lastSyncTime.getTime())/1e3);return d<60?1e3:d<3600?6e4:3e5},u=()=>{const f=l();return setTimeout(()=>{s(d=>d+1),u()},f)},c=u();return()=>clearTimeout(c)},[t.lastSyncTime]),!e)return null;const n=l=>{if(!l)return"从未同步";const c=Math.floor((new Date().getTime()-l.getTime())/1e3);return c<60?`${c}秒前`:c<3600?`${Math.floor(c/60)}分钟前`:c<86400?`${Math.floor(c/3600)}小时前`:`${Math.floor(c/86400)}天前`},a=()=>t.syncInProgress?i.jsx("i",{className:"fa-solid fa-sync fa-spin text-blue-500"}):t.syncError?i.jsx("i",{className:"fa-solid fa-exclamation-triangle text-red-500"}):t.isOnline?t.pendingChanges>0?i.jsx("i",{className:"fa-solid fa-clock text-orange-500"}):i.jsx("i",{className:"fa-solid fa-check-circle text-green-500"}):i.jsx("i",{className:"fa-solid fa-wifi-slash text-gray-500"}),r=()=>t.syncInProgress?"同步中...":t.syncError?"同步失败":t.isOnline?t.pendingChanges>0?`${t.pendingChanges} 个更改待同步`:"已同步":"离线模式",o=()=>t.syncError?t.syncError:`上次同步: ${n(t.lastSyncTime)}`;return i.jsx("div",{className:"space-y-2",children:i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[a(),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:r()})]}),i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("div",{className:`w-2 h-2 rounded-full ${t.isOnline?"bg-green-500":"bg-red-500"}`}),i.jsx("span",{className:"text-xs text-gray-500",children:t.isOnline?"在线":"离线"})]})]}),i.jsx("p",{className:"text-xs text-gray-500",children:o()}),i.jsx(Pt,{children:t.syncError&&i.jsx(re.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"bg-red-50 border border-red-200 rounded p-2",children:i.jsxs("p",{className:"text-xs text-red-600",children:[i.jsx("i",{className:"fa-solid fa-info-circle mr-1"}),t.syncError]})})}),i.jsx(Pt,{children:t.syncInProgress&&i.jsx(re.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"w-full bg-gray-200 rounded-full h-1",children:i.jsx(re.div,{className:"bg-blue-500 h-1 rounded-full",initial:{width:"0%"},animate:{width:"100%"},transition:{duration:2,ease:"easeInOut"}})})})]})})}function Lc(){const{syncStatus:t}=Ys(),{currentUser:e}=Ce();if(!e)return null;const s=()=>t.syncInProgress?"同步中...":t.syncError?"同步失败":t.pendingChanges>0?"待同步":"已同步",n=()=>t.syncInProgress?"blue":t.syncError?"red":t.pendingChanges>0?"yellow":"green",a=()=>t.syncInProgress?"处理中...":t.pendingChanges>0?"5秒防抖":"45秒强制",r=n();return i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[i.jsxs("div",{className:`bg-${r}-50 rounded p-2 text-center`,children:[i.jsx("div",{className:`font-medium text-${r}-700`,children:"云端备份"}),i.jsx("div",{className:`text-${r}-600`,children:e.emailVerified?s():"邮箱未验证"})]}),i.jsxs("div",{className:"bg-blue-50 rounded p-2 text-center",children:[i.jsx("div",{className:"font-medium text-blue-700",children:"智能同步"}),i.jsx("div",{className:"text-blue-600",children:a()})]})]})}function Bc({onSuccess:t}){const[e,s]=h.useState(!0),[n,a]=h.useState(""),[r,o]=h.useState(""),[l,u]=h.useState(""),[c,f]=h.useState(!1),[d,m]=h.useState(""),[g,x]=h.useState(!1),[$,b]=h.useState(""),{login:S,register:L,loginWithGoogle:O,sendVerificationEmail:y,error:k,isNetworkOnline:v,isFirebaseConnected:T}=Ce(),E=d||k,se=async V=>{if(V.preventDefault(),!n||!r){m("请填写完整信息");return}if(!e&&!l.trim()){m("请输入用户名");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)){m("请输入有效的邮箱地址");return}if(!e){if(l.length<2||l.length>20){m("用户名长度需在2-20个字符之间");return}if(!/^[a-zA-Z0-9\u4e00-\u9fa5_-]+$/.test(l)){m("用户名只能包含字母、数字、中文、下划线和短横线");return}}f(!0),m("");try{e?(await S(n,r),t()):(await L(n,r),x(!0),b(n),localStorage.setItem("pendingDisplayName",l))}catch(ie){console.error("认证失败:",ie)}finally{f(!1)}},ee=async()=>{f(!0),m("");try{await O(),t()}catch(V){console.error("Google登录失败:",V)}finally{f(!1)}},U=async()=>{try{await y(),alert("验证邮件已重新发送，请检查邮箱")}catch{alert("发送验证邮件失败，请稍后重试")}};return g?i.jsx(re.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:i.jsxs("div",{className:"flex items-start space-x-2",children:[i.jsx("i",{className:"fa-solid fa-envelope-circle-check text-green-600 mt-0.5"}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-green-800",children:"注册成功！请验证您的邮箱"}),i.jsxs("p",{className:"text-sm text-green-700 mt-1",children:["我们已向 ",i.jsx("strong",{children:$})," 发送了验证邮件。 请点击邮件中的链接完成验证后即可使用完整功能。"]}),i.jsxs("div",{className:"mt-3 flex space-x-2",children:[i.jsx("button",{onClick:U,className:"text-xs bg-green-100 hover:bg-green-200 text-green-800 px-2 py-1 rounded",children:"重新发送验证邮件"}),i.jsx("button",{onClick:()=>{x(!1),s(!0),a(""),o(""),u("")},className:"text-xs bg-blue-100 hover:bg-blue-200 text-blue-800 px-2 py-1 rounded",children:"返回登录"})]})]})]})}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:e?"登录账号":"注册账号"}),i.jsx("p",{className:"text-sm text-gray-600",children:e?"使用邮箱登录您的账号":"创建新账号并设置用户名"})]}),E&&i.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:E}),!v&&i.jsxs("div",{className:"mb-4 p-3 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded flex items-center space-x-2",children:[i.jsx("i",{className:"fa-solid fa-wifi-slash"}),i.jsx("span",{children:"网络连接不可用，请检查网络设置"})]}),!T&&v&&i.jsxs("div",{className:"mb-4 p-3 bg-blue-100 border border-blue-400 text-blue-700 rounded flex items-center space-x-2",children:[i.jsx("i",{className:"fa-solid fa-cloud-slash"}),i.jsx("span",{children:"Firebase服务异常，登录功能可能受限"})]}),i.jsxs("form",{onSubmit:se,className:"space-y-4",children:[!e&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"用户名 *"}),i.jsx("input",{type:"text",value:l,onChange:V=>u(V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入用户名（2-20个字符）",disabled:c,maxLength:20}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"支持中文、英文、数字、下划线和短横线"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"邮箱 *"}),i.jsx("input",{type:"email",value:n,onChange:V=>a(V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入邮箱",disabled:c})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"密码 *"}),i.jsx("input",{type:"password",value:r,onChange:V=>o(V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入密码（至少6位）",disabled:c,minLength:6})]}),i.jsx("button",{type:"submit",disabled:c||!v||!T,className:"w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white py-2 px-4 rounded-md transition-colors",children:c?"处理中...":e?"登录":"注册"})]}),i.jsxs("div",{className:"mt-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-0 flex items-center",children:i.jsx("div",{className:"w-full border-t border-gray-300"})}),i.jsx("div",{className:"relative flex justify-center text-sm",children:i.jsx("span",{className:"px-2 bg-white text-gray-500",children:"或"})})]}),i.jsxs("button",{onClick:ee,disabled:c||!v||!T,className:"mt-4 w-full bg-red-500 hover:bg-red-600 disabled:bg-gray-400 text-white py-2 px-4 rounded-md transition-colors flex items-center justify-center",children:[i.jsx("i",{className:"fab fa-google mr-2"}),"使用 Google ",e?"登录":"注册"]})]}),i.jsx("div",{className:"mt-6 text-center",children:i.jsx("button",{onClick:()=>s(!e),className:"text-blue-500 hover:text-blue-600",disabled:c,children:e?"没有账号？点击注册":"已有账号？点击登录"})})]})}function Mc(){const{currentUser:t}=Ce(),{displayName:e,updateDisplayName:s,loading:n}=Fa(),[a,r]=h.useState(!1),[o,l]=h.useState(e),[u,c]=h.useState(!1),[f,d]=h.useState("");if(h.useEffect(()=>{l(e)},[e]),!t||!t.emailVerified)return null;const m=async()=>{if(!o.trim()){d("用户名不能为空");return}if(o.length<2||o.length>20){d("用户名长度需在2-20个字符之间");return}if(!/^[a-zA-Z0-9\u4e00-\u9fa5_-]+$/.test(o)){d("用户名只能包含字母、数字、中文、下划线和短横线");return}c(!0),d("");try{await s(o)?(r(!1),alert("用户名更新成功！")):d("更新失败，请重试")}catch(x){d("更新失败，请重试"),console.error("更新用户名失败:",x)}finally{c(!1)}},g=()=>{l(e),r(!1),d("")};return i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"人类"}),!a&&i.jsxs("button",{onClick:()=>r(!0),className:"text-xs text-blue-500 hover:text-blue-600",disabled:n,children:[i.jsx("i",{className:"fa-solid fa-edit mr-1"}),"编辑"]})]}),a?i.jsxs("div",{className:"space-y-2",children:[i.jsx("input",{type:"text",value:o,onChange:x=>l(x.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"请输入用户名",maxLength:20,disabled:u}),f&&i.jsx("p",{className:"text-xs text-red-600",children:f}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:m,disabled:u||!o.trim(),className:"text-xs bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white px-2 py-1 rounded",children:u?i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-1"}),"保存中..."]}):i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-check mr-1"}),"保存"]})}),i.jsxs("button",{onClick:g,disabled:u,className:"text-xs bg-gray-500 hover:bg-gray-600 text-white px-2 py-1 rounded",children:[i.jsx("i",{className:"fa-solid fa-times mr-1"}),"取消"]})]}),i.jsx("p",{className:"text-xs text-gray-500",children:"支持中文、英文、数字、下划线和短横线，2-20个字符"})]}):i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("i",{className:"fa-solid fa-user text-gray-400"}),i.jsx("span",{className:"text-sm font-medium text-gray-800",children:n?"加载中...":e})]}),i.jsx("div",{className:"border-t border-gray-200 pt-2",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("i",{className:"fa-solid fa-envelope text-gray-400"}),i.jsx("span",{className:"text-xs text-gray-600",children:t.email})]}),i.jsx("i",{className:"fa-solid fa-check-circle text-green-500 text-xs",title:"邮箱已验证"})]})})]})}const Xe=class Xe{static getInstance(){return Xe.instance||(Xe.instance=new Xe),Xe.instance}hasConsent(){try{return localStorage.getItem("cookie-consent")==="accepted"}catch{return!1}}getConsentStatus(){try{const e=localStorage.getItem("cookie-consent");return e==="accepted"?"accepted":e==="declined"?"declined":"pending"}catch{return"pending"}}setItem(e,s,n=!1){try{return n||this.hasConsent()?(localStorage.setItem(e,s),!0):(console.warn(`🚫 存储被阻止: ${e} (用户未同意Cookie使用)`),!1)}catch(a){return console.error("存储失败:",a),!1}}getItem(e,s=!1){try{return s||this.hasConsent()?localStorage.getItem(e):(console.warn(`🚫 读取被阻止: ${e} (用户未同意Cookie使用)`),null)}catch(n){return console.error("读取失败:",n),null}}removeItem(e,s=!1){try{return s||this.hasConsent()?(localStorage.removeItem(e),!0):(console.warn(`🚫 删除被阻止: ${e} (用户未同意Cookie使用)`),!1)}catch(n){return console.error("删除失败:",n),!1}}getAllKeys(e=!0){try{if(!this.hasConsent()&&!e)return[];const s=[],n=["cookie-consent","cookie-consent-date"];for(let a=0;a<localStorage.length;a++){const r=localStorage.key(a);r&&(e||!n.includes(r))&&s.push(r)}return s}catch{return[]}}clearNonEssentialData(){const e=["cookie-consent","cookie-consent-date"];this.getAllKeys(!0).forEach(n=>{if(!e.includes(n))try{localStorage.removeItem(n)}catch(a){console.error(`清除数据失败: ${n}`,a)}}),console.log("🧹 已清除所有非必要数据")}getStorageStats(){const e=this.getAllKeys(!0),s=["cookie-consent","cookie-consent-date"],n=e.filter(r=>!s.includes(r)).length;let a=0;return e.forEach(r=>{try{const o=localStorage.getItem(r)||"";a+=r.length+o.length}catch{}}),{totalKeys:e.length,essentialKeys:s.filter(r=>e.includes(r)).length,nonEssentialKeys:n,consentRequired:!this.hasConsent()&&n>0,storageUsed:`${Math.round(a/1024*100)/100} KB`}}exportData(){if(!this.hasConsent())return console.warn("🚫 数据导出被阻止 (用户未同意Cookie使用)"),null;const e={};return this.getAllKeys(!1).forEach(n=>{try{const a=localStorage.getItem(n);a&&(e[n]=JSON.parse(a))}catch{e[n]=localStorage.getItem(n)}}),{exportTime:new Date().toISOString(),consentStatus:this.getConsentStatus(),data:e}}};oe(Xe,"instance");let os=Xe;const Be=os.getInstance();function za({isOpen:t,onClose:e}){const[s,n]=h.useState(Be.getStorageStats()),[a,r]=h.useState(Be.getConsentStatus());h.useEffect(()=>{t&&(n(Be.getStorageStats()),r(Be.getConsentStatus()))},[t]);const o=()=>{const c=a==="accepted"?"declined":"accepted";c==="accepted"?(localStorage.setItem("cookie-consent","accepted"),localStorage.setItem("cookie-consent-date",new Date().toISOString())):(localStorage.setItem("cookie-consent","declined"),localStorage.setItem("cookie-consent-date",new Date().toISOString()),Be.clearNonEssentialData()),r(c),n(Be.getStorageStats())},l=()=>{confirm(`⚠️ 确认清除所有数据？

这将删除您的所有网站收藏、设置和偏好。
此操作不可撤销！`)&&(Be.clearNonEssentialData(),n(Be.getStorageStats()),alert("✅ 所有非必要数据已清除"))},u=()=>{const c=Be.exportData();if(!c){alert("❌ 需要同意Cookie使用才能导出数据");return}const f=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),d=URL.createObjectURL(f),m=document.createElement("a");m.href=d,m.download=`我的数据导出_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(d),alert("✅ 数据导出成功！")};return t?i.jsx(Pt,{children:i.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),i.jsxs(re.div,{className:"w-full max-w-2xl bg-white rounded-xl shadow-2xl z-50 max-h-[90vh] flex flex-col mx-4",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",damping:20,stiffness:300},children:[i.jsx("div",{className:"p-6 pb-0",children:i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("i",{className:"fa-solid fa-shield-halved text-blue-600 text-2xl"}),i.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"隐私与数据管理"})]}),i.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 text-xl",children:i.jsx("i",{className:"fa-solid fa-xmark"})})]})}),i.jsxs("div",{className:"flex-1 px-6 py-4 space-y-6 overflow-y-auto",children:[i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[i.jsx("i",{className:"fa-solid fa-cookie-bite text-amber-500"}),"Cookie使用状态"]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm text-gray-600",children:["当前状态:",i.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs font-medium ${a==="accepted"?"bg-green-100 text-green-800":a==="declined"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:a==="accepted"?"✅ 已同意":a==="declined"?"❌ 已拒绝":"⏳ 待决定"})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a==="accepted"?"您已同意使用Cookie和本地存储来提供完整功能":a==="declined"?"您已拒绝非必要Cookie，部分功能可能受限":"等待您的选择"})]}),a!=="pending"&&i.jsx("button",{onClick:o,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${a==="accepted"?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:a==="accepted"?"撤销同意":"重新同意"})]})]}),i.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[i.jsx("i",{className:"fa-solid fa-chart-pie text-blue-600"}),"数据使用统计"]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s.totalKeys}),i.jsx("div",{className:"text-xs text-gray-600",children:"总数据项"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.essentialKeys}),i.jsx("div",{className:"text-xs text-gray-600",children:"必要数据"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-purple-600",children:s.nonEssentialKeys}),i.jsx("div",{className:"text-xs text-gray-600",children:"功能数据"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-orange-600",children:s.storageUsed}),i.jsx("div",{className:"text-xs text-gray-600",children:"存储占用"})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[i.jsx("i",{className:"fa-solid fa-info-circle text-blue-600"}),"我们存储的数据类型"]}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[i.jsx("i",{className:"fa-solid fa-shield-check text-green-600 mt-0.5"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-green-800",children:"必要功能数据"}),i.jsx("div",{className:"text-green-700",children:"Cookie同意状态、基本设置 - 网站正常运行必需"})]})]}),i.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg",children:[i.jsx("i",{className:"fa-solid fa-bookmark text-blue-600 mt-0.5"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-blue-800",children:"收藏夹数据"}),i.jsx("div",{className:"text-blue-700",children:"您添加的网站收藏、访问记录、个人笔记"})]})]}),i.jsxs("div",{className:"flex items-start gap-3 p-3 bg-purple-50 rounded-lg",children:[i.jsx("i",{className:"fa-solid fa-palette text-purple-600 mt-0.5"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-purple-800",children:"界面偏好"}),i.jsx("div",{className:"text-purple-700",children:"主题设置、透明度、布局偏好等个性化配置"})]})]}),i.jsxs("div",{className:"flex items-start gap-3 p-3 bg-orange-50 rounded-lg",children:[i.jsx("i",{className:"fa-solid fa-chart-line text-orange-600 mt-0.5"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-orange-800",children:"性能分析"}),i.jsx("div",{className:"text-orange-700",children:"加载时间、使用统计，帮助改善用户体验"})]})]})]})]}),i.jsxs("div",{className:"border-t pt-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[i.jsx("i",{className:"fa-solid fa-wrench text-gray-600"}),"数据管理操作"]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:u,disabled:a!=="accepted",className:"w-full p-3 bg-blue-100 hover:bg-blue-200 disabled:bg-gray-100 disabled:text-gray-400 text-blue-800 rounded-lg transition-colors text-left",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("i",{className:"fa-solid fa-download"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:"导出我的数据"}),i.jsx("div",{className:"text-sm opacity-75",children:"下载包含所有个人数据的JSON文件"})]})]})}),i.jsx("button",{onClick:l,className:"w-full p-3 bg-red-100 hover:bg-red-200 text-red-800 rounded-lg transition-colors text-left",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("i",{className:"fa-solid fa-trash"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:"清除所有数据"}),i.jsx("div",{className:"text-sm opacity-75",children:"删除所有非必要的本地存储数据"})]})]})})]}),i.jsxs("div",{className:"mt-6",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[i.jsx("i",{className:"fa-solid fa-book-open text-blue-500"}),"使用教程"]}),i.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"详细了解本主页的全部功能与技巧。"}),i.jsxs("a",{href:"/tutorial.html",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium shadow transition-colors",children:[i.jsx("i",{className:"fa-solid fa-graduation-cap"}),"打开使用教程"]})]})]})]}),i.jsx("div",{className:"p-6 pt-0 border-t",children:i.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500",children:[i.jsxs("span",{children:["最后更新: ",new Date().toLocaleDateString("zh-CN")]}),i.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg",children:"关闭"})]})})]})]})}):null}function Fc({isOpen:t,onClose:e,onConfirm:s,title:n,message:a,confirmText:r="确定",cancelText:o="取消",type:l="warning"}){const c=(()=>{switch(l){case"danger":return{icon:"fa-solid fa-triangle-exclamation text-red-500",confirmButton:"bg-red-500 hover:bg-red-600 text-white",borderColor:"border-red-200"};case"warning":return{icon:"fa-solid fa-exclamation-triangle text-orange-500",confirmButton:"bg-orange-500 hover:bg-orange-600 text-white",borderColor:"border-orange-200"};case"info":return{icon:"fa-solid fa-info-circle text-blue-500",confirmButton:"bg-blue-500 hover:bg-blue-600 text-white",borderColor:"border-blue-200"}}})(),f=()=>{s(),e()};return i.jsx(Pt,{children:t&&i.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center",children:[i.jsx(re.div,{className:"absolute inset-0 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),i.jsx(re.div,{className:`relative bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 border-2 ${c.borderColor}`,initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",damping:20,stiffness:300},children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("i",{className:`${c.icon} text-2xl`})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:n}),i.jsx("div",{className:"text-sm text-gray-600 whitespace-pre-line",children:a})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[i.jsx("button",{onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:o}),i.jsx("button",{onClick:f,className:`px-4 py-2 rounded-lg transition-colors ${c.confirmButton}`,children:r})]})]})})]})})}function zn({label:t,selectedColor:e,onChange:s}){return i.jsxs("div",{className:"space-y-3 select-none",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 select-none",children:t}),i.jsx("div",{className:"flex gap-2 flex-wrap",children:pc.map(n=>i.jsx(re.button,{type:"button",onClick:()=>s(n.rgb),className:`w-8 h-8 rounded-lg border-2 transition-all duration-200 hover:scale-110 ${e===n.rgb?"border-blue-500 shadow-lg":"border-gray-300 hover:border-gray-400"}`,style:{backgroundColor:n.preview},title:n.name,whileHover:{scale:1.1},whileTap:{scale:.95},children:e===n.rgb&&i.jsx(re.div,{className:"w-full h-full flex items-center justify-center",initial:{scale:0},animate:{scale:1},transition:{duration:.2},children:i.jsx("i",{className:`fa-solid fa-check text-sm ${n.name==="白色"||n.name==="黄色"?"text-gray-700":"text-white"}`})})},n.name))})]})}const Uc=[{id:"1",name:"GitHub",url:"https://github.com",favicon:"https://github.githubassets.com/favicons/favicon.png",tags:["开发","代码"],visitCount:42,lastVisit:"2023-05-15",note:"看代码的平台"},{id:"2",name:"Dribbble",url:"https://dribbble.com",favicon:"https://cdn.dribbble.com/assets/favicon-b38525134603b9513174e916967b4baaaaaa5ee0297c4f53d6fb3ab8ad26c3a4.ico",tags:["设计","灵感"],visitCount:28,lastVisit:"2023-05-10",note:"设计灵感来源"},{id:"3",name:"Medium",url:"https://medium.com",favicon:"https://miro.medium.com/v2/resize:fill:32:32/1*sHhtYhaCe2Uc3IU0IgKwIQ.png",tags:["文章","学习"],visitCount:15,lastVisit:"2023-05-05",note:"阅读技术文章"}];function Va(t={}){const{enableAutoSync:e=!0,syncDelay:s=100}=t,n=os.getInstance(),[a,r]=h.useState(!0),[o,l]=h.useState(null),[u,c]=h.useState(!0),f=h.useCallback(()=>{try{const y=n.getItem("websites");if(y){const k=JSON.parse(y);if(Array.isArray(k)&&k.length>0){const v=k.filter(T=>T.id&&T.name&&T.url);if(v.length>0)return v}}}catch(y){console.warn("读取缓存失败:",y),l("读取本地数据失败")}return Uc},[n]),[d,m]=h.useState(()=>{const y=f();return r(!1),y}),g=h.useCallback(y=>{try{n.setItem("websites",JSON.stringify(y))||console.warn("保存到缓存失败：用户未同意Cookie使用")}catch(k){console.error("保存到缓存失败:",k),l("保存数据失败")}},[n]);h.useEffect(()=>{if(!e||!u)return;const y=setTimeout(()=>{const k=f();(k.length!==d.length||JSON.stringify(k.map(v=>v.id).sort())!==JSON.stringify(d.map(v=>v.id).sort()))&&(console.log("🔄 延迟检查发现不同的缓存数据，更新显示"),m(k)),c(!1)},s);return()=>clearTimeout(y)},[e,s,u,f,d]),h.useEffect(()=>{!u&&e&&g(d)},[d,g,e,u]);const x=h.useCallback(y=>{l(null),m(y)},[]),$=h.useCallback(y=>{const k={...y,visitCount:0,lastVisit:new Date().toISOString().split("T")[0]};x(v=>[...v,k])},[x]),b=h.useCallback((y,k)=>{x(v=>v.map(T=>T.id===y?{...T,...k}:T))},[x]),S=h.useCallback(y=>{x(k=>k.filter(v=>v.id!==y))},[x]),L=h.useCallback(async()=>{try{const y={websites:d,settings:{cardOpacity:parseFloat(localStorage.getItem("cardOpacity")||"0.1"),searchBarOpacity:parseFloat(localStorage.getItem("searchBarOpacity")||"0.1"),parallaxEnabled:JSON.parse(localStorage.getItem("parallaxEnabled")||"true"),wallpaperResolution:localStorage.getItem("wallpaperResolution")||"1080p",theme:localStorage.getItem("theme")||"light"},exportTime:new Date().toISOString(),version:"1.0"};return JSON.stringify(y,null,2)}catch(y){throw new Error(`导出失败: ${y instanceof Error?y.message:"未知错误"}`)}},[d]),O=h.useCallback(async y=>{try{if(!y.websites||!Array.isArray(y.websites))return{success:!1,message:"无效的数据格式：缺少网站数据"};const k=y.websites.filter(v=>v.id&&v.name&&v.url&&typeof v.id=="string"&&typeof v.name=="string"&&typeof v.url=="string").map(v=>({...v,visitCount:typeof v.visitCount=="number"?v.visitCount:0,lastVisit:v.lastVisit||new Date().toISOString().split("T")[0],tags:Array.isArray(v.tags)?v.tags:[],note:v.note||""}));return k.length===0?{success:!1,message:"导入文件中没有有效的网站数据"}:(x(k),{success:!0,message:`成功导入 ${k.length} 个网站`,validCount:k.length})}catch(k){return{success:!1,message:`导入失败: ${k instanceof Error?k.message:"未知错误"}`}}},[x]);return{websites:d,setWebsites:x,addWebsite:$,updateWebsite:b,deleteWebsite:S,exportData:L,importData:O,isLoading:a,error:o}}function zc(){const t=h.useCallback(()=>{try{return{cardOpacity:parseFloat(localStorage.getItem("cardOpacity")||"0.1"),searchBarOpacity:parseFloat(localStorage.getItem("searchBarOpacity")||"0.1"),parallaxEnabled:JSON.parse(localStorage.getItem("parallaxEnabled")||"true"),wallpaperResolution:localStorage.getItem("wallpaperResolution")||"1080p",theme:localStorage.getItem("theme")||"light"}}catch(n){return console.warn("导出设置失败，使用默认值:",n),{cardOpacity:.1,searchBarOpacity:.1,parallaxEnabled:!0,wallpaperResolution:"1080p",theme:"light"}}},[]),e=h.useCallback(n=>{const a=[];return n.cardOpacity!==void 0&&(typeof n.cardOpacity!="number"||n.cardOpacity<.05||n.cardOpacity>.3)&&a.push("卡片透明度值无效（应在0.05-0.3之间）"),n.searchBarOpacity!==void 0&&(typeof n.searchBarOpacity!="number"||n.searchBarOpacity<.05||n.searchBarOpacity>.3)&&a.push("搜索框透明度值无效（应在0.05-0.3之间）"),n.parallaxEnabled!==void 0&&typeof n.parallaxEnabled!="boolean"&&a.push("视差效果设置值无效（应为true或false）"),n.wallpaperResolution!==void 0&&(["4k","1080p","720p","mobile"].includes(n.wallpaperResolution)||a.push("壁纸分辨率值无效")),n.theme!==void 0&&(["light","dark"].includes(n.theme)||a.push("主题值无效（应为light或dark）")),{valid:a.length===0,errors:a}},[]),s=h.useCallback(n=>{const a=e(n),r=[];if(!a.valid)return console.warn("设置验证失败:",a.errors),{success:!1,appliedSettings:[]};try{return typeof n.cardOpacity=="number"&&(localStorage.setItem("cardOpacity",n.cardOpacity.toString()),r.push("卡片透明度")),typeof n.searchBarOpacity=="number"&&(localStorage.setItem("searchBarOpacity",n.searchBarOpacity.toString()),r.push("搜索框透明度")),typeof n.parallaxEnabled=="boolean"&&(localStorage.setItem("parallaxEnabled",JSON.stringify(n.parallaxEnabled)),r.push("视差效果")),n.wallpaperResolution&&["4k","1080p","720p","mobile"].includes(n.wallpaperResolution)&&(localStorage.setItem("wallpaperResolution",n.wallpaperResolution),r.push("壁纸分辨率")),n.theme&&["light","dark"].includes(n.theme)&&(localStorage.setItem("theme",n.theme),r.push("主题")),{success:!0,appliedSettings:r}}catch(o){return console.error("应用设置失败:",o),{success:!1,appliedSettings:[]}}},[e]);return{exportSettings:t,importSettings:s,validateSettings:e}}function Vc(t,e){const[s,n]=h.useState(!1),[a,r]=h.useState(!1),[o,l]=h.useState(null),{importData:u}=Va({enableAutoSync:!1}),{exportSettings:c,importSettings:f}=zc(),d=h.useCallback(async(g={})=>{const{includeSettings:x=!0,includeWebsites:$=!0}=g;if(!s){n(!0),l(null);try{if($&&(!t||t.length===0)&&!confirm("当前没有网站数据，是否仍要导出设置？"))return;const b={exportTime:new Date().toISOString(),version:"1.0"};$&&(b.websites=t||[]),x&&(b.settings=c());const S=JSON.stringify(b,null,2);if(new Blob([S]).size/1024/1024>50)throw new Error("导出数据过大（超过50MB），请联系技术支持");const O=new Blob([S],{type:"application/json"}),y=`炫酷收藏夹_导出数据_${new Date().toISOString().split("T")[0]}.json`;if("showSaveFilePicker"in window)try{const E=await(await window.showSaveFilePicker({suggestedName:y,types:[{description:"JSON文件",accept:{"application/json":[".json"]}}]})).createWritable();await E.write(O),await E.close(),alert(`数据导出成功！${$?`包含 ${t.length} 个网站`:""}${x?"和设置":""}。`);return}catch(T){if(T.name==="AbortError")return;console.warn("现代下载API失败，使用传统方式:",T)}const k=URL.createObjectURL(O),v=document.createElement("a");v.href=k,v.download=y,v.style.display="none",document.body.appendChild(v),v.click(),document.body.removeChild(v),setTimeout(()=>URL.revokeObjectURL(k),1e3),alert(`数据导出成功！${$?`包含 ${t.length} 个网站`:""}${x?"和设置":""}。`)}catch(b){const S=b instanceof Error?b.message:"未知错误";l(`导出失败: ${S}`),alert(`导出数据失败：${S}`)}finally{n(!1)}}},[s,t,c]),m=h.useCallback(async g=>a?{success:!1,message:"导入正在进行中，请稍候"}:(r(!0),l(null),new Promise(x=>{const $=new FileReader;$.onload=async b=>{var S;try{const L=(S=b.target)==null?void 0:S.result,O=JSON.parse(L);let y=0,k=[];if(O.websites){const T=await u(O);T.success&&(e(O.websites.filter(E=>E.id&&E.name&&E.url)),y=T.validCount||0)}if(O.settings){const T=f(O.settings);T.success&&(k=T.appliedSettings)}if(y+k.length===0){x({success:!1,message:"导入的文件中没有有效数据"});return}x({success:!0,message:"导入成功！",details:{websitesImported:y,settingsApplied:k}})}catch(L){const O=L instanceof Error?L.message:"文件格式错误";l(`导入失败: ${O}`),x({success:!1,message:`导入失败: ${O}`})}finally{r(!1)}},$.onerror=()=>{l("文件读取失败"),r(!1),x({success:!1,message:"文件读取失败"})},$.readAsText(g)})),[a,u,f,e]);return{exportAllData:d,importAllData:m,isExporting:s,isImporting:a,error:o}}function Wc({onClose:t,websites:e,setWebsites:s}){const[n,a]=h.useState(!1),[r,o]=h.useState(!1),[l,u]=h.useState(!1),[c,f]=h.useState(null),{exportAllData:d,importAllData:m,isExporting:g,isImporting:x}=Vc(e,s),{cardOpacity:$,searchBarOpacity:b,parallaxEnabled:S,wallpaperResolution:L,cardColor:O,searchBarColor:y,setCardOpacity:k,setSearchBarOpacity:v,setParallaxEnabled:T,setWallpaperResolution:E,setIsSettingsOpen:se,setCardColor:ee,setSearchBarColor:U}=vt(),{currentUser:V,logout:te}=Ce(),ie=h.useRef(null);h.useEffect(()=>(se(!0),()=>se(!1)),[se]);const ne=()=>{se(!1),t()},I=P=>{const R={...P,visitCount:0,lastVisit:new Date().toISOString().split("T")[0]};s([...e,R]),a(!1)},Z=async()=>{await d()},K=P=>{var W;const R=(W=P.target.files)==null?void 0:W[0];if(!R)return;const B=5*1024*1024;if(R.size>B){alert("文件过大！请选择小于5MB的文件。"),ie.current&&(ie.current.value="");return}if(!R.type.includes("json")&&!R.name.endsWith(".json")){alert("请选择JSON格式的文件！"),ie.current&&(ie.current.value="");return}f(R),u(!0),ie.current&&(ie.current.value="")},G=async()=>{if(!c||x)return;const P=await m(c);if(P.success){const R=P.details;let B="数据导入成功！";R!=null&&R.websitesImported&&(B+=`导入了 ${R.websitesImported} 个网站。`),R!=null&&R.settingsApplied&&R.settingsApplied.length>0&&(B+=`应用了设置：${R.settingsApplied.join("、")}。`),B+="页面将刷新以应用新设置。",alert(B),window.location.reload()}else alert(P.message);f(null)};return i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center select-none",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:ne}),i.jsxs(re.div,{className:"w-96 bg-white rounded-xl shadow-2xl z-50 max-h-[80vh] flex flex-col select-none",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",damping:20,stiffness:300},children:[i.jsx("div",{className:"p-6 pb-0 select-none",children:i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h2",{className:"text-xl font-medium text-gray-800 select-none",children:"设置"}),i.jsx("button",{onClick:ne,className:"text-gray-500 hover:text-gray-700 select-none",children:i.jsx("i",{className:"fa-solid fa-xmark text-lg select-none"})})]})}),i.jsxs("div",{className:"flex-1 px-6 py-2 pb-6 space-y-6 overflow-y-auto select-none",children:[i.jsxs("div",{className:"space-y-4 select-none",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider select-none",children:"账号管理"}),V?i.jsxs("div",{className:"bg-gray-100 rounded-lg p-4 space-y-4",children:[i.jsx(Mc,{}),i.jsx("div",{className:"flex justify-center pt-1",children:i.jsxs("button",{onClick:async()=>{try{await te(),ne()}catch(P){console.error("登出失败:",P)}},className:"text-red-500 hover:text-red-600 transition-colors flex items-center text-sm select-none",children:[i.jsx("i",{className:"fa-solid fa-sign-out-alt mr-1.5 text-xs select-none"}),"登出"]})})]}):i.jsx("div",{className:"bg-gray-100 rounded-lg p-4",children:i.jsx(Bc,{onSuccess:ne})})]}),i.jsxs("div",{className:"space-y-4 select-none",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider select-none",children:"云端同步"}),i.jsx("div",{className:"bg-gray-100 rounded-lg p-4",children:i.jsx(Pc,{})})]}),i.jsx("div",{className:"select-none -mt-4",children:i.jsx(Lc,{})}),i.jsxs("div",{className:"space-y-4 select-none",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider select-none",children:"外观设置"}),i.jsxs("div",{className:"space-y-2 select-none",children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 select-none",children:["搜索框不透明度 (",Math.round(b*100),"%)"]}),i.jsx("input",{type:"range",min:"0.05",max:"0.5",step:"0.01",value:b,onChange:P=>v(parseFloat(P.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"})]}),i.jsx(zn,{label:"搜索框颜色",selectedColor:y,onChange:U}),i.jsxs("div",{className:"space-y-2 select-none",children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 select-none",children:["卡片不透明度 (",Math.round($*100),"%)"]}),i.jsx("input",{type:"range",min:"0.05",max:"0.5",step:"0.01",value:$,onChange:P=>k(parseFloat(P.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"})]}),i.jsx(zn,{label:"卡片颜色",selectedColor:O,onChange:ee}),i.jsxs("div",{className:"space-y-2 select-none",children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center justify-between select-none",children:[i.jsx("span",{className:"select-none",children:"视差背景效果"}),i.jsx("button",{onClick:()=>T(!S),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors select-none ${S?"bg-blue-500":"bg-gray-300"}`,children:i.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform select-none ${S?"translate-x-6":"translate-x-1"}`})})]}),i.jsx("p",{className:"text-xs text-gray-500 select-none",children:S?"背景会跟随鼠标轻微移动":"背景固定不动"})]}),i.jsxs("div",{className:"space-y-2 select-none",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 select-none",children:"壁纸分辨率"}),i.jsx("div",{className:"grid grid-cols-2 gap-2 select-none",children:[{value:"4k",label:"4K 超高清",desc:"大屏设备"},{value:"1080p",label:"1080p 高清",desc:"推荐"},{value:"720p",label:"720p 标清",desc:"网络较慢"},{value:"mobile",label:"竖屏壁纸",desc:"移动设备"}].map(P=>i.jsxs("button",{onClick:()=>E(P.value),className:`p-3 rounded-lg border-2 transition-all text-left select-none cursor-pointer ${L===P.value?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"}`,children:[i.jsx("div",{className:"font-medium text-sm",children:P.label}),i.jsx("div",{className:"text-xs text-gray-500",children:P.desc})]},P.value))}),i.jsx("p",{className:"text-xs text-gray-500 select-none",children:"更改分辨率后会重新加载壁纸并更新缓存"})]})]}),i.jsxs("div",{className:"space-y-4 select-none",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider select-none",children:"卡片管理"}),i.jsxs("button",{onClick:()=>a(!0),className:"w-full px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-md transition-colors select-none",children:[i.jsx("i",{className:"fa-solid fa-plus mr-2 select-none"}),"添加新卡片"]})]}),i.jsxs("div",{className:"space-y-4 select-none",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider select-none",children:"数据管理"}),i.jsxs("div",{className:"grid grid-cols-2 gap-3 select-none",children:[i.jsx("button",{onClick:Z,disabled:g,className:`px-3 py-2 rounded-md transition-colors text-sm select-none ${g?"bg-gray-400 cursor-not-allowed text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:g?i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-1 select-none"}),"导出中"]}):i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-download mr-1 select-none"}),"导出"]})}),i.jsx("button",{onClick:()=>{var P;return(P=ie.current)==null?void 0:P.click()},disabled:x,className:`px-3 py-2 rounded-md transition-colors text-sm select-none ${x?"bg-gray-400 cursor-not-allowed text-white":"bg-orange-500 hover:bg-orange-600 text-white"}`,children:x?i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-1 select-none"}),"导入中"]}):i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-upload mr-1 select-none"}),"导入"]})})]}),i.jsx("input",{ref:ie,type:"file",accept:".json",onChange:K,className:"hidden"}),i.jsx("p",{className:"text-xs text-gray-500 select-none",children:"⚠️ 导入会覆盖所有当前数据，建议先导出备份"})]}),i.jsxs("div",{className:"space-y-4 select-none",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider select-none",children:"隐私与Cookie"}),i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("button",{onClick:()=>o(!0),className:"w-full px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-md transition-colors select-none",children:[i.jsx("i",{className:"fa-solid fa-shield-halved mr-2 select-none"}),"隐私设置"]}),i.jsxs("a",{href:"/tutorial.html",target:"_blank",rel:"noopener noreferrer",className:"w-full px-4 py-2 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-md transition-colors flex items-center justify-center gap-2 font-medium select-none border border-blue-200",style:{textDecoration:"none"},children:[i.jsx("i",{className:"fa-solid fa-graduation-cap"}),"使用教程"]})]})]})]})]}),n&&i.jsx(Da,{id:`new-${Date.now()}`,name:"",url:"",favicon:"",tags:[],note:"",onClose:()=>a(!1),onSave:I}),r&&i.jsx(za,{isOpen:r,onClose:()=>o(!1)}),i.jsx(Fc,{isOpen:l,onClose:()=>{u(!1),f(null)},onConfirm:G,title:"确认导入数据",message:`⚠️ 导入数据前请注意：

• 导入会完全覆盖当前所有数据
• 包括所有网站卡片、透明度设置、主题等
• 建议先导出当前数据作为备份

确定要继续导入吗？`,confirmText:"确定导入",cancelText:"取消",type:"warning"})]})}function Zc(){const{currentUser:t,sendVerificationEmail:e,reloadUser:s,logout:n}=Ce(),[a,r]=h.useState(!1),[o,l]=h.useState(!1);if(!t||t.emailVerified)return null;const u=async()=>{r(!0);try{await e(),alert("✅ 验证邮件已发送！请检查您的邮箱（包括垃圾邮件文件夹）")}catch(d){alert("❌ 发送失败，请稍后重试"),console.error("发送验证邮件失败:",d)}finally{r(!1)}},c=async()=>{l(!0);try{await s(),window.location.reload()}catch(d){console.error("检查验证状态失败:",d)}finally{l(!1)}},f=async()=>{confirm("确定要登出吗？您可以稍后验证邮箱后重新登录。")&&await n()};return i.jsx(re.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},className:"fixed top-0 left-0 right-0 z-50 bg-orange-500 text-white shadow-lg",children:i.jsx("div",{className:"container mx-auto px-4 py-3",children:i.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("i",{className:"fa-solid fa-envelope-open-text text-xl"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:"请验证您的邮箱地址"}),i.jsxs("p",{className:"text-sm text-orange-100",children:["我们已向 ",i.jsx("strong",{children:t.email})," 发送了验证链接"]})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:u,disabled:a,className:"bg-orange-600 hover:bg-orange-700 disabled:bg-orange-400 px-3 py-1 rounded text-sm transition-colors",children:a?i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-1"}),"发送中..."]}):i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-paper-plane mr-1"}),"重新发送"]})}),i.jsx("button",{onClick:c,disabled:o,className:"bg-green-500 hover:bg-green-600 disabled:bg-green-400 px-3 py-1 rounded text-sm transition-colors",children:o?i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-1"}),"检查中..."]}):i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-check-circle mr-1"}),"已验证"]})}),i.jsxs("button",{onClick:f,className:"bg-red-500 hover:bg-red-600 px-3 py-1 rounded text-sm transition-colors",children:[i.jsx("i",{className:"fa-solid fa-sign-out-alt mr-1"}),"登出"]})]})]})})})}const et=class et{constructor(){oe(this,"db",null);oe(this,"dbName","WallpaperCache");oe(this,"version",1);oe(this,"storeName","images")}static getInstance(){return et.instance||(et.instance=new et),et.instance}async init(){return new Promise((e,s)=>{const n=indexedDB.open(this.dbName,this.version);n.onerror=()=>{console.error("IndexedDB 打开失败:",n.error),s(n.error)},n.onsuccess=()=>{this.db=n.result,console.log("✅ IndexedDB 初始化成功"),e()},n.onupgradeneeded=a=>{const r=a.target.result;r.objectStoreNames.contains(this.storeName)||(r.createObjectStore(this.storeName,{keyPath:"key"}).createIndex("timestamp","timestamp",{unique:!1}),console.log("📦 创建 IndexedDB 存储空间"))}})}async ensureDB(){return this.db||await this.init(),this.db}async set(e,s,n=2*60*60*1e3){try{const o=(await this.ensureDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName),l={key:e,blob:s,timestamp:Date.now(),ttl:n,size:s.size,type:s.type},u=o.put(l);return new Promise((c,f)=>{u.onsuccess=()=>{console.log(`💾 IndexedDB 保存成功: ${e} (${(s.size/1024/1024).toFixed(2)}MB)`),c()},u.onerror=()=>{console.error("IndexedDB 保存失败:",u.error),f(u.error)}})}catch(a){throw console.error("IndexedDB 保存异常:",a),a}}async get(e){try{const r=(await this.ensureDB()).transaction([this.storeName],"readonly").objectStore(this.storeName).get(e);return new Promise((o,l)=>{r.onsuccess=()=>{const u=r.result;if(!u){o(null);return}if(Date.now()-u.timestamp>u.ttl){console.log(`🗑️ IndexedDB 缓存已过期，删除: ${e}`),this.delete(e),o(null);return}console.log(`✅ IndexedDB 缓存命中: ${e} (${(u.size/1024/1024).toFixed(2)}MB)`),o(u.blob)},r.onerror=()=>{console.error("IndexedDB 读取失败:",r.error),l(r.error)}})}catch(s){return console.error("IndexedDB 读取异常:",s),null}}async has(e){try{const r=(await this.ensureDB()).transaction([this.storeName],"readonly").objectStore(this.storeName).get(e);return new Promise(o=>{r.onsuccess=()=>{const l=r.result;if(!l){o(!1);return}if(Date.now()-l.timestamp>l.ttl){this.delete(e),o(!1);return}o(!0)},r.onerror=()=>{o(!1)}})}catch{return!1}}async delete(e){try{const r=(await this.ensureDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(e);return new Promise((o,l)=>{r.onsuccess=()=>{console.log(`🗑️ IndexedDB 删除成功: ${e}`),o()},r.onerror=()=>{console.error("IndexedDB 删除失败:",r.error),l(r.error)}})}catch(s){console.error("IndexedDB 删除异常:",s)}}async cleanup(){try{const a=(await this.ensureDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName).openCursor();let r=0;const o=Date.now();return new Promise((l,u)=>{a.onsuccess=c=>{const f=c.target.result;if(f){const d=f.value;o-d.timestamp>d.ttl&&(f.delete(),r++),f.continue()}else console.log(`🧹 IndexedDB 清理完成，删除 ${r} 个过期缓存`),l()},a.onerror=()=>{console.error("IndexedDB 清理失败:",a.error),u(a.error)}})}catch(e){console.error("IndexedDB 清理异常:",e)}}async getStats(){try{const a=(await this.ensureDB()).transaction([this.storeName],"readonly").objectStore(this.storeName).openCursor();let r=0,o=0;return new Promise((l,u)=>{a.onsuccess=c=>{const f=c.target.result;if(f){const d=f.value;r++,o+=d.size||0,f.continue()}else l({count:r,totalSize:o})},a.onerror=()=>{console.error("IndexedDB 统计失败:",a.error),u(a.error)}})}catch(e){return console.error("IndexedDB 统计异常:",e),{count:0,totalSize:0}}}};oe(et,"instance");let Ps=et;const Rt=Ps.getInstance(),tt=class tt{constructor(){oe(this,"cache",new Map)}static getInstance(){return tt.instance||(tt.instance=new tt),tt.instance}set(e,s,n=5*60*1e3){this.cache.set(e,{data:s,timestamp:Date.now(),ttl:n})}get(e){const s=this.cache.get(e);return s?Date.now()-s.timestamp>s.ttl?(this.cache.delete(e),null):s.data:null}cleanup(){const e=Date.now();for(const[s,n]of this.cache.entries())e-n.timestamp>n.ttl&&this.cache.delete(s)}clear(){this.cache.clear()}size(){return this.cache.size}};oe(tt,"instance");let Ls=tt;const Wa=Ls.getInstance();setInterval(()=>{Wa.cleanup()},6e4);const Ns={async cacheWallpaperBlob(t,e){try{console.log("🔧 开始Blob缓存流程:",{url:t,cacheKey:e});const s=`wallpaper-blob:${e}`,n=await Rt.get(s);if(n)return console.log("✨ 发现已有IndexedDB缓存:",s),URL.createObjectURL(n);console.log("📥 开始下载图片数据...");const a=`https://corsproxy.io/?${encodeURIComponent(t)}`;console.log("🔄 使用CORS代理:",a);const r=await fetch(a,{mode:"cors",headers:{Accept:"image/*"}});if(!r.ok)throw new Error(`下载失败: ${r.status} ${r.statusText}`);console.log("✅ 图片下载成功，创建Blob...");const o=await r.blob(),l=URL.createObjectURL(o);return console.log("💾 保存Blob到IndexedDB:",{cacheKey:s,blobUrl:l,size:`${(o.size/1024/1024).toFixed(2)}MB`}),await Rt.set(s,o,2*60*60*1e3),Wa.set(`wallpaper-source:${e}`,t,2*60*60*1e3),console.log("🔍 IndexedDB缓存验证: ✅ 成功"),l}catch(s){return console.error("❌ 壁纸Blob缓存失败:",s),console.error("📊 错误详情:",{url:t,cacheKey:e,error:s instanceof Error?s.message:String(s)}),console.log("🔄 CORS失败，跳过Blob缓存但保持系统稳定"),t}},async preloadTodayWallpapers(){const t=new Date().toDateString(),e=[{url:"https://bing.img.run/uhd.php",key:`bing-${t}`},{url:"https://bing.img.run/1920x1080.php",key:`bing-hd-${t}`},{url:"https://source.unsplash.com/1920x1080/?nature",key:`unsplash-${t}`}],s=await Promise.allSettled(e.map(({url:n,key:a})=>this.cacheWallpaperBlob(n,a)));console.log("📷 壁纸预加载完成:",s.filter(n=>n.status==="fulfilled").length,"/",s.length)},async getCachedWallpaper(t){const e=`wallpaper-blob:${t}`;try{const s=await Rt.get(e);if(s)return console.log("⚡ IndexedDB缓存命中:",e),URL.createObjectURL(s)}catch(s){console.warn("IndexedDB读取失败:",s)}return null},async hasCachedWallpaper(t){const e=`wallpaper-blob:${t}`;return await Rt.has(e)},async cleanupWallpaperCache(){try{await Rt.cleanup(),console.log("🧹 壁纸缓存清理完成")}catch(t){console.error("清理壁纸缓存失败:",t)}}};function Hc(t,e=[]){const s=h.useRef(null),n=h.useRef(),a=h.useCallback((...o)=>{n.current=o,s.current===null&&(s.current=requestAnimationFrame(()=>{s.current=null,n.current&&t(...n.current)}))},e),r=h.useCallback(()=>{s.current!==null&&(cancelAnimationFrame(s.current),s.current=null)},[]);return Object.assign(a,{cancel:r})}function qc(t,e=!0){const s=Hc(t,[e]);return h.useCallback(a=>{e&&s(a)},[s,e])}function Kc({websites:t,setWebsites:e}){const{parallaxEnabled:s,wallpaperResolution:n,isSettingsOpen:a}=vt(),{currentUser:r}=Ce(),{displayName:o}=Fa(),{isMobile:l,getGridClasses:u,getSearchBarLayout:c}=Pa();$c(t);const f=(I,Z)=>{const K=[...t],[G]=K.splice(I,1);K.splice(Z,0,G),e(K)},[d,m]=h.useState(""),[g,x]=h.useState(!1),[$,b]=h.useState(!1),[S,L]=h.useState({x:0,y:0}),[O,y]=h.useState(!1),[k,v]=h.useState(0),[T,E]=h.useState(!1);h.useEffect(()=>{const I=()=>new Date().toISOString().split("T")[0],Z=()=>`wallpaper-${n}-${I()}`,G=(()=>{try{const P=Z(),R=localStorage.getItem(P);if(R){const{url:B,timestamp:W}=JSON.parse(R),p=Date.now(),_=24*60*60*1e3;if(p-W<_&&B)return B}}catch(P){console.warn("读取壁纸缓存失败:",P)}return null})();G&&(m(G),x(!0),console.log("⚡ 即时加载缓存壁纸"))},[]),h.useEffect(()=>{const I=setTimeout(()=>{const Z=()=>new Date().toISOString().split("T")[0],K=R=>`wallpaper-${R}-${Z()}`,P=(R=>{try{const B=K(R),W=localStorage.getItem(B);if(W){const{url:p,timestamp:_}=JSON.parse(W),N=Date.now(),Y=24*60*60*1e3;if(N-_<Y&&p)return p}}catch(B){console.warn("读取缓存失败:",B)}return null})(n);console.log(P?"✅ 当前分辨率已有缓存":"🚀 当前分辨率无缓存，将在正常加载时获取")},300);return()=>clearTimeout(I)},[n]);const se=[...t].sort((I,Z)=>{const K=(Z.visitCount||0)-(I.visitCount||0);if(K!==0)return K;const G=new Date(I.lastVisit||"2000-01-01").getTime();return new Date(Z.lastVisit||"2000-01-01").getTime()-G}),ee=()=>{T||(v(I=>I+1),E(!0),y(!0),setTimeout(()=>{y(!1),setTimeout(()=>{E(!1)},300)},1e3))},U=I=>{e(t.map(Z=>Z.id===I.id?{...Z,...I}:Z))};h.useEffect(()=>{const I=p=>({"4k":"https://bing.img.run/uhd.php","1080p":"https://bing.img.run/1920x1080.php","720p":"https://bing.img.run/1366x768.php",mobile:"https://bing.img.run/m.php"})[p],Z=()=>{const p=["https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1920&h=1080&fit=crop","https://images.unsplash.com/photo-1519904981063-b0cf448d479e?w=1920&h=1080&fit=crop","https://images.unsplash.com/photo-1501594907352-04cda38ebc29?w=1920&h=1080&fit=crop"],_=new Date().getDate();return p[_%p.length]},K=()=>new Date().toISOString().split("T")[0],G=()=>`wallpaper-${n}-${K()}`,P=()=>`blob-${n}-${K()}`,R=async()=>{try{const p=P();console.log("🔍 检查Blob缓存键:",p);const _=await Ns.getCachedWallpaper(p);if(console.log("🔍 Blob缓存结果:",_?"找到":"未找到"),_)return console.log("⚡ 使用高级Blob缓存"),{url:_,type:"blob"};const N=G();console.log("🔍 检查URL缓存键:",N);const Y=localStorage.getItem(N);if(Y){const{url:q,timestamp:ae}=JSON.parse(Y),J=Date.now(),fe=24*60*60*1e3;if(J-ae<fe&&q)return console.log("📦 使用URL缓存"),{url:q,type:"url"}}}catch(p){console.warn("读取壁纸缓存失败:",p)}return null},B=async p=>{try{const _=G(),N={url:p,timestamp:Date.now(),resolution:n};localStorage.setItem(_,JSON.stringify(N)),console.log("✅ URL缓存完成");const Y=P();console.log("🚀 开始异步创建Blob缓存..."),Ns.cacheWallpaperBlob(p,Y).then(q=>{console.log("✅ 壁纸Blob已缓存，下次访问将瞬间加载"),console.log("🎯 Blob URL:",q)}).catch(q=>{console.warn("❌ Blob缓存失败，但URL缓存仍可用:",q)}),console.log("✅ 壁纸已缓存")}catch(_){console.warn("缓存壁纸失败:",_)}},W=(p,_=!1)=>{console.log("🖼️ 加载壁纸，分辨率:",n,_?"(备用)":""),x(!1);const N=new Image,Y=setTimeout(()=>{if(N.onload=null,N.onerror=null,console.warn("⏰ 壁纸加载超时，使用备用壁纸"),_)m(""),x(!0);else{const q=Z();W(q,!0)}},6e3);N.onload=()=>{clearTimeout(Y),m(N.src),x(!0),B(N.src),console.log("✅ 壁纸加载完成:",N.src)},N.onerror=()=>{if(clearTimeout(Y),_)console.warn("❌ 备用壁纸也失败，使用占位背景"),m(""),x(!0);else{console.warn("❌ 主要壁纸API失败，尝试备用壁纸");const q=Z();W(q,!0)}},N.src=p};R().then(p=>{if(p){if(console.log(`📦 使用${p.type==="blob"?"高级Blob":"URL"}缓存:`,p.url),m(p.url),x(!0),p.type==="url"){const _=P();console.log("🚀 异步创建Blob缓存以提升未来性能..."),Ns.cacheWallpaperBlob(p.url,_).then(N=>{console.log("✅ 异步Blob缓存创建成功！下次访问将瞬间加载"),console.log("🎯 Blob URL:",N)}).catch(N=>{console.warn("❌ 异步Blob缓存失败:",N)})}}else{const _=I(n);console.log("🌐 加载官方 Bing 壁纸:",_),W(_)}}).catch(p=>{console.warn("检查缓存失败:",p);const _=I(n);console.log("🌐 加载官方 Bing 壁纸:",_),W(_)})},[n]);const V=h.useCallback(I=>{L({x:I.clientX,y:I.clientY})},[]),te=qc(V,s&&!a);h.useEffect(()=>{if(!s||a){L({x:0,y:0});return}return window.addEventListener("mousemove",te,{passive:!0}),()=>{window.removeEventListener("mousemove",te)}},[s,a,te]),h.useEffect(()=>{if(t.length>0){const I=setTimeout(()=>{console.log("🚀 开始简单批量预缓存 favicon..."),As.batchCacheFaviconsToIndexedDB(t).then(()=>{console.log("✅ Favicon 简单批量预缓存完成")}).catch(Z=>{console.warn("❌ Favicon 简单批量预缓存失败:",Z)})},2e3);return()=>clearTimeout(I)}},[t]);const ne=(()=>{const I=c(),Z=u();return{container:`relative min-h-screen ${l?"pt-[25vh]":"pt-[33vh]"}`,searchContainer:I.containerClass,cardContainer:`${l?"pt-8 pb-4":"pt-16 pb-8"} px-4 max-w-6xl mx-auto`,gridLayout:Z,userInfo:l?"fixed top-2 right-2 z-40 scale-90":"fixed top-4 right-4 z-40",settingsButton:l?"fixed bottom-2 right-2 z-[9999] p-2 bg-white/10 rounded-full backdrop-blur-sm":"fixed bottom-4 right-4 z-[9999]"}})();return i.jsxs(i.Fragment,{children:[i.jsx(Zc,{}),i.jsx("div",{className:"fixed top-0 left-0 w-full h-full -z-10",style:{backgroundImage:d?`url(${d})`:void 0,backgroundSize:"cover",backgroundPosition:l?"center center":"center top",backgroundRepeat:"no-repeat",filter:g?"none":"blur(2px)",transform:!a&&s&&!l&&S?`translate(${S.x*.02}px, ${S.y*.02}px) scale(1.05)`:"translate(0px, 0px) scale(1)",transition:"filter 1.5s ease-out, transform 0.3s ease-out"}}),d&&i.jsx("div",{className:"fixed top-0 left-0 w-full h-full -z-10",style:{background:l?"linear-gradient(to bottom, rgba(30, 41, 59, 0.6) 0%, rgba(30, 41, 59, 0.4) 50%, rgba(30, 41, 59, 0.2) 100%)":"linear-gradient(to bottom, rgba(30, 41, 59, 0.7) 0%, rgba(30, 41, 59, 0.3) 50%, rgba(30, 41, 59, 0.1) 100%)",opacity:g?0:1,transition:"opacity 1.5s ease-out",pointerEvents:"none"}}),!g&&d&&i.jsx("div",{className:`fixed ${l?"top-2 left-2":"top-4 left-4"} z-40 bg-black/30 backdrop-blur-sm rounded-lg px-4 py-2`,children:i.jsxs("div",{className:"text-white/90 text-sm font-medium flex items-center space-x-2",children:[i.jsx("div",{className:"animate-pulse rounded-full h-2 w-2 bg-white/70"}),i.jsx("span",{className:l?"text-xs":"text-sm",children:"壁纸加载中"})]})}),i.jsxs("div",{className:ne.container,children:[i.jsx("div",{className:ne.searchContainer,children:i.jsx(wc,{})}),i.jsx("div",{className:ne.cardContainer,children:i.jsx(re.div,{className:ne.gridLayout,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:se.map((I,Z)=>i.jsx(vc,{...I,index:Z,moveCard:f,onSave:U,onDelete:K=>{e(t.filter(G=>G.id!==K))}},I.id))})}),$&&i.jsx(Wc,{onClose:()=>b(!1),websites:t,setWebsites:e}),r&&r.emailVerified&&i.jsxs("div",{className:ne.userInfo,children:[i.jsxs("button",{onClick:ee,className:`bg-white/20 backdrop-blur-sm rounded-lg ${l?"px-2 py-1":"px-3 py-2"} flex items-center space-x-2 hover:bg-white/30 transition-colors cursor-pointer`,children:[i.jsx("i",{className:`fa-solid fa-user text-white/80 ${l?"text-xs":""}`}),i.jsx("span",{className:`text-white/90 ${l?"text-xs":"text-sm"} font-medium ${l&&o.length>8?"max-w-[60px] truncate":""}`,children:o})]}),O&&!l&&i.jsxs("div",{className:`absolute top-full right-0 mt-2 bg-white/95 backdrop-blur-sm rounded-lg px-4 py-3 shadow-lg border border-white/20 transition-opacity duration-300 ${O?"opacity-100":"opacity-0"}`,children:[i.jsx("p",{className:"text-gray-800 text-sm font-medium whitespace-nowrap",children:k>=10?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-red-500",children:"😠"})," 别点啦！"]}):`你好鸭，"${o}"，今天也要开心哦！`}),i.jsx("div",{className:"absolute -top-2 right-4 w-0 h-0 border-l-4 border-r-4 border-b-4 border-l-transparent border-r-transparent border-b-white/95"})]})]}),i.jsx("div",{className:ne.settingsButton,children:i.jsx("button",{onClick:()=>b(!0),className:"p-2 text-white/70 hover:text-white transition-colors","aria-label":"设置",children:i.jsx("i",{className:`fa-solid fa-sliders ${l?"text-base":"text-lg"}`})})}),!l&&i.jsx(_c,{})]})]})}function Gc({isOpen:t,onClose:e,localWebsites:s,cloudWebsites:n,onChoice:a}){const[r,o]=h.useState(!1);if(!t)return null;const l=async u=>{o(!0);try{await a(u),e()}catch(c){console.error("处理数据同步失败:",c)}finally{o(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),i.jsxs(re.div,{className:"w-96 bg-white rounded-xl shadow-2xl z-50 max-h-[80vh] flex flex-col",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",damping:20,stiffness:300},children:[i.jsx("div",{className:"p-6 pb-0",children:i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h2",{className:"text-xl font-medium text-gray-800",children:"数据同步选择"}),i.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",disabled:r,children:i.jsx("i",{className:"fa-solid fa-xmark text-lg"})})]})}),i.jsxs("div",{className:"flex-1 px-6 py-2 pb-6 space-y-4 overflow-y-auto",children:[i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("p",{className:"text-sm text-blue-800 mb-2",children:[i.jsx("i",{className:"fa-solid fa-info-circle mr-2"}),"检测到您有本地数据和云端数据，请选择如何处理："]})}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[i.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:[i.jsx("i",{className:"fa-solid fa-computer mr-2"}),"本地数据"]}),i.jsxs("p",{className:"text-xs text-gray-600",children:[s.length," 个网站卡片"]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[i.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:[i.jsx("i",{className:"fa-solid fa-cloud mr-2"}),"云端数据"]}),i.jsxs("p",{className:"text-xs text-gray-600",children:[n.length," 个网站卡片"]})]})]}),i.jsxs("div",{className:"space-y-3 pt-4",children:[i.jsx("button",{onClick:()=>l("cloud"),disabled:r,className:"w-full p-4 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white rounded-lg transition-colors text-left",children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx("i",{className:"fa-solid fa-cloud-arrow-down text-lg mt-1"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:"使用云端数据"}),i.jsx("div",{className:"text-xs text-blue-100",children:"本地数据将被云端数据覆盖"})]})]})}),i.jsx("button",{onClick:()=>l("local"),disabled:r,className:"w-full p-4 bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white rounded-lg transition-colors text-left",children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx("i",{className:"fa-solid fa-cloud-arrow-up text-lg mt-1"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:"使用本地数据"}),i.jsx("div",{className:"text-xs text-green-100",children:"本地数据将同步到云端，覆盖云端数据"})]})]})}),i.jsx("button",{onClick:()=>l("merge"),disabled:r,className:"w-full p-4 bg-purple-500 hover:bg-purple-600 disabled:bg-gray-400 text-white rounded-lg transition-colors text-left",children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx("i",{className:"fa-solid fa-code-merge text-lg mt-1"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:"智能合并"}),i.jsx("div",{className:"text-xs text-purple-100",children:"保留访问次数更高的网站卡片，去除重复项"})]})]})})]}),r&&i.jsxs("div",{className:"flex items-center justify-center py-4",children:[i.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-2"}),i.jsx("span",{className:"text-sm text-gray-600",children:"处理中..."})]})]})]})]})}function Jc(){const{isNetworkOnline:t,isFirebaseConnected:e,error:s}=Ce();if(t&&e&&!s)return null;const n=()=>{console.log("🔄 重置Firebase连接状态..."),$t.reset()};return i.jsxs("div",{className:"fixed top-4 right-4 z-50 max-w-sm space-y-2",children:[!t&&i.jsxs("div",{className:"p-3 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded-lg shadow-lg flex items-center space-x-2",children:[i.jsx("i",{className:"fa-solid fa-wifi-slash"}),i.jsx("span",{className:"text-sm",children:"网络连接不可用"})]}),!e&&t&&i.jsx("div",{className:"p-3 bg-blue-100 border border-blue-400 text-blue-700 rounded-lg shadow-lg",children:i.jsx("div",{className:"flex items-start justify-between space-x-2",children:i.jsxs("div",{className:"flex items-start space-x-2 flex-1",children:[i.jsx("i",{className:"fa-solid fa-cloud-slash mt-0.5"}),i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"font-medium",children:"Firebase连接异常"}),i.jsx("div",{className:"text-xs mt-1",children:"云同步功能可能受限"}),i.jsx("button",{onClick:n,className:"mt-2 text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700 transition-colors",children:"重试连接"})]})]})})}),s&&i.jsx("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg shadow-lg",children:i.jsxs("div",{className:"flex items-start space-x-2",children:[i.jsx("i",{className:"fa-solid fa-exclamation-triangle mt-0.5"}),i.jsx("span",{className:"text-sm",children:s})]})})]})}function Qc(t=!0){const{currentUser:e}=Ce(),[s,n]=h.useState({cloudWebsites:null,cloudSettings:null,loading:!1,error:null}),a=async()=>{if(!e||!e.emailVerified){n(o=>({...o,error:"需要登录且验证邮箱才能加载云端数据",loading:!1}));return}n(o=>({...o,loading:!0,error:null}));try{const[o,l]=await Promise.allSettled([Rc(e),Ic(e)]),u=o.status==="fulfilled"?o.value:null,c=l.status==="fulfilled"?l.value:null;n({cloudWebsites:u,cloudSettings:c,loading:!1,error:null}),console.log("✅ 云端数据加载完成:",{websites:(u==null?void 0:u.length)||0,hasSettings:!!c}),o.status==="rejected"&&console.warn("云端网站数据加载失败，使用本地数据:",o.reason),l.status==="rejected"&&console.warn("云端设置加载失败，使用本地设置:",l.reason)}catch(o){n(l=>({...l,loading:!1,error:"加载云端数据失败: "+o.message})),console.error("❌ 加载云端数据失败:",o)}},r=o=>s.cloudWebsites?Ac(o,s.cloudWebsites):o;return h.useEffect(()=>{t&&e&&e.emailVerified?a():n({cloudWebsites:null,cloudSettings:null,loading:!1,error:null})},[e,t]),{...s,loadCloudData:a,mergeWithLocalData:r,hasCloudData:!!s.cloudWebsites||!!s.cloudSettings}}const Yc=()=>{h.useEffect(()=>{document.title="jiang_ai_web";const t=()=>{document.hidden?document.title="😭你就要离开我了吗":document.title="jiang_ai_web"};return document.addEventListener("visibilitychange",t),()=>{document.removeEventListener("visibilitychange",t)}},[])};class Xc{constructor(){oe(this,"preloadedResources",new Set);oe(this,"preloadQueue",[]);oe(this,"isProcessing",!1);oe(this,"maxConcurrent",3)}async preloadImage(e){return this.preloadedResources.has(e)?!0:new Promise(s=>{const n=new Image;n.onload=()=>{this.preloadedResources.add(e),s(!0)},n.onerror=()=>{s(!1)},n.src=e})}async preloadImages(e){const s=e.filter(n=>!this.preloadedResources.has(n));if(s.length!==0)for(let n=0;n<s.length;n+=this.maxConcurrent){const a=s.slice(n,n+this.maxConcurrent);await Promise.allSettled(a.map(r=>this.preloadImage(r)))}}queuePreload(e){!this.preloadedResources.has(e)&&!this.preloadQueue.includes(e)&&(this.preloadQueue.push(e),this.processQueue())}async processQueue(){if(!(this.isProcessing||this.preloadQueue.length===0)){this.isProcessing=!0;try{"requestIdleCallback"in window?await new Promise(e=>{requestIdleCallback(()=>{this.processBatch(),e()})}):await new Promise(e=>{setTimeout(()=>{this.processBatch(),e()},16)})}finally{this.isProcessing=!1,this.preloadQueue.length>0&&setTimeout(()=>this.processQueue(),100)}}}async processBatch(){const e=this.preloadQueue.splice(0,this.maxConcurrent);e.length!==0&&await Promise.allSettled(e.map(s=>this.preloadImage(s)))}preloadFont(e,s){const n=document.createElement("link");if(n.rel="preload",n.as="font",n.type="font/woff2",n.crossOrigin="anonymous",n.href=e,document.head.appendChild(n),"FontFace"in window){const a=new FontFace(s,`url(${e})`);a.load().then(()=>{document.fonts.add(a)}).catch(r=>{console.warn("字体预加载失败:",r)})}}preloadCSS(e){const s=document.createElement("link");s.rel="preload",s.as="style",s.href=e,s.onload=()=>{s.rel="stylesheet"},document.head.appendChild(s)}getStats(){return{preloaded:this.preloadedResources.size,queued:this.preloadQueue.length}}clear(){this.preloadedResources.clear(),this.preloadQueue.length=0}}const Yt=new Xc;function ed(t=!0){return h.useEffect(()=>t?(["https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/webfonts/fa-solid-900.woff2","https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/webfonts/fa-regular-400.woff2"].forEach(o=>{Yt.queuePreload(o)}),["https://bing.img.run","https://source.unsplash.com","https://www.google.com","https://favicon.yandex.net","https://icons.duckduckgo.com"].forEach(o=>{const l=document.createElement("link");l.rel="preconnect",l.href=o,document.head.querySelector(`link[href="${o}"]`)||document.head.appendChild(l)}),()=>{}):void 0,[t]),{preloadFavicons:a=>{const r=a.map(o=>o.favicon);Yt.preloadImages(r)},preloadImage:a=>{Yt.queuePreload(a)},getPreloadStats:()=>Yt.getStats()}}function td({onAccept:t,onDecline:e,onCustomize:s}){const[n,a]=h.useState(!1),[r,o]=h.useState(!1);h.useEffect(()=>{if(!localStorage.getItem("cookie-consent")){const d=setTimeout(()=>{a(!0),o(!0)},2e3);return()=>clearTimeout(d)}},[]);const l=()=>{localStorage.setItem("cookie-consent","accepted"),localStorage.setItem("cookie-consent-date",new Date().toISOString()),o(!1),setTimeout(()=>{a(!1),t==null||t()},300),console.log("✅ 用户已同意Cookie使用")},u=()=>{localStorage.setItem("cookie-consent","declined"),localStorage.setItem("cookie-consent-date",new Date().toISOString()),o(!1);try{const f=["cookie-consent","cookie-consent-date"],d=[];for(let m=0;m<localStorage.length;m++){const g=localStorage.key(m);g&&!f.includes(g)&&d.push(g)}d.forEach(m=>localStorage.removeItem(m))}catch(f){console.error("清理存储数据失败:",f)}setTimeout(()=>{a(!1),e==null||e()},300),console.log("❌ 用户拒绝了Cookie使用")},c=()=>{s==null||s()};return n?i.jsx(Pt,{children:r&&i.jsxs(i.Fragment,{children:[i.jsx(re.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/20 z-[9998] pointer-events-none"}),i.jsxs(re.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},transition:{type:"spring",damping:25,stiffness:200},className:"fixed bottom-0 left-0 right-0 z-[9999] bg-white border-t border-gray-200 shadow-2xl",children:[i.jsx("div",{className:"max-w-7xl mx-auto p-4 sm:p-6",children:i.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 mt-1",children:i.jsx("i",{className:"fa-solid fa-cookie-bite text-amber-500 text-xl"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"🍪 Cookie使用说明"}),i.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed",children:["我们使用Cookie和本地存储来提供更好的用户体验，包括：",i.jsx("br",{}),i.jsxs("span",{className:"inline-flex items-center gap-4 mt-1 text-xs",children:[i.jsx("span",{children:"📱 保存您的网站收藏"}),i.jsx("span",{children:"🎨 记住界面设置"}),i.jsx("span",{children:"☁️ 同步云端数据"}),i.jsx("span",{children:"📊 性能分析"})]})]}),i.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["您可以随时在浏览器设置中管理这些Cookie。了解更多请查看我们的",i.jsx("button",{className:"text-blue-600 hover:text-blue-800 underline mx-1",onClick:()=>window.open("https://github.com/your-repo/privacy-policy","_blank"),children:"隐私政策"})]})]})]})}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[i.jsxs("button",{onClick:c,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[i.jsx("i",{className:"fa-solid fa-cog mr-2"}),"自定义设置"]}),i.jsxs("button",{onClick:u,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[i.jsx("i",{className:"fa-solid fa-times mr-2"}),"拒绝"]}),i.jsxs("button",{onClick:l,className:"px-6 py-2 text-sm bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-medium",children:[i.jsx("i",{className:"fa-solid fa-check mr-2"}),"接受并继续"]})]})]})}),i.jsx("div",{className:"h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500"})]})]})}):null}function sd(t){const e=h.useRef(t.length),s=t.length;return e.current!==s&&(e.current=s),e.current}function nd(t,e){const s=[],n=new Map(t.map(c=>[c.id,c])),a=new Map(e.map(c=>[c.id,c])),r=new Set([...n.keys(),...a.keys()]);let o=0,l=0,u=0;for(const c of r){const f=n.get(c),d=a.get(c);if(f&&!d)s.push({id:c,type:"missing_cloud",localData:f}),o++;else if(!f&&d)s.push({id:c,type:"missing_local",cloudData:d}),l++;else if(f&&d){const m=[];f.name!==d.name&&m.push("name"),f.url!==d.url&&m.push("url"),f.note!==d.note&&m.push("note"),JSON.stringify(f.tags)!==JSON.stringify(d.tags)&&m.push("tags"),m.length>0&&(s.push({id:c,type:"different_content",localData:f,cloudData:d,fields:m}),u++)}}return{hasConflicts:s.length>0,conflicts:s,summary:{totalLocal:t.length,totalCloud:e.length,onlyLocal:o,onlyCloud:l,different:u}}}function ad(t,e){return t.length!==e.length?!0:nd(t,e).hasConflicts}function rd(){Yc();const{websites:t,setWebsites:e}=Va(),{currentUser:s}=Ce(),[n,a]=h.useState(!1),r=n&&(s==null?void 0:s.emailVerified),{cloudWebsites:o,cloudSettings:l,hasCloudData:u,mergeWithLocalData:c}=Qc(r);ed(n);const{setCardOpacity:f,setSearchBarOpacity:d,setParallaxEnabled:m,setWallpaperResolution:g}=vt(),[x,$]=h.useState(!1),[b,S]=h.useState(!1),[L,O]=h.useState(!1);h.useEffect(()=>{const v=setTimeout(()=>{a(!0)},100);return()=>clearTimeout(v)},[]);const y=sd(t);h.useEffect(()=>{if(r&&s&&s.emailVerified&&u&&o&&!b){const v=y,T=o.length;v>0&&T>0&&ad(t,o)?$(!0):(T>0&&v===0&&e(o),S(!0))}},[r,s,u,o,y,b,e,t]),h.useEffect(()=>{r&&s&&s.emailVerified&&l&&(typeof l.cardOpacity=="number"&&f(l.cardOpacity),typeof l.searchBarOpacity=="number"&&d(l.searchBarOpacity),typeof l.parallaxEnabled=="boolean"&&m(l.parallaxEnabled),l.wallpaperResolution&&g(l.wallpaperResolution),l.theme&&localStorage.setItem("theme",l.theme))},[r,s,l,f,d,m,g]);const k=async v=>{if(!(!s||!o))try{let T=[];switch(v){case"cloud":T=o,e(T);break;case"local":T=t,await Ds(s,T);break;case"merge":T=c(t),e(T),await Ds(s,T);break}S(!0)}catch(T){console.error("❌ 数据同步失败:",T)}};return i.jsxs(i.Fragment,{children:[i.jsx(sr,{children:i.jsx(nr,{path:"/",element:i.jsx(Kc,{websites:t,setWebsites:e})})}),x&&o&&i.jsx(Gc,{isOpen:x,onClose:()=>{$(!1),S(!0)},localWebsites:t,cloudWebsites:o,onChoice:k}),i.jsx(td,{onAccept:()=>{console.log("✅ 用户接受Cookie使用，启用完整功能")},onDecline:()=>{console.log("❌ 用户拒绝Cookie使用，限制数据存储")},onCustomize:()=>{O(!0)}}),L&&i.jsx(za,{isOpen:L,onClose:()=>O(!1)}),i.jsx(Jc,{})]})}function id(){return i.jsx(Tc,{children:i.jsx(Oc,{children:i.jsx(Dc,{children:i.jsx(gc,{children:i.jsx(Xa,{backend:er,children:i.jsx(rd,{})})})})})})}const od=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",ld=od?void 0:"/jiang_ai_web",cd=({error:t})=>i.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100vh",background:"white",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"20px",fontFamily:"Arial, sans-serif"},children:[i.jsx("h1",{style:{color:"red",marginBottom:"20px"},children:"应用加载失败"}),i.jsxs("pre",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",fontSize:"14px",maxWidth:"80%",overflow:"auto"},children:[t.message,`

`,t.stack]})]});try{const t=document.getElementById("root");if(!t)throw new Error('无法找到id为"root"的元素');on.createRoot(t).render(i.jsx(h.StrictMode,{children:i.jsxs(ar,{basename:ld,children:[i.jsx(id,{}),i.jsx(ni,{})]})}))}catch(t){console.error("❌ React应用初始化失败:",t),on.createRoot(document.getElementById("root")).render(i.jsx(cd,{error:t}))}
